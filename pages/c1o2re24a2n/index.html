<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>spark-coreç¬”è®° | ğŸ¦</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="webå‰ç«¯æŠ€æœ¯åšå®¢,ç®€æ´è‡³ä¸Š,ä¸“æ³¨webå‰ç«¯å­¦ä¹ ä¸æ€»ç»“ã€‚JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,githubç­‰æŠ€æœ¯æ–‡ç« ã€‚">
    <meta name="keywords" content="ä¸ªäººæŠ€æœ¯åšå®¢,åç«¯,å¤§æ•°æ®,æŠ€æœ¯æ–‡æ¡£,å­¦ä¹ ,js,vue,python,css3,java,javaEE,SpringBoot,Spring,Hadoop,html5,git,github,markdown">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.546f0649.css" as="style"><link rel="preload" href="/assets/js/app.e7d9515b.js" as="script"><link rel="preload" href="/assets/js/2.125ae6e8.js" as="script"><link rel="preload" href="/assets/js/41.6647cff7.js" as="script"><link rel="prefetch" href="/assets/js/10.95c2d7b0.js"><link rel="prefetch" href="/assets/js/100.b4e10546.js"><link rel="prefetch" href="/assets/js/101.d6d23fe2.js"><link rel="prefetch" href="/assets/js/102.b368fb26.js"><link rel="prefetch" href="/assets/js/103.b87bfabc.js"><link rel="prefetch" href="/assets/js/104.3d0ae07d.js"><link rel="prefetch" href="/assets/js/105.e9f9588c.js"><link rel="prefetch" href="/assets/js/106.76130cbc.js"><link rel="prefetch" href="/assets/js/107.11dd35ba.js"><link rel="prefetch" href="/assets/js/108.de8bb9b7.js"><link rel="prefetch" href="/assets/js/109.e26f138c.js"><link rel="prefetch" href="/assets/js/11.5682c637.js"><link rel="prefetch" href="/assets/js/110.2c9036b9.js"><link rel="prefetch" href="/assets/js/111.d91b7424.js"><link rel="prefetch" href="/assets/js/112.0edf9093.js"><link rel="prefetch" href="/assets/js/113.dbc0bf4d.js"><link rel="prefetch" href="/assets/js/114.439ad4ee.js"><link rel="prefetch" href="/assets/js/115.0cff9cd8.js"><link rel="prefetch" href="/assets/js/116.fd44dc61.js"><link rel="prefetch" href="/assets/js/117.e893d264.js"><link rel="prefetch" href="/assets/js/118.ec4b3d32.js"><link rel="prefetch" href="/assets/js/119.ea5c3eba.js"><link rel="prefetch" href="/assets/js/12.5a51d307.js"><link rel="prefetch" href="/assets/js/120.9aaee23f.js"><link rel="prefetch" href="/assets/js/121.4fc7842c.js"><link rel="prefetch" href="/assets/js/122.2b8f75d1.js"><link rel="prefetch" href="/assets/js/123.78dbfead.js"><link rel="prefetch" href="/assets/js/124.84b6382a.js"><link rel="prefetch" href="/assets/js/125.c2a2a818.js"><link rel="prefetch" href="/assets/js/126.83ea2963.js"><link rel="prefetch" href="/assets/js/127.dffd5eae.js"><link rel="prefetch" href="/assets/js/128.bb0a0738.js"><link rel="prefetch" href="/assets/js/129.45a56702.js"><link rel="prefetch" href="/assets/js/13.d1b5b29f.js"><link rel="prefetch" href="/assets/js/130.7fee331a.js"><link rel="prefetch" href="/assets/js/131.6aaa557b.js"><link rel="prefetch" href="/assets/js/132.9526e280.js"><link rel="prefetch" href="/assets/js/133.610c1c84.js"><link rel="prefetch" href="/assets/js/134.1dcf27f7.js"><link rel="prefetch" href="/assets/js/14.83de980a.js"><link rel="prefetch" href="/assets/js/15.0fa06ae1.js"><link rel="prefetch" href="/assets/js/16.d1d3c9c1.js"><link rel="prefetch" href="/assets/js/17.c9772d78.js"><link rel="prefetch" href="/assets/js/18.7cbf0ef4.js"><link rel="prefetch" href="/assets/js/19.66ee7cfc.js"><link rel="prefetch" href="/assets/js/20.8fbb5432.js"><link rel="prefetch" href="/assets/js/21.74a586bf.js"><link rel="prefetch" href="/assets/js/22.f85a2ced.js"><link rel="prefetch" href="/assets/js/23.a65163b5.js"><link rel="prefetch" href="/assets/js/24.5c2898c6.js"><link rel="prefetch" href="/assets/js/25.929f22ff.js"><link rel="prefetch" href="/assets/js/26.20d74c65.js"><link rel="prefetch" href="/assets/js/27.e790af79.js"><link rel="prefetch" href="/assets/js/28.6b84abe6.js"><link rel="prefetch" href="/assets/js/29.acc0fc34.js"><link rel="prefetch" href="/assets/js/3.dd3750e6.js"><link rel="prefetch" href="/assets/js/30.fadb6cbd.js"><link rel="prefetch" href="/assets/js/31.386f82c2.js"><link rel="prefetch" href="/assets/js/32.e934f71c.js"><link rel="prefetch" href="/assets/js/33.684ac64c.js"><link rel="prefetch" href="/assets/js/34.38f8fd76.js"><link rel="prefetch" href="/assets/js/35.3fe27233.js"><link rel="prefetch" href="/assets/js/36.993695b7.js"><link rel="prefetch" href="/assets/js/37.d735018c.js"><link rel="prefetch" href="/assets/js/38.0d23a384.js"><link rel="prefetch" href="/assets/js/39.808de65c.js"><link rel="prefetch" href="/assets/js/4.4a137b18.js"><link rel="prefetch" href="/assets/js/40.2fc7d5f7.js"><link rel="prefetch" href="/assets/js/42.f4d93aa6.js"><link rel="prefetch" href="/assets/js/43.a5d40107.js"><link rel="prefetch" href="/assets/js/44.3ae864d3.js"><link rel="prefetch" href="/assets/js/45.c66f1afe.js"><link rel="prefetch" href="/assets/js/46.750f2be2.js"><link rel="prefetch" href="/assets/js/47.1722c1b9.js"><link rel="prefetch" href="/assets/js/48.7c8df7cc.js"><link rel="prefetch" href="/assets/js/49.f9b58d70.js"><link rel="prefetch" href="/assets/js/5.51ca929a.js"><link rel="prefetch" href="/assets/js/50.fad73ad9.js"><link rel="prefetch" href="/assets/js/51.b88c6213.js"><link rel="prefetch" href="/assets/js/52.21244293.js"><link rel="prefetch" href="/assets/js/53.1c2189f3.js"><link rel="prefetch" href="/assets/js/54.95ba12bc.js"><link rel="prefetch" href="/assets/js/55.d8f79989.js"><link rel="prefetch" href="/assets/js/56.63c36b2d.js"><link rel="prefetch" href="/assets/js/57.270857ec.js"><link rel="prefetch" href="/assets/js/58.156073cc.js"><link rel="prefetch" href="/assets/js/59.5a300643.js"><link rel="prefetch" href="/assets/js/6.2dccf462.js"><link rel="prefetch" href="/assets/js/60.92f4ce87.js"><link rel="prefetch" href="/assets/js/61.0f312cea.js"><link rel="prefetch" href="/assets/js/62.0c55901b.js"><link rel="prefetch" href="/assets/js/63.613b1add.js"><link rel="prefetch" href="/assets/js/64.1e5070b6.js"><link rel="prefetch" href="/assets/js/65.dc215238.js"><link rel="prefetch" href="/assets/js/66.4a1319e4.js"><link rel="prefetch" href="/assets/js/67.841428fe.js"><link rel="prefetch" href="/assets/js/68.7380e054.js"><link rel="prefetch" href="/assets/js/69.0a503182.js"><link rel="prefetch" href="/assets/js/7.1096b6fa.js"><link rel="prefetch" href="/assets/js/70.09f4c416.js"><link rel="prefetch" href="/assets/js/71.a279d635.js"><link rel="prefetch" href="/assets/js/72.057aa49f.js"><link rel="prefetch" href="/assets/js/73.767f542c.js"><link rel="prefetch" href="/assets/js/74.3eb6f7e5.js"><link rel="prefetch" href="/assets/js/75.50ecd31e.js"><link rel="prefetch" href="/assets/js/76.602f67fb.js"><link rel="prefetch" href="/assets/js/77.3b5a8e7d.js"><link rel="prefetch" href="/assets/js/78.40c6990e.js"><link rel="prefetch" href="/assets/js/79.ecb155e0.js"><link rel="prefetch" href="/assets/js/8.4b82b135.js"><link rel="prefetch" href="/assets/js/80.d7279b34.js"><link rel="prefetch" href="/assets/js/81.f58f78af.js"><link rel="prefetch" href="/assets/js/82.8399bcab.js"><link rel="prefetch" href="/assets/js/83.67c3c861.js"><link rel="prefetch" href="/assets/js/84.5a8f7c4b.js"><link rel="prefetch" href="/assets/js/85.c6f0af81.js"><link rel="prefetch" href="/assets/js/86.f9f3d0b8.js"><link rel="prefetch" href="/assets/js/87.fec83ae4.js"><link rel="prefetch" href="/assets/js/88.ca11e236.js"><link rel="prefetch" href="/assets/js/89.ae243724.js"><link rel="prefetch" href="/assets/js/9.b8d3ed93.js"><link rel="prefetch" href="/assets/js/90.c242e238.js"><link rel="prefetch" href="/assets/js/91.ad0080a6.js"><link rel="prefetch" href="/assets/js/92.a435d70c.js"><link rel="prefetch" href="/assets/js/93.3232bfbf.js"><link rel="prefetch" href="/assets/js/94.6101d03c.js"><link rel="prefetch" href="/assets/js/95.8c95af7a.js"><link rel="prefetch" href="/assets/js/96.a582908e.js"><link rel="prefetch" href="/assets/js/97.1b560b4f.js"><link rel="prefetch" href="/assets/js/98.a686266f.js"><link rel="prefetch" href="/assets/js/99.e03a81a9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.546f0649.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/favicon.ico" alt="ğŸ¦" class="logo"> <span class="site-name can-hide">ğŸ¦</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Bigæ•°æ®" class="dropdown-title"><a href="/BigData/" class="link-title">Bigæ•°æ®</a> <span class="title" style="display:none;">Bigæ•°æ®</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å¤§æ•°æ®è·¯çº¿</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/2asd1/" class="nav-link">å¼€å‘è·¯çº¿</a></li><li class="dropdown-subitem"><a href="/pages/5cda13/" class="nav-link">linuxå¯¼å›¾</a></li></ul></li><li class="dropdown-item"><h4>å­¦ä¹ ç¬”è®°</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/l2sdd2ad123/" class="nav-link">ã€ŠLinuxã€‹</a></li><li class="dropdown-subitem"><a href="/pages/hdf2shad2o4p3/" class="nav-link">ã€ŠHadoopã€‹</a></li><li class="dropdown-subitem"><a href="/pages/f2l2im24e/" class="nav-link">ã€Šç”Ÿæ€åœˆç»„ä»¶ã€‹</a></li><li class="dropdown-subitem"><a href="/pages/ka1f3k4a/" class="nav-link">ã€Šæ¶ˆæ¯é˜Ÿåˆ—ã€‹</a></li><li class="dropdown-subitem"><a href="/pages/spa123ra12sd2/" class="nav-link">ã€Šsparkã€‹</a></li><li class="dropdown-subitem"><a href="/pages/f1l2i3n4k5/" class="nav-link">ã€Šflinkã€‹</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/TechnologyStack/" class="nav-link">æŠ€æœ¯æ ˆğŸˆ</a></div><div class="nav-item"><a href="/python/" class="nav-link">python</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="â›³ğŸ–¥" class="dropdown-title"><a href="/technology/" class="link-title">â›³ğŸ–¥</a> <span class="title" style="display:none;">â›³ğŸ–¥</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/b08e81/" class="nav-link">è®¡ç®—æœºå¿…å¤‡</a></li><li class="dropdown-item"><!----> <a href="/pages/fba33e/" class="nav-link">æ•°å­¦åŸºç¡€</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="more" class="dropdown-title"><a href="/more/" class="link-title">more</a> <span class="title" style="display:none;">more</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">å­¦ä¹ </a></li><li class="dropdown-item"><!----> <a href="/pages/vscode123/" class="nav-link">æŠ€å·§</a></li><li class="dropdown-item"><!----> <a href="/pages/4c76s2s6d8b3/" class="nav-link">æŠ€æœ¯æ–‡æ¡£</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHubæŠ€å·§</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">æœ¬ç«™å…³è”</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">å…³äº</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">æ”¶è—</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/archives/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">åˆ†ç±»</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">æ ‡ç­¾</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">å½’æ¡£</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/axcmsm" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/zzx.jpg"> <div class="blogger-info"><h3>AxcmsmğŸ¼</h3> <span>çºµæœ‰ç–¾é£èµ·ï¼Œäººç”Ÿä¸è¨€å¼ƒğŸ…</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Bigæ•°æ®" class="dropdown-title"><a href="/BigData/" class="link-title">Bigæ•°æ®</a> <span class="title" style="display:none;">Bigæ•°æ®</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å¤§æ•°æ®è·¯çº¿</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/2asd1/" class="nav-link">å¼€å‘è·¯çº¿</a></li><li class="dropdown-subitem"><a href="/pages/5cda13/" class="nav-link">linuxå¯¼å›¾</a></li></ul></li><li class="dropdown-item"><h4>å­¦ä¹ ç¬”è®°</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/l2sdd2ad123/" class="nav-link">ã€ŠLinuxã€‹</a></li><li class="dropdown-subitem"><a href="/pages/hdf2shad2o4p3/" class="nav-link">ã€ŠHadoopã€‹</a></li><li class="dropdown-subitem"><a href="/pages/f2l2im24e/" class="nav-link">ã€Šç”Ÿæ€åœˆç»„ä»¶ã€‹</a></li><li class="dropdown-subitem"><a href="/pages/ka1f3k4a/" class="nav-link">ã€Šæ¶ˆæ¯é˜Ÿåˆ—ã€‹</a></li><li class="dropdown-subitem"><a href="/pages/spa123ra12sd2/" class="nav-link">ã€Šsparkã€‹</a></li><li class="dropdown-subitem"><a href="/pages/f1l2i3n4k5/" class="nav-link">ã€Šflinkã€‹</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/TechnologyStack/" class="nav-link">æŠ€æœ¯æ ˆğŸˆ</a></div><div class="nav-item"><a href="/python/" class="nav-link">python</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="â›³ğŸ–¥" class="dropdown-title"><a href="/technology/" class="link-title">â›³ğŸ–¥</a> <span class="title" style="display:none;">â›³ğŸ–¥</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/b08e81/" class="nav-link">è®¡ç®—æœºå¿…å¤‡</a></li><li class="dropdown-item"><!----> <a href="/pages/fba33e/" class="nav-link">æ•°å­¦åŸºç¡€</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="more" class="dropdown-title"><a href="/more/" class="link-title">more</a> <span class="title" style="display:none;">more</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">å­¦ä¹ </a></li><li class="dropdown-item"><!----> <a href="/pages/vscode123/" class="nav-link">æŠ€å·§</a></li><li class="dropdown-item"><!----> <a href="/pages/4c76s2s6d8b3/" class="nav-link">æŠ€æœ¯æ–‡æ¡£</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHubæŠ€å·§</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">æœ¬ç«™å…³è”</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">å…³äº</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">æ”¶è—</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/archives/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">åˆ†ç±»</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">æ ‡ç­¾</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">å½’æ¡£</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/axcmsm" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>è·¯çº¿orå¯¼å›¾</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>å­¦ä¹ ç¬”è®°</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>ã€Šlinuxã€‹</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>ã€ŠHadoopã€‹</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>ã€Šzookeeperã€‹</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>ã€Šhiveã€‹</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>ã€Šç”Ÿæ€åœˆç»„ä»¶ã€‹</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>ã€Šæ¶ˆæ¯é˜Ÿåˆ—ã€‹</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>ã€Šsparkã€‹</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/ska2ab24a2n/" class="sidebar-link">scalaç¬”è®°</a></li><li><a href="/pages/c1o2re24a2n/" aria-current="page" class="active sidebar-link">spark-coreç¬”è®°</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/c1o2re24a2n/#spark-æ¦‚è¿°" class="sidebar-link">Spark æ¦‚è¿°</a></li><li class="sidebar-sub-header"><a href="/pages/c1o2re24a2n/#å¿«é€Ÿä¸Šæ‰‹" class="sidebar-link">å¿«é€Ÿä¸Šæ‰‹</a></li><li class="sidebar-sub-header"><a href="/pages/c1o2re24a2n/#è¿è¡Œç¯å¢ƒ-éƒ¨ç½²" class="sidebar-link">è¿è¡Œç¯å¢ƒ éƒ¨ç½²</a></li><li class="sidebar-sub-header"><a href="/pages/c1o2re24a2n/#è¿è¡Œæ¶æ„" class="sidebar-link">è¿è¡Œæ¶æ„</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/c1o2re24a2n/#æ ¸å¿ƒæ¦‚å¿µ" class="sidebar-link">æ ¸å¿ƒæ¦‚å¿µ</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/c1o2re24a2n/#æ ¸å¿ƒç¼–ç¨‹â›³" class="sidebar-link">æ ¸å¿ƒç¼–ç¨‹â›³</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/c1o2re24a2n/#rddåŸºç¡€ç¼–ç¨‹" class="sidebar-link">RDDåŸºç¡€ç¼–ç¨‹</a></li><li class="sidebar-sub-header"><a href="/pages/c1o2re24a2n/#rddè½¬æ¢ç®—å­" class="sidebar-link">RDDè½¬æ¢ç®—å­</a></li><li class="sidebar-sub-header"><a href="/pages/c1o2re24a2n/#rddè¡ŒåŠ¨ç®—å­" class="sidebar-link">RDDè¡ŒåŠ¨ç®—å­</a></li><li class="sidebar-sub-header"><a href="/pages/c1o2re24a2n/#rdd-åºåˆ—åŒ–" class="sidebar-link">RDD åºåˆ—åŒ–</a></li><li class="sidebar-sub-header"><a href="/pages/c1o2re24a2n/#rddçš„æŒä¹…åŒ–" class="sidebar-link">RDDçš„æŒä¹…åŒ–</a></li><li class="sidebar-sub-header"><a href="/pages/c1o2re24a2n/#ç´¯åŠ å™¨" class="sidebar-link">ç´¯åŠ å™¨</a></li><li class="sidebar-sub-header"><a href="/pages/c1o2re24a2n/#å¹¿æ’­å˜é‡" class="sidebar-link">å¹¿æ’­å˜é‡</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/c1o2re24a2n/#å·¥ç¨‹åŒ–æ¶æ„" class="sidebar-link">å·¥ç¨‹åŒ–æ¶æ„</a></li></ul></li><li><a href="/pages/s2q3lab24a2n/" class="sidebar-link">spark-SQLç¬”è®°</a></li><li><a href="/pages/St4r2e1a41m2i3ng/" class="sidebar-link">spark-Streamingç¬”è®°</a></li><li><a href="/pages/St4r2y1ou2g/" class="sidebar-link">sparkä¼˜åŒ–</a></li><li><a href="/pages/St4rnei2he1ng/" class="sidebar-link">sparkå†…æ ¸æºç </a></li><li><a href="/pages/spa123ra12sd2/" class="sidebar-link">æµ…å°sparkâœ¨</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>ã€Šflinkã€‹</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>ã€Šæ•°æ®å¯è§†åŒ–ã€‹</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>é¡¹ç›®</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å®‰è£…</span> <span class="arrow right"></span></p> <!----></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- æ­£æ–¹å½¢ -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1cd794fe><div class="articleInfo" data-v-1cd794fe><ul class="breadcrumbs" data-v-1cd794fe><li data-v-1cd794fe><a href="/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-1cd794fe></a></li> <li data-v-1cd794fe><a href="/BigData" title="å¤§æ•°æ®-ç›®å½•é¡µ" data-v-1cd794fe>å¤§æ•°æ®</a></li> <li data-v-1cd794fe><a href="/BigData/#å­¦ä¹ ç¬”è®°" title="å¤§æ•°æ®#å­¦ä¹ ç¬”è®°" data-v-1cd794fe>å­¦ä¹ ç¬”è®°</a></li> <li data-v-1cd794fe><a href="/BigData/#ã€Šsparkã€‹" title="å¤§æ•°æ®#ã€Šsparkã€‹" data-v-1cd794fe>ã€Šsparkã€‹</a></li></ul> <div class="info" data-v-1cd794fe><div title="ä½œè€…" class="author iconfont icon-touxiang" data-v-1cd794fe><a href="https://github.com/axcmsm" target="_blank" title="ä½œè€…" class="beLink" data-v-1cd794fe>Wei Ye</a></div> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-1cd794fe><a href="javascript:;" data-v-1cd794fe>2021-10-01</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="/img/bj1.jpg">
          spark-coreç¬”è®°
        </h1> <div class="page-slot page-slot-top"><!-- å›ºå®š100% * 90pxå¯æ˜¾ç¤ºï¼Œmax-height:90pxæœªè§æ˜¾ç¤º-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><h2 id="spark-æ¦‚è¿°"><a href="#spark-æ¦‚è¿°" class="header-anchor">#</a> <strong>Spark</strong> <strong>æ¦‚è¿°</strong></h2> <p>åŸºäºå†…å­˜çš„å¿«é€Ÿ,é€šç”¨å¯æ‰©å±•çš„åˆ†æè®¡ç®—å¼•æ“ï¼ŒåŸºäºscalaå¼€å‘ã€‚</p> <p><strong>æ ¸å¿ƒæ¨¡å—</strong>ï¼š</p> <ul><li>spark core ï¼š æ˜¯åŸºç¡€å’Œæœ€<strong>æ ¸å¿ƒ</strong>åŠŸèƒ½ (å…¶ä»–éƒ½æ˜¯æ­¤åŸºç¡€ä¸Šå¼€å‘)</li> <li>spark sql  ï¼š ç”¨sql<strong>æ“ä½œ</strong>æŸ¥è¯¢æ•°æ®</li> <li>spark streaming ï¼š <strong>æµå¼</strong>å¤„ç†æ¨¡å—</li> <li>spark MLib ï¼š <strong>æœºå™¨å­¦ä¹ </strong>æ¨¡å—(éš¾åº¦é«˜ éœ€è¦æ•°å­¦åŸºç¡€)</li> <li>spark GraphXï¼š <strong>å›¾å½¢æŒ–æ˜</strong>æ¨¡å—(éš¾åº¦é«˜ éœ€è¦æ•°å­¦åŸºç¡€)</li></ul> <p><strong>sparkå’Œhadoopçš„å¯¹æ¯”</strong>ï¼š</p> <blockquote><p>Spark å’ŒHadoop çš„æ ¹æœ¬å·®å¼‚æ˜¯å¤šä¸ªä½œä¸šä¹‹é—´çš„æ•°æ®é€šä¿¡é—®é¢˜ : Spark å¤šä¸ªä½œä¸šä¹‹é—´æ•°æ®</p> <p>é€šä¿¡æ˜¯åŸºäºå†…å­˜ï¼Œè€Œ Hadoop æ˜¯åŸºäºç£ç›˜ã€‚</p> <p>sparkåªæœ‰åœ¨<strong>shuffle</strong>æ—¶æ‰ä¼š<strong>è½ç›˜</strong>ã€‚</p></blockquote> <h2 id="å¿«é€Ÿä¸Šæ‰‹"><a href="#å¿«é€Ÿä¸Šæ‰‹" class="header-anchor">#</a> <strong>å¿«é€Ÿä¸Šæ‰‹</strong></h2> <ol><li><p><strong>åˆ›å»º</strong> <strong>Maven</strong></p></li> <li><p><strong>å¢åŠ </strong> <strong>Scala</strong> <strong>æ’ä»¶</strong> ï¼ˆæ³¨æ„é€‰æ‹©å¯¹åº”çš„ç‰ˆæœ¬ï¼‰</p></li> <li><p><strong>å¢åŠ ä¾èµ–å…³ç³»</strong></p></li></ol> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.spark<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spark-core_2.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>log4j.properties</code></p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">log4j.rootCategory</span><span class="token punctuation">=</span><span class="token attr-value">ERROR, console</span>
<span class="token attr-name">log4j.appender.console</span><span class="token punctuation">=</span><span class="token attr-value">org.apache.log4j.ConsoleAppender</span>
<span class="token attr-name">log4j.appender.console.target</span><span class="token punctuation">=</span><span class="token attr-value">System.err</span>
<span class="token attr-name">log4j.appender.console.layout</span><span class="token punctuation">=</span><span class="token attr-value">org.apache.log4j.PatternLayout</span>
<span class="token attr-name">log4j.appender.console.layout.ConversionPattern</span><span class="token punctuation">=</span><span class="token attr-value">%d{yy/MM/dd </span>
<span class="token attr-name">HH</span><span class="token punctuation">:</span><span class="token attr-value">mm:ss} %p %c{1}: %m%n</span>
<span class="token comment"># Set the default spark-shell log level to ERROR. When running the spark-shell,</span>
the
<span class="token comment"># log level for this class is used to overwrite the root logger's log level, so</span>
that
<span class="token comment"># the user can have different defaults for the shell and regular Spark apps.</span>
<span class="token attr-name">log4j.logger.org.apache.spark.repl.Main</span><span class="token punctuation">=</span><span class="token attr-value">ERROR</span>
<span class="token comment"># Settings to quiet third party logs that are too verbose</span>
<span class="token attr-name">log4j.logger.org.spark_project.jetty</span><span class="token punctuation">=</span><span class="token attr-value">ERROR</span>
<span class="token attr-name">log4j.logger.org.spark_project.jetty.util.component.AbstractLifeCycle</span><span class="token punctuation">=</span><span class="token attr-value">ERROR</span>
<span class="token attr-name">log4j.logger.org.apache.spark.repl.SparkIMain$exprTyper</span><span class="token punctuation">=</span><span class="token attr-value">ERROR</span>
<span class="token attr-name">log4j.logger.org.apache.spark.repl.SparkILoop$SparkILoopInterpreter</span><span class="token punctuation">=</span><span class="token attr-value">ERROR</span>
<span class="token attr-name">log4j.logger.org.apache.parquet</span><span class="token punctuation">=</span><span class="token attr-value">ERROR</span>
<span class="token attr-name">log4j.logger.parquet</span><span class="token punctuation">=</span><span class="token attr-value">ERROR</span>
<span class="token comment"># SPARK-9183: Settings to avoid annoying messages when looking up nonexistent</span>
<span class="token attr-name">UDFs</span> <span class="token attr-value">in SparkSQL with Hive support</span>
<span class="token attr-name">log4j.logger.org.apache.hadoop.hive.metastore.RetryingHMSHandler</span><span class="token punctuation">=</span><span class="token attr-value">FATAL</span>
<span class="token attr-name">log4j.logger.org.apache.hadoop.hive.ql.exec.FunctionRegistry</span><span class="token punctuation">=</span><span class="token attr-value">ERROR</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><ol start="4"><li><p><strong>WordCount</strong>æµ‹è¯•</p> <div class="language-scala line-numbers-mode"><pre class="language-scala"><code><span class="token comment">// åˆ›å»º Spark è¿è¡Œé…ç½®å¯¹è±¡</span>
<span class="token keyword">val</span> sparkConf <span class="token operator">=</span> <span class="token keyword">new</span> SparkConf<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setMaster<span class="token punctuation">(</span><span class="token string">&quot;local[*]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setAppName<span class="token punctuation">(</span><span class="token string">&quot;WordCount&quot;</span><span class="token punctuation">)</span>
<span class="token comment">// åˆ›å»º Spark ä¸Šä¸‹æ–‡ç¯å¢ƒå¯¹è±¡ï¼ˆè¿æ¥å¯¹è±¡ï¼‰</span>
<span class="token keyword">val</span> sc <span class="token operator">:</span> SparkContext <span class="token operator">=</span> <span class="token keyword">new</span> SparkContext<span class="token punctuation">(</span>sparkConf<span class="token punctuation">)</span>
<span class="token comment">// è¯»å–æ–‡ä»¶æ•°æ®</span>
<span class="token keyword">val</span> fileRDD<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> sc<span class="token punctuation">.</span>textFile<span class="token punctuation">(</span><span class="token string">&quot;input/word.txt&quot;</span><span class="token punctuation">)</span>
<span class="token comment">// å°†æ–‡ä»¶ä¸­çš„æ•°æ®è¿›è¡Œåˆ†è¯</span>
<span class="token keyword">val</span> wordRDD<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> fileRDD<span class="token punctuation">.</span>flatMap<span class="token punctuation">(</span> _<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token comment">// è½¬æ¢æ•°æ®ç»“æ„ word =&gt; (word, 1)</span>
<span class="token keyword">val</span> word2OneRDD<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> wordRDD<span class="token punctuation">.</span>map<span class="token punctuation">(</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// å°†è½¬æ¢ç»“æ„åçš„æ•°æ®æŒ‰ç…§ç›¸åŒçš„å•è¯è¿›è¡Œåˆ†ç»„èšåˆ</span>
<span class="token keyword">val</span> word2CountRDD<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> word2OneRDD<span class="token punctuation">.</span>reduceByKey<span class="token punctuation">(</span>_<span class="token operator">+</span>_<span class="token punctuation">)</span>
<span class="token comment">// å°†æ•°æ®èšåˆç»“æœé‡‡é›†åˆ°å†…å­˜ä¸­</span>
<span class="token keyword">val</span> word2Count<span class="token operator">:</span> Array<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> word2CountRDD<span class="token punctuation">.</span>collect<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// æ‰“å°ç»“æœ</span>
word2Count<span class="token punctuation">.</span>foreach<span class="token punctuation">(</span>println<span class="token punctuation">)</span>
<span class="token comment">//å…³é—­ Spark è¿æ¥</span>
sc<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li></ol> <h2 id="è¿è¡Œç¯å¢ƒ-éƒ¨ç½²"><a href="#è¿è¡Œç¯å¢ƒ-éƒ¨ç½²" class="header-anchor">#</a> <strong>è¿è¡Œç¯å¢ƒ</strong> éƒ¨ç½²</h2> <ul><li><p><strong>localæ¨¡å—</strong>ï¼šæµ‹è¯•    1èŠ‚ç‚¹</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">1</span>. ä¸Šä¼ è§£å‹åˆ°æŒ‡å®šç›®å½•
<span class="token number">2</span>. bin/spark-shell <span class="token comment">#ç›´æ¥å¯åŠ¨å³å¯</span>
UI è®¿é—®ç«¯å£ http://è™šæ‹Ÿæœºåœ°å€:4040
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p><strong>Standalone</strong> <strong>æ¨¡å¼</strong> :  <strong>ç‹¬ç«‹</strong>éƒ¨ç½²  ä¸»ä»æ¶æ„æ¨¡å¼   3èŠ‚ç‚¹</p></li></ul> <blockquote><p>æ‹¥æœ‰ä¸€ä¸ªmasterå’Œä¸‰ä¸ªworkeyï¼Œè‡ªå·±è°ƒåº¦èµ„æºè‡ªå·±æ‰§è¡Œç¨‹åº</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">1</span>. è§£å‹æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•
<span class="token number">2</span>. ä¿®æ”¹èŠ‚ç‚¹é…ç½®æ–‡ä»¶
	<span class="token builtin class-name">cd</span> conf
	<span class="token function">mv</span> slaves.template slaves  <span class="token comment">#å°†æ¨¡æ¿æ–‡ä»¶ä¿®æ”¹æˆè‡ªå·±çš„</span>
	<span class="token comment">#æ·»åŠ ä¿®æ”¹ä¸»æœºèŠ‚ç‚¹</span>
	hadoop111
	hadoop112
	hadoop113
<span class="token number">3</span>. ä¿®æ”¹æ‰§è¡Œé…ç½®æ–‡ä»¶
	<span class="token function">mv</span> spark-env.sh.template spark-env.sh <span class="token comment">#å°†æ¨¡æ¿æ–‡ä»¶æ”¹å</span>
	<span class="token comment">#æ·»åŠ  JAVA_HOME ç¯å¢ƒå˜é‡å’Œé›†ç¾¤å¯¹åº”çš„ master èŠ‚ç‚¹</span>
	<span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/opt/module/jdk1.8.0_144
	<span class="token assign-left variable">SPARK_MASTER_HOST</span><span class="token operator">=</span>hadoop111
	<span class="token assign-left variable">SPARK_MASTER_PORT</span><span class="token operator">=</span><span class="token number">7077</span> <span class="token comment">#å†…éƒ¨é€šä¿¡ç«¯å£ç±»ä¼¼8020</span>
<span class="token number">4</span>. åˆ†å‘ä¿®æ”¹å¥½çš„å‹ç¼©ç›®å½•	
	xsync spark-standalone
<span class="token number">5</span>. å¯åŠ¨orå…³é—­
	sbin/start-all.sh <span class="token comment">#å¯åŠ¨</span>
UIè®¿é—®ç«¯å£ï¼šWeb UI ç•Œé¢: http://hadoop111:8080	
<span class="token number">6</span>. é…ç½®å†å²æœåŠ¡
	<span class="token function">mv</span> spark-defaults.conf.template spark-defaults.conf 
	<span class="token comment">#é…ç½®æ—¥å¿—å­˜å‚¨è·¯å¾„</span>
	spark.eventLog.enabled <span class="token boolean">true</span> <span class="token comment">#å¼€å¯</span>
	spark.eventLog.dir hdfs://hadoop111:8020/directory <span class="token comment">#æ­¤ç›®å½•éœ€è¦åœ¨hdfsä¸Šæå‰åˆ›å»º</span>
	<span class="token comment">#ä¿®æ”¹ spark-env.sh æ–‡ä»¶, æ·»åŠ æ—¥å¿—é…ç½®</span>
    <span class="token builtin class-name">export</span> <span class="token assign-left variable">SPARK_HISTORY_OPTS</span><span class="token operator">=</span><span class="token string">&quot;
	-Dspark.history.ui.port=18080 #æ—¥å¿—çš„WEB UIè®¿é—®ç«¯å£
	-Dspark.history.fs.logDirectory=hdfs://hadoop111:8020/directory #å­˜å‚¨è·¯å¾„
	-Dspark.history.retainedApplications=30&quot;</span> <span class="token comment">#ä¿å­˜çš„å†å²ä¸ªæ•°</span>
	<span class="token comment">#åˆ†å‘é…ç½®æ–‡ä»¶</span>
	xsync conf
	<span class="token comment">#é‡å¯é›†ç¾¤å’Œå†å²æœåŠ¡</span>
	sbin/start-all.sh
	sbin/start-history-server.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><ul><li><p><strong>é…ç½®é«˜å¯ç”¨ï¼ˆHAï¼‰</strong>:é˜²æ­¢å•ç‚¹æ•…éšœ  ä¸€èˆ¬é‡‡ç”¨zkè®¾ç½®</p> <blockquote><p>2å°é…ç½®master 3å°zk 3å°worker</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>1. åœæ­¢é›†ç¾¤
2. å¯åŠ¨zké›†ç¾¤
3. ä¿®æ”¹ spark-env.sh æ–‡ä»¶
	#æ³¨é‡Š
	#SPARK_MASTER_HOST=hadoop111
	#SPARK_MASTER_PORT=7077
	æ·»åŠ å¦‚ä¸‹å†…å®¹:
	#Master ç›‘æ§é¡µé¢é»˜è®¤è®¿é—®ç«¯å£ä¸º 8080ï¼Œä½†æ˜¯å¯èƒ½ä¼šå’Œ Zookeeper å†²çªï¼Œ
	#æ‰€ä»¥æ”¹æˆ 8989ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ï¼Œè®¿é—® UI ç›‘æ§é¡µé¢æ—¶è¯·æ³¨æ„
	SPARK_MASTER_WEBUI_PORT=8989
	export SPARK_DAEMON_JAVA_OPTS=&quot;
	-Dspark.deploy.recoveryMode=ZOOKEEPER 
	-Dspark.deploy.zookeeper.url=hadoop111,hadoop112,hadoop113
	-Dspark.deploy.zookeeper.dir=/spark&quot;
4. åˆ†å‘é…ç½®æ–‡ä»¶
	xsync conf/
5. å¯åŠ¨é›†ç¾¤
	sbin/start-all.sh
6. å¯åŠ¨å¤‡ç”¨master (éƒ¨ç½²masterçš„æœºå™¨ä¸Š)
	sbin/start-master.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></li> <li><p><strong>Yarn</strong> <strong>æ¨¡å¼</strong> ï¼šå¸¸ç”¨æ¨¡å¼ğŸ‘©ğŸ¾   1èŠ‚ç‚¹</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">1</span>. è§£å‹æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•
<span class="token number">2</span>. ä¿®æ”¹hadoopä¸­çš„yarn-site.xmlé…ç½®æ–‡ä»¶
	<span class="token operator">&lt;</span><span class="token operator">!</span>--æ˜¯å¦å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ£€æŸ¥æ¯ä¸ªä»»åŠ¡æ­£ä½¿ç”¨çš„ç‰©ç†å†…å­˜é‡ï¼Œå¦‚æœä»»åŠ¡è¶…å‡ºåˆ†é…å€¼ï¼Œåˆ™ç›´æ¥å°†å…¶æ€æ‰ï¼Œé»˜è®¤æ˜¯ <span class="token boolean">true</span> --<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>property<span class="token operator">&gt;</span>
 		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn.nodemanager.pmem-check-enabled<span class="token operator">&lt;</span>/name<span class="token operator">&gt;</span>
		 <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>false<span class="token operator">&lt;</span>/value<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>/property<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span>--æ˜¯å¦å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ£€æŸ¥æ¯ä¸ªä»»åŠ¡æ­£ä½¿ç”¨çš„è™šæ‹Ÿå†…å­˜é‡ï¼Œå¦‚æœä»»åŠ¡è¶…å‡ºåˆ†é…å€¼ï¼Œåˆ™ç›´æ¥å°†å…¶æ€æ‰ï¼Œé»˜è®¤æ˜¯ <span class="token boolean">true</span> --<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>property<span class="token operator">&gt;</span>
		 <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn.nodemanager.vmem-check-enabled<span class="token operator">&lt;</span>/name<span class="token operator">&gt;</span>
 			<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>false<span class="token operator">&lt;</span>/value<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>/property<span class="token operator">&gt;</span>

<span class="token number">3</span>.  ä¿®æ”¹ conf/spark-env.sh æ·»åŠ  JAVA_HOME å’Œ YARN_CONF_DIR é…ç½®
	<span class="token function">mv</span> spark-env.sh.template spark-env.sh <span class="token comment">#æ”¹å</span>
	<span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/opt/module/jdk1.8.0_144
	<span class="token assign-left variable">YARN_CONF_DIR</span><span class="token operator">=</span>/opt/module/hadoop/etc/hadoop
<span class="token number">4</span>. å¯åŠ¨ HDFS ä»¥åŠ YARN é›†ç¾¤
	<span class="token comment">#çœ‹ http://hadoop112:8088 é¡µé¢ï¼Œç‚¹å‡» Historyï¼ŒæŸ¥çœ‹å†å²é¡µé¢</span>
<span class="token number">5</span>. é…ç½®å†å²æœåŠ¡å™¨
	<span class="token function">mv</span> spark-defaults.conf.template spark-defaults.conf <span class="token comment">#æ”¹å</span>
	<span class="token comment">#é…ç½®æ—¥å¿—å­˜å‚¨è·¯å¾„</span>
	spark.eventLog.enabled <span class="token boolean">true</span>
	spark.eventLog.dir hdfs://linux1:8020/directory <span class="token comment">#ç›®å½•éœ€å­˜åœ¨</span>
	<span class="token comment">#ä¿®æ”¹ spark-env.sh æ–‡ä»¶,æ—¥å¿—é…ç½®</span>
	<span class="token builtin class-name">export</span> <span class="token assign-left variable">SPARK_HISTORY_OPTS</span><span class="token operator">=</span><span class="token string">&quot;
	-Dspark.history.ui.port=18080 
	-Dspark.history.fs.logDirectory=hdfs://hadoop111:8020/directory 
	-Dspark.history.retainedApplications=30&quot;</span>
	<span class="token comment">#ä¿®æ”¹ spark-defaults.conf</span>
	spark.yarn.historyServer.address<span class="token operator">=</span>hadoop111:18080
	spark.history.ui.port<span class="token operator">=</span><span class="token number">18080</span>	
<span class="token number">6</span>. å¯åŠ¨å†å²æœåŠ¡
	sbin/start-history-server.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div></li> <li><p><strong>K8S &amp; Mesos</strong> <strong>æ¨¡å¼</strong></p> <blockquote><p>Mesos æ˜¯ Apache ä¸‹çš„å¼€æºåˆ†å¸ƒå¼èµ„æºç®¡ç†æ¡†æ¶,å›½å¤–å¾ˆå¤šäººåœ¨ä½¿ç”¨ã€‚</p> <p>K8Så®¹å™¨ç®¡ç†å·¥å…·ï¼šéƒ¨ç½²æ•™ç¨‹ï¼š<a href="https://spark.apache.org/docs/latest/running-on-kubernetes.html" target="_blank" rel="noopener noreferrer">https://spark.apache.org/docs/latest/running-on-kubernetes.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote></li> <li><p><strong>Windows</strong> <strong>æ¨¡å¼</strong>ï¼šæµ‹è¯•æ¨¡å¼ å¯ä»¥ä¸ç”¨å¯åŠ¨è™šæ‹Ÿæœº</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">1</span>. è§£å‹åˆ°æŒ‡å®šæ–‡ä»¶ ï¼ˆæ— ä¸­æ–‡æ— ç©ºæ ¼ï¼‰
<span class="token number">2</span>. å¯åŠ¨æœ¬åœ°ç¯å¢ƒ
	æ‰§è¡Œè§£å‹ç¼©æ–‡ä»¶è·¯å¾„ä¸‹ bin ç›®å½•ä¸­çš„ spark-shell.cmd æ–‡ä»¶ï¼Œå¯åŠ¨ Spark æœ¬åœ°ç¯å¢ƒ
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul> <p><strong>ç¨‹åºçš„æäº¤</strong>ï¼š</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>bin/spark-submit \
--class org.apache.spark.examples.SparkPi \
--master yarn \
--deploy-mode cluster \
./examples/jars/spark-examples_2.12-3.0.0.jar \
10
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>è§£é‡Š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token number">1</span><span class="token punctuation">)</span> --class è¡¨ç¤ºè¦æ‰§è¡Œç¨‹åºçš„ä¸»ç±»ï¼Œæ­¤å¤„å¯ä»¥æ›´æ¢ä¸ºå’±ä»¬è‡ªå·±å†™çš„åº”ç”¨ç¨‹åº
<span class="token number">2</span><span class="token punctuation">)</span> --master local<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> éƒ¨ç½²æ¨¡å¼ï¼Œé»˜è®¤ä¸ºæœ¬åœ°æ¨¡å¼ï¼Œæ•°å­—è¡¨ç¤ºåˆ†é…çš„è™šæ‹Ÿ CPU æ ¸æ•°é‡
   --master spark://linux1:7077 ç‹¬ç«‹éƒ¨ç½²æ¨¡å¼ï¼Œè¿æ¥åˆ° Spark é›†ç¾¤
   --master Yarn	
<span class="token number">3</span><span class="token punctuation">)</span> spark-examples_2.12-3.0.0.jar è¿è¡Œçš„åº”ç”¨ç±»æ‰€åœ¨çš„ jar åŒ…ï¼Œå®é™…ä½¿ç”¨æ—¶ï¼Œå¯ä»¥è®¾å®šä¸ºå’±
ä»¬è‡ªå·±æ‰“çš„ jar åŒ…
<span class="token number">4</span><span class="token punctuation">)</span> æ•°å­— <span class="token number">10</span> è¡¨ç¤ºç¨‹åºçš„å…¥å£å‚æ•°ï¼Œç”¨äºè®¾å®šå½“å‰åº”ç”¨çš„ä»»åŠ¡æ•°é‡
å…¶ä»–
--num-executors é…ç½® Executor çš„æ•°é‡
--driver-memory é…ç½® Driver å†…å­˜ï¼ˆå½±å“ä¸å¤§ï¼‰
--executor-memory 1G æŒ‡å®šæ¯ä¸ª executor å¯ç”¨å†…å­˜ä¸º 1G
--total-executor-cores <span class="token number">2</span> æŒ‡å®šæ‰€æœ‰executorä½¿ç”¨çš„cpuæ ¸æ•°ä¸º <span class="token number">2</span> ä¸ª
--executor-cores æŒ‡å®šæ¯ä¸ªexecutorä½¿ç”¨çš„cpuæ ¸æ•°
application-arguments ä¼ ç»™ main<span class="token punctuation">(</span><span class="token punctuation">)</span>æ–¹æ³•çš„å‚æ•°
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>è¡¥å……</strong>ï¼šç”Ÿäº§ç¯å¢ƒ Spark submit è„šæœ¬é…ç½®</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>bin/spark-submit <span class="token punctuation">\</span>
--class com.atguigu.spark.WordCount <span class="token punctuation">\</span>
--master yarn<span class="token punctuation">\</span>
--deploy-mode cluster<span class="token punctuation">\</span>
--num-executors <span class="token number">80</span> <span class="token punctuation">\</span>
--driver-memory 6g <span class="token punctuation">\</span>
--executor-memory 6g <span class="token punctuation">\</span>
--executor-cores <span class="token number">3</span> <span class="token punctuation">\</span>
--queue root.default <span class="token punctuation">\</span>
--conf spark.yarn.executor.memoryOverhead<span class="token operator">=</span><span class="token number">2048</span> <span class="token punctuation">\</span>
--conf spark.core.connection.ack.wait.timeout<span class="token operator">=</span><span class="token number">300</span> <span class="token punctuation">\</span>
/usr/local/spark/spark.jar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>å‚æ•°é…ç½®å‚è€ƒå€¼ï¼š</p> <div class="language-scala line-numbers-mode"><pre class="language-scala"><code>â¢ <span class="token operator">--</span>num<span class="token operator">-</span>executorsï¼š<span class="token number">50</span><span class="token operator">~</span><span class="token number">100</span>
â¢ <span class="token operator">--</span>driver<span class="token operator">-</span>memoryï¼š<span class="token number">1</span>G<span class="token operator">~</span><span class="token number">5</span>G
â¢ <span class="token operator">--</span>executor<span class="token operator">-</span>memoryï¼š<span class="token number">6</span>G<span class="token operator">~</span><span class="token number">10</span>G
â¢ <span class="token operator">--</span>executor<span class="token operator">-</span>coresï¼š<span class="token number">3</span> â¢ <span class="token operator">--</span>masterï¼šå®é™…ç”Ÿäº§ç¯å¢ƒä¸€å®šä½¿ç”¨
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>æ€»ç»“ç«¯å£å·ï¼š</p> <p>â¢ Spark æŸ¥çœ‹å½“å‰ Spark-shell è¿è¡Œä»»åŠ¡æƒ…å†µç«¯å£å·ï¼š4040ï¼ˆè®¡ç®—ï¼‰</p> <p>â¢ Spark Master å†…éƒ¨é€šä¿¡æœåŠ¡ç«¯å£å·ï¼š7077</p> <p>â¢ Standalone æ¨¡å¼ä¸‹ï¼ŒSpark Master Web ç«¯å£å·ï¼š8080ï¼ˆèµ„æºï¼‰</p> <p>â¢ Spark å†å²æœåŠ¡å™¨ç«¯å£å·ï¼š18080</p> <p>â¢ Hadoop YARN ä»»åŠ¡è¿è¡Œæƒ…å†µæŸ¥çœ‹ç«¯å£å·ï¼š8088</p></blockquote> <h2 id="è¿è¡Œæ¶æ„"><a href="#è¿è¡Œæ¶æ„" class="header-anchor">#</a> <strong>è¿è¡Œæ¶æ„</strong></h2> <p>ä¸»ä»æ¶æ„</p> <p><img src="https://gitee.com/axcmsm/tmp/raw/master/bigdata/20211002162318.png" alt=""></p> <p><strong>Dirver</strong>: è°ƒåº¦èŠ‚ç‚¹</p> <ul><li>å°†ç”¨æˆ·ç¨‹åºè½¬æ¢æˆä½œä¸š</li> <li>åœ¨Executorä¹‹é—´è°ƒåº¦ä»»åŠ¡task</li> <li>è·Ÿè¸ªæ‰§è¡Œæƒ…å†µ</li> <li>é€šè¿‡UIå±•ç¤ºè¿è¡Œæƒ…å†µ</li></ul> <p><strong>Executor</strong>ï¼šè®¡ç®—èŠ‚ç‚¹</p> <ul><li>è´Ÿè´£æ‰§è¡Œå…·ä½“ä»»åŠ¡Taskï¼Œå¹¶å°†å…¶è¿”å›ç»™Driver</li> <li>ä¸ºäº†æé«˜æ€§èƒ½ä¹Ÿä¼šå¯¹æ•°æ®è¿›è¡Œä¸€äº›ç¼“å­˜RDD</li></ul> <p><strong>ç‹¬ç«‹éƒ¨ç½²ç»„ä»¶</strong>ï¼šMaster&amp;Workerï¼šè·Ÿèµ„æºç›¸å…³ ï¼ˆç›¸å½“äºyarnçš„è€å¤§å’Œå°å¼Ÿï¼‰</p> <p><strong>ApplicationMaster</strong>: æä¾›ï¼šè®¡ç®—å’Œèµ„æºäº¤äº’</p> <h3 id="æ ¸å¿ƒæ¦‚å¿µ"><a href="#æ ¸å¿ƒæ¦‚å¿µ" class="header-anchor">#</a> æ ¸å¿ƒæ¦‚å¿µ</h3> <p><strong>Executor&amp;Core</strong></p> <blockquote><p>Executoræ˜¯è¿è¡Œåœ¨worker(å·¥ä½œèŠ‚ç‚¹)ä¸Šçš„ä¸€ä¸ªjvmè¿›ç¨‹ã€‚ä¸“é—¨ç”¨äºè®¡ç®—çš„èŠ‚ç‚¹ï¼Œæäº¤éœ€è¦æŒ‡å®šèŠ‚ç‚¹ä¸ªæ•°å’Œè®¡ç®—å¯¹åº”çš„èµ„æº ï¼ˆExecutorçš„å†…å­˜å¤§å°å’ŒCPUæ ¸(Core) çš„æ•°é‡</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>é…ç½®å‚æ•°
	åç§°   				è¯´æ˜
--num-executors 	é…ç½® Executor çš„æ•°é‡
--executor-memory é…ç½®æ¯ä¸ª Executor çš„å†…å­˜å¤§å°
--executor-cores é…ç½®æ¯ä¸ª Executor çš„è™šæ‹Ÿ CPU core æ•°é‡
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>å¹¶è¡Œåº¦</strong> Parallelism  :æ•´ä¸ªé›†ç¾¤å¹¶è¡Œæ‰§è¡Œä»»åŠ¡çš„æ•°é‡ã€‚(å ç”¨çš„æ ¸core)</p> <p><strong>æœ‰å‘æ— ç¯å›¾</strong> DAG : ä»»åŠ¡çš„è°ƒåº¦ï¼Œå…¶å†…éƒ¨æ˜¯æœ‰å‘æ— ç¯å›¾</p> <p><strong>æäº¤æµç¨‹</strong>ï¼š</p> <p>è¿™é‡Œä¸»è¦yarnçš„æäº¤æµç¨‹</p> <p><img src="https://gitee.com/axcmsm/tmp/raw/master/bigdata/20211002162838.png" alt=""></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>1. ä»»åŠ¡æäº¤	
2. Driverè¿è¡Œ(ç”³è¯·æ”¯æ´) -&gt; å‘é›†ç¾¤ç®¡ç†è€… æ³¨å†Œä»»åŠ¡ -&gt; ç®¡ç†è€… å¯åŠ¨Executoråè¿›è¡Œåå‘æ³¨å†Œç»™(å‘Šè¯‰)Driver
3. æ¡ä»¶æ»¡è¶³-&gt; æ‰§è¡ŒMainå‡½æ•° (æ‰§è¡Œè®¡ç®—ä»£ç )
4. æ‡’æ‰§è¡Œ-&gt;æ‰§è¡Œåˆ°actionç®—å­
5. è§¦å‘job-&gt; stageåˆ’åˆ†
6. åˆ›å»ºTaskSet ä»»åŠ¡ -&gt; å‘é€ç»™ å·²ç»å¯åŠ¨çš„Executor è¿›è¡Œæ‰§è¡Œ
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>yarnéƒ¨ç½²æ–¹å¼åˆ†ä¿©ç§: <strong>Client</strong>(é›†ç¾¤ä¹‹å¤–) å’Œ<strong>Cluster</strong>() ï¼š<strong>Driver</strong>ç¨‹åºçš„è¿è¡ŒèŠ‚ç‚¹ä¸åŒ</p></blockquote> <p><strong>Yarn Client</strong> <strong>æ¨¡å¼</strong>ï¼šåœ¨å®¢æˆ·ç«¯æ‰§è¡Œï¼Œä¸€èˆ¬ç”¨äºæµ‹è¯•ç¯å¢ƒ</p> <p><strong>Yarn Cluster</strong> <strong>æ¨¡å¼</strong> ï¼šå¯åŠ¨åœ¨ Yarn é›†ç¾¤èµ„æºä¸­æ‰§è¡Œï¼Œä¸€èˆ¬ç”¨äºç”Ÿäº§ç¯å¢ƒ</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">1</span>. åœ¨ YARN Cluster æ¨¡å¼ä¸‹ï¼Œä»»åŠ¡æäº¤åä¼šå’Œ ResourceManager é€šè®¯ç”³è¯·å¯åŠ¨
ApplicationMaster

<span class="token number">2</span>. éšå ResourceManager åˆ†é… containerï¼Œåœ¨åˆé€‚çš„ NodeManager 
ä¸Šå¯åŠ¨ ApplicationMasterï¼Œæ­¤æ—¶çš„ ApplicationMaster å°±æ˜¯ Driver

<span class="token number">3</span>. Driver å¯åŠ¨åå‘ ResourceManager ç”³è¯· Executor å†…å­˜ï¼ŒResourceManager æ¥åˆ°
ApplicationMaster çš„èµ„æºç”³è¯·åä¼šåˆ†é… containerï¼Œç„¶ååœ¨åˆé€‚çš„ NodeManager ä¸Šå¯åŠ¨
Executor è¿›ç¨‹

<span class="token number">4</span>. Executor è¿›ç¨‹å¯åŠ¨åä¼šå‘ Driver åå‘æ³¨å†Œï¼ŒExecutor å…¨éƒ¨æ³¨å†Œå®Œæˆå Driver å¼€å§‹æ‰§è¡Œ
main å‡½æ•°

<span class="token number">5</span>. ä¹‹åæ‰§è¡Œåˆ° Action ç®—å­æ—¶ï¼Œè§¦å‘ä¸€ä¸ª Jobï¼Œå¹¶æ ¹æ®å®½ä¾èµ–å¼€å§‹åˆ’åˆ† stageï¼Œæ¯ä¸ª stage ç”Ÿ
æˆå¯¹åº”çš„ TaskSetï¼Œä¹‹åå°† task åˆ†å‘åˆ°å„ä¸ª Executor ä¸Šæ‰§è¡Œ
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="æ ¸å¿ƒç¼–ç¨‹â›³"><a href="#æ ¸å¿ƒç¼–ç¨‹â›³" class="header-anchor">#</a> <strong>æ ¸å¿ƒç¼–ç¨‹</strong>â›³</h2> <p>ä¸ºäº†å®ç°é«˜å¹¶å‘å’Œé«˜åå,å°è£…äº†ä¸‰å¤§æ•°æ®ç»“æ„ï¼š</p> <ul><li>RDD :å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†</li> <li>ç´¯åŠ å™¨ ï¼šåˆ†å¸ƒå¼å…±äº«åªå†™å˜é‡</li> <li>å¹¿æ’­å˜é‡ ï¼šåˆ†å¸ƒå¼å…±äº«åªè¯»å˜é‡</li></ul> <p><strong>RDD</strong>ï¼šæ•°æ®åŸºæœ¬çš„<strong>å¤„ç†æ¨¡å‹</strong>,æœ€å°çš„è®¡ç®—å•å…ƒ</p> <blockquote><p>ä¼šæŠŠRDDé‡Œé¢çš„å†…å®¹(è¯»å–æ•°æ®oré€»è¾‘åˆ‡åˆ† <strong>åˆ†åŒºæ¦‚å¿µ</strong>)åˆ†è§£æˆä¸€ä¸ªä¸€ä¸ªtaskå‘é€ç»™Executoræ‰§è¡ŒèŠ‚ç‚¹</p> <p>å®é™…ä¸Šä¸€ä¸ªRDDé‡Œé¢çš„é€»è¾‘æ˜¯å¾ˆç®€å•çš„,æ‰€ä»¥ä¸€ä¸ªå¤æ‚çš„ä»»åŠ¡æ˜¯å¤šä¸ªRDDä¸²è”èµ·æ¥,ç„¶åå†åˆ†è§£æˆtaskå‘é€æ‰§è¡ŒèŠ‚ç‚¹,è¿›è¡Œå¹¶è¡Œå¤„ç†ã€‚</p> <p>æ˜¯ä¸€ä¸ªæŠ½è±¡ï¼Œå¼¹æ€§ã€ä¸å¯å˜ã€å¯åˆ†åŒºã€é‡Œé¢å¯å¹¶è¡Œè®¡ç®—çš„é›†åˆ</p> <p><strong>å¼¹æ€§</strong>:</p> <ul><li>å†…å­˜ï¼š(å†…å­˜ç£ç›˜è‡ªåŠ¨åˆ‡æ¢)ã€</li> <li>å®¹é”™ï¼š(æ•°æ®ä¸¢å¤±å¯è‡ªåŠ¨æ¢å¤)</li> <li>è®¡ç®—ï¼š(è®¡ç®—å‡ºé”™å¯é‡è¯•)</li> <li>åˆ†ç‰‡ï¼š(æŒ‰éœ€é‡æ–°åˆ†ç‰‡)</li></ul> <p><strong>æŠ½è±¡</strong>ï¼šæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»,å¯æŒ‰éœ€å­ç±»æ·»åŠ æ‰©å±•</p> <p><strong>æ•°æ®é›†</strong>ï¼šå°è£…äº†è®¡ç®—é€»è¾‘ã€ä¸ä¿å­˜æ•°æ®</p> <p><strong>åˆ†å¸ƒå¼</strong>ï¼šæ•°æ®å­˜å‚¨é›†ç¾¤ä¸åŒèŠ‚ç‚¹ä¸Š</p> <p><strong>ä¸å¯å˜</strong>ï¼šå°è£…äº†è®¡ç®—é€»è¾‘ï¼Œæ˜¯ä¸å¯æ”¹å˜çš„ï¼Œéœ€è¦æ”¹å˜åªèƒ½äº§ç”Ÿæ–°RDD</p> <p><strong>å¯åˆ†åŒºã€å¹¶è¡Œè®¡ç®—</strong></p></blockquote> <p>æ‰©å±•ï¼š</p> <p>RDDå¤„ç†çš„æ•°æ®çš„æ–¹å¼ç±»å‹äºIOæµ,ä¹Ÿæœ‰<strong>è£…é¥°è€…è®¾è®¡æ¨¡å¼</strong></p> <p>å‰é¢å¤„ç†æ•°æ®flatmapã€reduceBykey...æ˜¯æ„å»ºå¤„ç†æ•°æ®çš„æ–¹å¼(åŠŸèƒ½æ‰©å±•ä¸€æ­¥å¥—ä¸€æ­¥)ï¼Œä¸ä¼šçœŸæ­£å¤„ç†æ•°æ®ï¼Œå½“æ‰§è¡Œåˆ°<strong>collect()æ—¶æ‰çœŸæ­£å¼€å§‹å¤„ç†æ•°æ®</strong>,ä½†rddä¸ä¿å­˜æ•°æ®ï¼Œioä¼šä¸´æ—¶ä¿å­˜ä¸€å°éƒ¨åˆ†æ•°æ®ã€‚</p> <p><strong>æ ¸å¿ƒå±æ€§</strong></p> <ul><li><strong>åˆ†åŒºåˆ—è¡¨</strong>ï¼šRDDæ•°æ®ç»“æ„ä¸­å­˜åœ¨åˆ†åŒºåˆ—è¡¨ï¼Œç”¨äºæ‰§è¡Œä»»åŠ¡æ—¶å¹¶è¡Œè®¡ç®—ã€‚</li> <li><strong>åˆ†åŒºè®¡ç®—å‡½æ•°</strong>ï¼šä½¿ç”¨åˆ†åŒºè®¡ç®—å‡½æ•°å¯¹æ¯ä¸€ä¸ªåˆ†åŒºè¿›è¡Œè®¡ç®—  (å› ä¸ºé€»è¾‘å·²ç»å°è£…å¥½äº†)</li> <li><strong>RDDä¹‹é—´çš„ä¾èµ–å…³ç³»</strong>ï¼šrddæ˜¯è®¡ç®—æ¨¡å‹çš„å°è£…ï¼Œæœ‰æ—¶ä¹Ÿéœ€è¦å¤šä¸ªè®¡ç®—æ¨¡å‹è¿›è¡Œç»„åˆã€‚</li> <li><strong>åˆ†åŒºå™¨</strong>:ï¼ˆå¯é€‰ï¼‰å½“æ•°æ®ä¸º KV ç±»å‹æ•°æ®æ—¶ï¼Œå¯ä»¥é€šè¿‡è®¾å®šåˆ†åŒºå™¨è‡ªå®šä¹‰æ•°æ®çš„åˆ†åŒº</li> <li><strong>é¦–é€‰ä½ç½®</strong>: é€‰æ‹©ä¸åŒçš„èŠ‚ç‚¹ä½ç½®(<strong>æ•°æ®çš„ä½ç½®)<strong>è¿›è¡Œè®¡ç®—</strong>(å› ä¸ºç§»åŠ¨æ•°æ®ä¸å¦‚ç§»åŠ¨è®¡ç®—)</strong></li></ul> <p><strong>æ‰§è¡ŒåŸç†</strong>:</p> <p>RDDæ˜¯æ•°æ®å¤„ç†æ˜¯æ ¸å¿ƒæ¨¡å‹ã€‚</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#å·¥ä½œåŸç†</span>
<span class="token number">1</span>. å¯åŠ¨yarné›†ç¾¤ç¯å¢ƒ <span class="token builtin class-name">:</span> RM -<span class="token operator">&gt;</span> NM
<span class="token number">2</span>. sparké€šè¿‡ç”³è¯·èµ„æºè°ƒåº¦èŠ‚ç‚¹Driverå’Œè®¡ç®—èŠ‚ç‚¹Executor 
	Dirver åœ¨RMä¸­ è€ŒExecutoråœ¨NMä¸­
<span class="token number">3</span>. æ ¹æ®éœ€æ±‚å°†è®¡ç®—é€»è¾‘æ ¹æ®åˆ†åŒºåˆ’åˆ†æˆä¸åŒçš„ä»»åŠ¡  å°†ä»»åŠ¡æ”¾ç½®åœ¨ ä»»åŠ¡æ±  å½“ä¸­ Driverè°ƒåº¦ 
<span class="token number">4</span>. è°ƒåº¦çš„èŠ‚ç‚¹å°†ä»»åŠ¡æ ¹æ®è®¡ç®—èŠ‚ç‚¹çŠ¶æ€<span class="token punctuation">(</span>é¦–é€‰ä½ç½®<span class="token punctuation">)</span>å‘é€åˆ°å¯¹åº”çš„ä½ç½®ä¸Šè¿›è¡Œè®¡ç®—
<span class="token comment"># RDDæ•´ä¸ªæµç¨‹ä¸»è¦æ˜¯è®²é€»è¾‘è¿›è¡Œå°è£…,ä»¥åŠç”ŸæˆTaskå‘é€ç»™Executor</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="rddåŸºç¡€ç¼–ç¨‹"><a href="#rddåŸºç¡€ç¼–ç¨‹" class="header-anchor">#</a> RDDåŸºç¡€ç¼–ç¨‹</h3> <p><strong>RDD</strong> <strong>åˆ›å»º</strong></p> <ul><li><p>å†…å­˜åˆ›å»º (å¸¸ç”¨) :``makeRDD(seq or list) åº•å±‚è°ƒç”¨äº†`parallelizeæ–¹æ³•</p> <blockquote><p>é»˜è®¤æ˜¯å¹¶è¡Œåº¦åˆ†åŒºæ•°(å½“å‰ç¯å¢ƒè¿è¡Œæœ€å¤§æ ¸æ•°),ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®š</p></blockquote></li> <li><p>å¤–éƒ¨å­˜å‚¨æ–‡ä»¶åˆ›å»º (å¸¸ç”¨)</p> <blockquote><p><code>textFile(&quot;datas/1*.txt&quot;)æŒ‰è¡Œè¯»å–</code> è¿”å›å­—ç¬¦ä¸²  é»˜è®¤æ˜¯ä¿©ä¸ªåˆ†åŒº math.min(æ ¸æ•°,2)  ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®š</p> <p><code>wholeTextFiles æŒ‰æ–‡ä»¶è¯»å–</code>ï¼šè¿”å›å…ƒç»„(è·¯å¾„,å†…å®¹)</p></blockquote></li> <li><p>å…¶ä»–çš„RDDåˆ›å»º</p></li> <li><p>ç›´æ¥åˆ›å»º(new)</p></li></ul> <div class="language-scala line-numbers-mode"><pre class="language-scala"><code>    <span class="token comment">//local[*] [*]è¡¨ç¤ºåˆ©ç”¨å½“å‰ç”µè„‘çš„CPUæ ¸æ•°æ¨¡æ‹Ÿçº¿ç¨‹æ‰§è¡Œ *è¡¨ç¤ºå½“å‰çº¿æœ€å¤§ä½¿ç”¨æ ¸æ•°</span>
    <span class="token comment">//local ä¸å†™é»˜è®¤æ˜¯å•æ ¸çº¿ç¨‹æ‰§è¡Œ</span>
    <span class="token keyword">val</span> sparkConf<span class="token operator">=</span><span class="token keyword">new</span> SparkConf<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setMaster<span class="token punctuation">(</span><span class="token string">&quot;local[*]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setAppName<span class="token punctuation">(</span><span class="token string">&quot;RDDtest&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> sc <span class="token operator">=</span> <span class="token keyword">new</span> SparkContext<span class="token punctuation">(</span>sparkConf<span class="token punctuation">)</span>
    <span class="token comment">//ä»å†…å­˜ä¸­åˆ›å»º æ¥è‡ªé›†åˆ</span>
    <span class="token comment">//val  seq=Seq[Int](1,3,4,2)</span>
<span class="token comment">//    val rdd = sc.makeRDD(seq)//åº•å±‚è°ƒç”¨parallelize</span>
    <span class="token keyword">val</span> rdd <span class="token operator">=</span> sc<span class="token punctuation">.</span>makeRDD<span class="token punctuation">(</span>
      List<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token comment">//åˆ†åŒºæ•° é»˜è®¤æ˜¯å¹¶è¡Œåº¦åˆ†åŒºæ•°(å½“å‰ç¯å¢ƒè¿è¡Œæœ€å¤§æ ¸æ•°)</span>
    <span class="token punctuation">)</span>
    rdd<span class="token punctuation">.</span>saveAsTextFile<span class="token punctuation">(</span><span class="token string">&quot;output&quot;</span><span class="token punctuation">)</span><span class="token comment">//è®²æ•°æ®ä¿å­˜æˆåˆ†åŒºæ–‡ä»¶</span>
    <span class="token comment">//è¯»å–æ–‡ä»¶ é¡¹ç›®æ ¹è·¯å¾„  ç›®å½• ä¹Ÿå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ è¿˜å¯ä»¥æŒ‡å®š hdfsè·¯å¾„</span>
<span class="token comment">//    sc.wholeTextFiles(&quot;wenj&quot;) æŒ‰è¡Œè¯»å–</span>
<span class="token comment">//    val rdd = sc.textFile(&quot;datas/1*.txt&quot;)//å½“å‰ç¯å¢ƒæ ¹è·¯å¾„ä¸ºåŸºå‡†ã€‚å¯ä»¥å†™ç»å¯¹orç›¸å¯¹</span>
    <span class="token comment">//hdfs://ä¸»æœºå:8020/æ–‡ä»¶ç›®å½•è·¯å¾„</span>
    <span class="token comment">//å¹¶è¡Œparallelize   éœ€è¦è·Ÿæ ¸æ•°</span>
    rdd<span class="token punctuation">.</span>collect<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>foreach<span class="token punctuation">(</span>println<span class="token punctuation">)</span>
    sc<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>åˆ†åŒºçš„è®¾ç½®</strong></p> <ul><li>makeRDDï¼šé»˜è®¤æ˜¯è¯»å–é…ç½®çš„å‚æ•°å¦‚æœæ²¡æœ‰ï¼Œé»˜è®¤æ˜¯å¹¶è¡Œåº¦åˆ†åŒºæ•°(å½“å‰ç¯å¢ƒè¿è¡Œæœ€å¤§æ ¸æ•°),</li> <li>textfileï¼šé»˜è®¤æ˜¯è¯»å–é…ç½®çš„å‚æ•°å¦‚æœæ²¡æœ‰,å°±æ˜¯é»˜è®¤æ˜¯ä¿©ä¸ªåˆ†åŒº math.min(æ ¸æ•°,2)</li></ul> <blockquote><p>ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šåˆ†åŒºæ•°é‡</p></blockquote> <p><strong>åˆ†åŒºçš„åˆ’åˆ†</strong>:</p> <div class="language-scala line-numbers-mode"><pre class="language-scala"><code># æ ¸å¿ƒæºç 
<span class="token keyword">def</span> positions<span class="token punctuation">(</span>length<span class="token operator">:</span> <span class="token builtin">Long</span><span class="token punctuation">,</span> numSlices<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> Iterator<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
 <span class="token punctuation">(</span><span class="token number">0</span> until numSlices<span class="token punctuation">)</span><span class="token punctuation">.</span>iterator<span class="token punctuation">.</span>map <span class="token punctuation">{</span> i <span class="token keyword">=&gt;</span>
 <span class="token keyword">val</span> start <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">*</span> length<span class="token punctuation">)</span> <span class="token operator">/</span> numSlices<span class="token punctuation">)</span><span class="token punctuation">.</span>toInt
 <span class="token keyword">val</span> end <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> length<span class="token punctuation">)</span> <span class="token operator">/</span> numSlices<span class="token punctuation">)</span><span class="token punctuation">.</span>toInt
 <span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>åˆ†åŒºçš„å†…å®¹åˆ’åˆ†</strong>ï¼š</p> <p>ä»¥è¡Œä¸ºå•ä½,è¿›è¡Œè¯»å–,è¯»å–æ—¶ä»¥åç§»é‡ä¸ºå•ä½</p> <p>æ•°æ®åˆ†åŒºæ ¹æ®åç§»é‡èŒƒå›´è¿›è¡Œè®¡ç®—ï¼Œåç§»é‡ä¸ä¼šè¢«é‡å¤è¯»å–ã€‚</p> <p><strong>åˆ†åŒºè€ƒè¯</strong>ï¼š</p> <div class="language-scala line-numbers-mode"><pre class="language-scala"><code>  <span class="token keyword">def</span> main<span class="token punctuation">(</span>args<span class="token operator">:</span> Array<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">//local[*] [*]è¡¨ç¤ºåˆ©ç”¨å½“å‰ç”µè„‘çš„CPUæ ¸æ•°æ¨¡æ‹Ÿçº¿ç¨‹æ‰§è¡Œ *è¡¨ç¤ºå½“å‰çº¿æœ€å¤§ä½¿ç”¨æ ¸æ•°</span>
    <span class="token comment">//local ä¸å†™é»˜è®¤æ˜¯å•æ ¸çº¿ç¨‹æ‰§è¡Œ</span>
    <span class="token keyword">val</span> sparkConf<span class="token operator">=</span><span class="token keyword">new</span> SparkConf<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setMaster<span class="token punctuation">(</span><span class="token string">&quot;local[*]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setAppName<span class="token punctuation">(</span><span class="token string">&quot;RDDtest&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> sc <span class="token operator">=</span> <span class="token keyword">new</span> SparkContext<span class="token punctuation">(</span>sparkConf<span class="token punctuation">)</span>
    <span class="token comment">//14byte/2=7byte</span>
    <span class="token comment">//èƒ½æ•´é™¤ ä¿©åˆ†åŒº</span>
      <span class="token comment">/*
      é»˜è®¤åŠ å›è½¦æ¢è¡Œ
      1234567@@ =&gt; 01245678         åç§»é‡
      89@@      =&gt; 910 11 12
      0         =&gt; 13
      é¢„ä¼°èŒƒå›´ é‡Œçš„å€¼
      [0,7] =&gt; 0124567
      [7,14] =&gt;890
       */</span>
    <span class="token keyword">val</span> rdd <span class="token operator">=</span> sc<span class="token punctuation">.</span>textFile<span class="token punctuation">(</span><span class="token string">&quot;datas/word.txt&quot;</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    rdd<span class="token punctuation">.</span>saveAsTextFile<span class="token punctuation">(</span><span class="token string">&quot;output&quot;</span><span class="token punctuation">)</span>
    sc<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p><strong>ç®—å­</strong>ï¼šRDDå¯¹è±¡æ–¹æ³•</p> <ul><li>è½¬æ¢ç®—å­ï¼šåŠŸèƒ½çš„è¡¥å……å’Œå°è£… ä¾‹: flatmap.map</li> <li>è¡ŒåŠ¨ç®—å­ï¼šè§¦å‘ä½œä¸šæ‰§è¡Œå’Œä»»åŠ¡è°ƒåº¦ ä¾‹ï¼šcollect</li></ul> <blockquote><p>æŠŠè¿™äº›<strong>æ–¹æ³•</strong>å°†å…¶ç§°ä¸ºRDD<strong>ç®—å­</strong>  Operator(æ“ä½œ)</p></blockquote> <h3 id="rddè½¬æ¢ç®—å­"><a href="#rddè½¬æ¢ç®—å­" class="header-anchor">#</a> RDDè½¬æ¢ç®—å­</h3> <p>æ•°æ®å¤„ç†æ–¹å¼ï¼šæ•´ä½“ä¸Šåˆ†ä¸º Value ç±»å‹ã€åŒ Value ç±»å‹å’Œ Key-Valueç±»å‹</p> <p><strong>Value</strong> <strong>ç±»å‹</strong></p> <ul><li><p><strong>map</strong> ï¼šå°†å¤„ç†çš„æ•°æ®é€æ¡è¿›è¡Œæ˜ å°„è½¬æ¢  (åˆ†åŒºå†…)</p> <blockquote><p>ä¸åŒåˆ†åŒºæ— åº      åŒåˆ†åŒºå†…æ‰§è¡Œæœ‰åº(ä¸€ä¸ªä¸€ä¸ª)</p></blockquote></li> <li><p><strong>mapPartitions</strong>ï¼š <strong>ä»¥åˆ†åŒºä¸ºå•ä½</strong>å‘é€åˆ°è®¡ç®—èŠ‚ç‚¹è¿›è¡Œå¤„ç†   (æ‰¹å¤„ç†æ“ä½œ)</p> <blockquote><p>æŠŠåˆ†åŒºå†…çš„æ•°æ®å…¨éƒ¨éƒ½æ‹¿åˆ°å†è¿›è¡Œæ“ä½œ, é‡Œé¢æ˜¯è¿­ä»£å™¨</p> <p>ä¼šå°†æ•´ä¸ªåˆ†åŒºçš„æ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­,è¿›è¡Œå¼•ç”¨ï¼Œå¤„ç†å®Œä¹Ÿä¸ä¼šè¢«é‡Šæ”¾ï¼Œå­˜åœ¨è¢«å¼•ç”¨</p> <p>å†…å­˜è¾ƒå°æ•°æ®è¾ƒå¤§ä¼šå¯¼è‡´å†…å­˜æº¢å‡º</p></blockquote></li> <li><p><strong>mapPartitionsWithIndex</strong>: åˆ†åŒºç´¢å¼•</p> <blockquote><p>å¯æŒ‡å®šç´¢å¼•æŒ‰éœ€è¿”å›çš„åˆ†åŒº, <code>Nil.iterator ç©ºè¿­ä»£å™¨</code></p></blockquote></li> <li><p><strong>flatMap</strong>: æ‰å¹³æ˜ å°„ List =&gt; Int ..</p> <blockquote><p>è¿”å›ä¸€ä¸ªå¯è¿­ä»£çš„é›†åˆ</p></blockquote></li> <li><p><strong>glom</strong> ï¼š æ•°æ®è½¬æ¢æˆå†…å­˜æ•°ç»„  int =&gt; LIst</p> <blockquote><p>ä¸€ä¸ªåˆ†åŒºä¸€ä¸ªæ•°ç»„  åˆ†åŒºä¸å˜è½¬æ¢çš„æ•°æ®ä¹Ÿä¸å˜</p></blockquote></li> <li><p><strong>groupBy</strong>: åˆ†åŒºä¸ªæ•°ä¸å˜ï¼Œå¯¹æŒ‡å®šè§„åˆ™è¿›è¡Œåˆ†ç»„ï¼Œæ•°æ®ä¼šè¢«é‡æ–°ç»„åˆ(<strong>shuffle</strong>)</p> <blockquote><p>å¯¹ç›¸åŒçš„keyæ”¾ç½®åŒä¸€ä¸ªç»„ä¸­</p> <p>åˆ†åŒºå’Œåˆ†ç»„æ²¡æœ‰å¿…ç„¶å…³ç³»ï¼Œåˆ†åŒºé‡Œé¢çš„æ•°æ®ä¼šæ”¹å˜(æ‰“ä¹±æ´—ç‰Œ)</p></blockquote></li> <li><p><strong>filter</strong> :è¿‡æ»¤</p> <blockquote><p>è¿‡æ»¤ååˆ†åŒºä¸å˜ï¼Œå¯èƒ½åˆ†åŒºå†…çš„æ•°æ®ä¸å‡è¡¡ï¼Œä¼šå‘ç”Ÿ<strong>æ•°æ®å€¾æ–œ</strong></p></blockquote></li> <li><p><strong>sample</strong> :æŠ½å–æ•°æ®</p> <blockquote><p>æœ‰é‡å¤çš„æ¦‚å¿µ</p> <p>åŸºå‡†å€¼æ¦‚å¿µï¼šæ¦‚ç‡</p> <p>ä¸‰ä¸ªå‚æ•°:</p> <ul><li>æ˜¯å¦æ”¾å›å»</li> <li>ä¸æ”¾å›è¡¨ç¤ºï¼šæ¯æ¡æ•°æ®æŠ½å–çš„æ¦‚ç‡(åˆ†æ•°) ï¼Œæ”¾å›ï¼šè¡¨ç¤ºæ¯æ¡æ•°æ®æŠ½å–çš„å¯èƒ½æ¬¡æ•°ï¼ˆæ•´æ•°ï¼‰</li> <li>éšæœºç®—æ³•çš„ç§å­(ä¸ä¼ é€’è¡¨ç¤ºå½“å‰ç³»ç»Ÿæ—¶é—´,éšæœº)</li></ul></blockquote></li> <li><p><strong>distinct</strong>ï¼šå»é‡</p> <blockquote><p>åŸç†é‡‡ç”¨ mapè½¬æ¢æˆ(å€¼,null)ç„¶åreduceBykey()æ ¹æ®å€¼è¿›è¡Œèšåˆç„¶åmapå–å‡ºå€¼ã€‚</p></blockquote></li> <li><p><strong>coalesce</strong> ï¼šç¼©å‡åˆ†åŒº</p> <blockquote><p>è¿‡æ»¤åçš„æ•°æ®æ¯”è¾ƒå°,ä½†æ˜¯åˆ†åŒºæ•°ä¸å˜,æ‰§è¡Œéœ€è¦ä¿©ä¸ªExecutoræ‰§è¡Œã€‚</p> <p>è€Œcoalesceå¯ä»¥æŠŠä»–ä»¬åˆå¹¶æˆä¸€ä¸ªåˆ†åŒºå†äº¤ç»™ä¸€ä¸ªExecutoræ‰§è¡Œï¼ˆæé«˜æ‰§è¡Œæ•ˆç‡ï¼‰</p> <p>é»˜è®¤ä¸ä¼šå°†æ•°æ®æ‰“ä¹±é‡æ–°ç»„åˆï¼Œå¯èƒ½ä¼šå‡ºç°<strong>æ•°æ®å€¾æ–œ</strong>ã€‚å¯ä»¥è¿›è¡Œshuffle</p> <p>ç¬¬ä¸€ä¸ªå‚æ•°åˆ†åŒºä¸ªæ•°,ç¬¬äºŒä¸ªæ˜¯å¦å¼€å¯shuffle</p> <p>ä¹Ÿå¯ä»¥æ‰©å¤§åˆ†åŒºå‰ææ˜¯å¼€å¯shuffle</p></blockquote></li> <li><p><strong>repartition</strong>: æ‰©å¤§åˆ†åŒº</p> <blockquote><p>åº•å±‚è°ƒç”¨äº†coalesce ä¸”å¼€å¯shuffle</p></blockquote></li> <li><p><strong>sortBy</strong>: æ’åº</p> <blockquote><p>åº•å±‚æœ‰shuffle,ç¬¬äºŒä¸ª<strong>å‚æ•°æŒ‡å®šæ’åºæ–¹å¼</strong>tureå‡åº(é»˜è®¤)</p></blockquote></li></ul> <p><strong>åŒValueç±»å‹</strong>ï¼š</p> <ul><li><p>intersection :äº¤é›†</p></li> <li><p>unionï¼šå¹¶é›†</p></li> <li><p>subtracrï¼šå·®é›†</p></li> <li><p>zip: æ‹‰é“¾  ï¼ˆå¯¹åº”ä½ç½®ç»“åˆæˆä¸€ä¸ªå…ƒç»„ï¼‰<strong>æ•°æ®ç±»å‹å¯ä»¥ä¸ä¸€è‡´</strong></p> <blockquote><p>æ³¨æ„ï¼šåˆ†åŒºæ•°é‡è¦ä¸€è‡´ï¼Œæ¯ä¸ªåˆ†åŒºå…ƒç´ æ•°é‡è¦ä¸€è‡´ã€‚</p></blockquote></li></ul> <p><strong>Key-Valueç±»å‹</strong>ï¼š</p> <ul><li><p><strong>partitionBy</strong> :æŒ‰ç…§æŒ‡å®šè§„åˆ™é‡æ–°è¿›è¡Œåˆ†åŒº</p> <blockquote><p>é»˜è®¤åˆ†åŒºå™¨æ˜¯ï¼šHashPartitioner</p> <p>å¯ä»¥è‡ªå®šä¹‰åˆ†åŒºå™¨ï¼šå®ç°æ’åºè§„åˆ™</p></blockquote></li> <li><p><strong>reduceBykey</strong>: æŒ‰ç…§ç›¸åŒkeyå¯¹valueè¿›è¡Œèšåˆ</p> <blockquote><p>(v1,v2) ä¿©ä¸¤èšåˆ å¦‚æœkeyä¸ºä¸€ä¸ªå°±ä¸ä¼šå‚ä¸è®¡ç®—ç›´æ¥è¿”å›</p> <p><strong>æœ‰åˆ†ç»„æœ‰èšåˆ</strong> åœ¨è½ç›˜ä¹‹å‰ä¼šè¿›è¡Œ<strong>é¢„èšåˆ</strong>(åˆ†åŒºå†…)å‡å°‘è½ç›˜æ•°æ®é‡æé«˜IOæ€§èƒ½</p></blockquote></li> <li><p><strong>groupBykey</strong>ï¼šç›¸åŒkeyçš„æ•°æ®åˆ†åœ¨ä¸€ä¸ªç»„ä¸­å½¢æˆå¯¹å¶å…ƒç»„</p> <blockquote><p>ï¼ˆkev,iter(value)ï¼‰</p> <p>å­˜åœ¨shuffle(å¿…é¡»è¦è½ç›˜æ‰å¤„ç†,å¦åˆ™ä¼šå­˜åœ¨å†…å­˜æº¢å‡º)ï¼Œæ‰€ä»¥shuffleæ“ä½œæ€§èƒ½éå¸¸ä½</p> <p>æœ‰åˆ†ç»„å’Œ<strong>æ²¡èšåˆ</strong>(èšåˆé€šè¿‡åˆ«çš„æ–¹å¼)</p></blockquote></li> <li><p><strong>aggregatebykey</strong> :åˆ†åŒºèšåˆ</p> <blockquote><p>åˆ¶å®š<strong>ä¸åŒçš„è§„åˆ™</strong>è¿›è¡Œåˆ†åŒºè®¡ç®—å’Œåˆ†åŒºä¹‹é—´è®¡ç®—</p> <p>å­˜åœ¨å‡½æ•°æŸ¯é‡ŒåŒ–ï¼šä¿©ä¸ªå‚æ•°åˆ—è¡¨</p> <p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åˆå§‹å€¼ï¼šä¼ é€’ç»™åˆ†åŒºå†…è¿›è¡Œè®¡ç®—çš„ç¬¬ä¸€ä¸ªåˆå§‹å€¼</p> <p>ç¬¬äºŒä¸ªå‚æ•°åˆ—è¡¨ï¼šä¼ é€’åˆ†åŒºå†…è®¡ç®—è§„åˆ™ï¼Œä¼ é€’åˆ†åŒºé—´è®¡ç®—è§„åˆ™</p> <p><strong>å½“åˆ†åŒºå†…å’Œåˆ†åŒºé—´ç›¸åŒ</strong>å¯ä»¥ç”¨ <strong>forldBykey</strong> è¿›è¡Œç®€åŒ–</p></blockquote></li> <li><p><strong>mapValues</strong> ï¼škeyä¿æŒä¸å˜ å¯¹valueå¯¹è±¡è½¬æ¢</p></li> <li><p><strong>combineBykey</strong> : (ç›¸åŒçš„keyè¿›è¡Œæ“ä½œ)(åˆ†åŒºå†…)(åˆ†åŒºé—´)</p></li> <li><p><strong>sortByKey</strong>:æ ¹æ®keyè¿›è¡Œæ’åº</p> <blockquote><p>K å¿…é¡»å®ç° Ordered æ¥å£(ç‰¹è´¨)</p> <p>è¿”å›ä¸€ä¸ªæŒ‰ç…§ key è¿›è¡Œæ’åºçš„</p> <div class="language-scala line-numbers-mode"><pre class="language-scala"><code><span class="token keyword">val</span> dataRDD1 <span class="token operator">=</span> sparkContext<span class="token punctuation">.</span>makeRDD<span class="token punctuation">(</span>List<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">val</span> sortRDD1<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> dataRDD1<span class="token punctuation">.</span>sortByKey<span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> #æ­£åº
<span class="token keyword">val</span> sortRDD1<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> dataRDD1<span class="token punctuation">.</span>sortByKey<span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>#å€’åº
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></blockquote></li> <li><p><strong>join</strong>ï¼šè¿æ¥  ç›¸åŒkeyçš„æ•°æ®è¿æ¥åœ¨ä¸€èµ· ç±»ä¼¼å†…è¿æ¥  ç¬›å¡å°”ç§¯ shuffle æ•°æ®å€å¢é•¿..</p></li> <li><p><strong>leftOuterJoin</strong> :å·¦è¿æ¥   ä¸»/ä»</p></li> <li><p><strong>rightOuterJoin</strong> : å³è¿æ¥   ä¸»/ä»</p></li> <li><p><strong>cogroup</strong>ï¼šconect+group ç›¸åŒçš„keyæ”¾åœ¨ä¸€ä¸ªç»„ä¸­ï¼Œç„¶åè¿æ¥åœ¨ä¸€èµ·</p></li></ul> <p>æ¡ˆä¾‹</p> <div class="language-scala line-numbers-mode"><pre class="language-scala"><code><span class="token number">1516609143867</span> <span class="token number">6</span> <span class="token number">7</span> <span class="token number">64</span> <span class="token number">16</span>
æ—¶é—´  çœä»½ åŸå¸‚ ç”¨æˆ· å¹¿å‘Š
éœ€æ±‚ï¼šç»Ÿè®¡å‡ºæ¯ä¸ªçœä»½æ¯ä¸ªå¹¿å‘Šè¢«ç‚¹å‡»æ•°é‡çš„Top3
   <span class="token keyword">val</span> sparkConf<span class="token operator">=</span><span class="token keyword">new</span> SparkConf<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setMaster<span class="token punctuation">(</span><span class="token string">&quot;local[*]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setAppName<span class="token punctuation">(</span><span class="token string">&quot;Operstor&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> sc <span class="token operator">=</span> <span class="token keyword">new</span> SparkContext<span class="token punctuation">(</span>sparkConf<span class="token punctuation">)</span>
    <span class="token comment">//map</span>
    <span class="token keyword">val</span> rdd <span class="token operator">=</span> sc<span class="token punctuation">.</span>textFile<span class="token punctuation">(</span><span class="token string">&quot;datas/agent.log&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> values<span class="token operator">:</span> Array<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> List<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> rdd<span class="token punctuation">.</span>map<span class="token punctuation">(</span>s <span class="token keyword">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">val</span> arr <span class="token operator">=</span> s<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">(</span><span class="token punctuation">(</span>arr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> arr<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">//((a,b),c)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reduceByKey<span class="token punctuation">(</span>_ <span class="token operator">+</span> _<span class="token punctuation">)</span> <span class="token comment">// ((a,b),iter[C])</span>
      <span class="token punctuation">.</span>map <span class="token punctuation">{</span> <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>prv<span class="token punctuation">,</span> ad<span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token punctuation">(</span>prv<span class="token punctuation">,</span> <span class="token punctuation">(</span>ad<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token comment">//(a,(b,iter[C]))</span>
      <span class="token punctuation">.</span>groupByKey<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//å¯¹aåˆ†ç»„</span>
      <span class="token punctuation">.</span>mapValues<span class="token punctuation">(</span>kv <span class="token keyword">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">val</span> list <span class="token operator">=</span> kv<span class="token punctuation">.</span>toList<span class="token comment">// è½¬æ¢æˆåˆ—è¡¨æ‰èƒ½è°ƒç”¨æ–¹æ³•</span>
        <span class="token keyword">val</span> tuples <span class="token operator">=</span> list<span class="token punctuation">.</span>sortBy<span class="token punctuation">(</span>_<span class="token punctuation">.</span>_2<span class="token punctuation">)</span><span class="token punctuation">(</span>Ordering<span class="token punctuation">.</span><span class="token builtin">Int</span><span class="token punctuation">.</span>reverse<span class="token punctuation">)</span> <span class="token comment">//æ’åºåè½¬</span>
        tuples<span class="token punctuation">.</span>take<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token comment">//å–å‡ºå‰3</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>collect<span class="token punctuation">(</span><span class="token punctuation">)</span>
    values<span class="token punctuation">.</span>foreach<span class="token punctuation">(</span>println<span class="token punctuation">)</span>
    sc<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="rddè¡ŒåŠ¨ç®—å­"><a href="#rddè¡ŒåŠ¨ç®—å­" class="header-anchor">#</a> RDDè¡ŒåŠ¨ç®—å­</h3> <p>è§¦å‘ä½œä¸šçš„æ‰§è¡Œçš„æ–¹æ³•</p> <blockquote><p>åº•å±‚è°ƒç”¨äº†runjobæ–¹æ³•</p> <p>æœ€åé€šè¿‡é‚®ç®±æ— ç¯å›¾è¿è¡Œrunjobé‡Œé¢æœ‰ä¸ªsubmitjobæäº¤ä»»åŠ¡</p> <p><code>æœ€ååˆ›å»ºäº† new ActiveJob</code></p></blockquote> <ul><li><p>reduce  : ä¿©ä¿©èšåˆ</p> <blockquote><p>èšé›† RDD ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œå…ˆèšåˆåˆ†åŒºå†…æ•°æ®ï¼Œå†èšåˆåˆ†åŒºé—´æ•°æ®</p></blockquote></li> <li><p>collect ï¼šé‡‡é›†</p> <blockquote><p>å°†ä¸åŒåˆ†åŒºçš„æ•°æ®æŒ‰ç…§åˆ†åŒºé¡ºåºè¿›è¡Œé‡‡é›†åˆ°Dirverç«¯å†…å­˜ä¸­è¿›è¡Œå¤„ç†ï¼Œå½¢æˆ<strong>æ•°ç»„</strong></p></blockquote></li> <li><p>count ï¼šæ•°æ®çš„ä¸ªæ•°</p></li> <li><p>firstï¼šç¬¬ä¸€ä¸ª</p></li> <li><p>takeï¼šå–nä¸ªæ•°æ®</p></li> <li><p>takeOrderedï¼šæ’åºå–nä¸ª</p></li> <li><p>aggregateï¼šä¸éœ€è¦è€ƒè™‘æ•°æ®çš„ç±»å‹</p> <blockquote><p>åˆå§‹å€¼ä¼šå‚ä¸åˆ†åŒºå†…åˆ†åŒºé—´è®¡ç®—</p></blockquote></li> <li><p>flodï¼šåˆ†åŒºå†…å’Œåˆ†åŒºé—´ç›¸åŒ</p></li> <li><p>countBykeyï¼šç»Ÿè®¡keyå‡ºç°æ¬¡æ•°</p></li> <li><p>countByValueï¼šç»Ÿè®¡valueå‡ºç°çš„æ¬¡æ•°</p></li> <li><p>save ç›¸å…³</p> <blockquote><p>saveAsTestFile:æ–‡æœ¬æ ¼å¼</p> <p>saveObjectFile: å¯¹è±¡æ ¼å¼</p> <p>saveSerquenceFile:è¦æ±‚æ•°æ®æ ¼å¼æ˜¯k-vç±»å‹</p></blockquote></li> <li><p>foreacchï¼š<strong>åˆ†å¸ƒå¼</strong>éå†RDDæ¯ä¸€ä¸ªå…ƒç´ ã€‚executorç«¯</p> <blockquote><p>RDDçš„æ–¹æ³•å’Œscalaé›†åˆçš„æ–¹æ³•ä¸ä¸€æ ·ï¼Œé›†åˆå¯¹è±¡çš„æ–¹æ³•éƒ½æ˜¯åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹çš„å†…å­˜ä¸­å®Œæˆçš„</p> <p>ç®—å­æ˜¯åœ¨executorç«¯æ‰§è¡Œçš„</p></blockquote></li></ul> <h3 id="rdd-åºåˆ—åŒ–"><a href="#rdd-åºåˆ—åŒ–" class="header-anchor">#</a> <strong>RDD</strong> <strong>åºåˆ—åŒ–</strong></h3> <p><strong>é—­åŒ…æ£€æŸ¥</strong>ï¼šç®—å­ä»¥å¤–çš„ä»£ç éƒ½æ˜¯åœ¨ Driver ç«¯æ‰§è¡Œ, ç®—å­é‡Œé¢çš„ä»£ç éƒ½æ˜¯åœ¨ Executorç«¯æ‰§è¡Œ</p> <p><strong>Kryo åºåˆ—åŒ–æ¡†æ¶</strong>ï¼šjavaçš„åºåˆ—åŒ–æ¡†æ¶æ¯”è¾ƒé‡,è€ŒKryo æ˜¯serializableçš„10å€ï¼Œsufflå†…éƒ¨æœ‰äº›å°±å¼€å§‹ä½¿ç”¨äº†</p> <p><strong>ä¾èµ–å…³ç³»</strong>ï¼šä¿©ä¸ªRDDä¹‹é—´çš„å…³ç³» ï¼š<code>dependencies æŸ¥çœ‹ä¾èµ–å…³ç³»</code></p> <ul><li><p><strong>è¡€ç¼˜å…³ç³»</strong>ï¼šå¤šä¸ªè¿ç»­çš„RDDä¾èµ–å…³ç³»ã€‚ï¼š<code>toDebugString è¡€ç¼˜å…³ç³»</code></p> <blockquote><p>ä¸ºäº†æé«˜RDDçš„å®¹é”™æ€§ï¼Œéœ€è¦ä¿å­˜RDDä¹‹å‰çš„å…³ç³»ï¼Œé˜²æ­¢é‡åˆ°é”™è¯¯,å¯æ ¹æ®è¡€ç¼˜å…³ç³»æ¥è¿›è¡Œæ¢å¤æ•°æ®</p> <p>æ¯ä¸ªRDDéƒ½ä¼šä¿å­˜ä¾èµ–å…³ç³»ã€‚</p></blockquote></li> <li><p><strong>å®½çª„ä¾èµ–</strong>ï¼š</p> <blockquote><p>oneTOone(çª„)ä¾èµ–ï¼šæ–°çš„RDDä¸€ä¸ªåˆ†åŒºä¾èµ–äºæ—§çš„RDD<strong>ä¸€ä¸ª</strong>åˆ†åŒº</p> <p>shuffle(å®½)ä¾èµ–ï¼šæ–°çš„RDDä¸€ä¸ªåˆ†åŒºä¾èµ–äºæ—§çš„RDD<strong>å¤šä¸ª</strong>åˆ†åŒº  taskå¢å¤š ä¸”<strong>åˆ†é˜¶æ®µ</strong></p> <p>å­˜åœ¨shuffleä¾èµ–æ—¶,é˜¶æ®µä¼šè‡ªåŠ¨å¢åŠ ä¸€ä¸ªï¼Œé˜¶æ®µæ•°é‡=shuffleä¾èµ–æ•°+1</p></blockquote></li></ul> <p><strong>rddä»»åŠ¡åˆ’åˆ†</strong>ï¼š</p> <ul><li>applicationï¼šåˆå§‹åŒ–ä¸€ä¸ªsparkcontextå³ç”Ÿæˆä¸€ä¸ªapplication</li> <li>job ï¼šä¸€ä¸ªactionç®—å­ä¼šç”Ÿæˆä¸€ä¸ªjob</li> <li>stage ï¼šç­‰äºå®½ä¾èµ–çš„ä¸ªæ•°åŠ 1</li> <li>taskï¼šä¸€ä¸ªstageé˜¶æ®µä¸­æœ€åä¸€ä¸ªrddåˆ†åŒºä¸ªæ•°å°±æ˜¯taskä¸ªæ•°</li></ul> <blockquote><p>app-&gt;job-&gt;stage-&gt;task æ¯ä¸€å±‚éƒ½æ˜¯1å¯¹nçš„å…³ç³»</p></blockquote> <h3 id="rddçš„æŒä¹…åŒ–"><a href="#rddçš„æŒä¹…åŒ–" class="header-anchor">#</a> RDDçš„æŒä¹…åŒ–</h3> <blockquote><p>é»˜è®¤rddå¯¹è±¡å¯ä»¥é‡ç”¨,æ•°æ®æ— æ³•é‡ç”¨ï¼Œæ‰€ä»¥ä¸ºäº†ä¼˜åŒ–æ­¤é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ“ä½œçš„æ•°æ®æŒä¹…åŒ–ï¼Œ</p> <p>æ–¹ä¾¿ä¸‹ä¸€æ¬¡æ“ä½œæ—¶ä½¿ç”¨ï¼Œä¸ç”¨ä»å¤´è¯»å–ã€‚</p></blockquote> <p><strong>æŒä¹…åŒ–:</strong></p> <ul><li><code>cache</code> :ä¸´æ—¶å­˜å‚¨åˆ°å†…å­˜ä¸­ å¯èƒ½ä¸å®‰å…¨</li> <li><code>perslist</code> :ä¸´æ—¶å­˜å‚¨åœ¨ç£ç›˜ å¯è®¾ç½®å­˜å‚¨çº§åˆ«ï¼Œæ•°æ®å®‰å…¨ã€æ‰§è¡ŒIO æ€§èƒ½è¾ƒä½</li></ul> <blockquote><p>å¯é‡ç”¨ï¼Œåœ¨è¡ŒåŠ¨ç®—å­æ—¶æ‰æ‰§è¡Œï¼Œä½†æ˜¯<strong>ä½œä¸šæ‰§è¡Œå®Œ</strong>ä¸´æ—¶æ–‡ä»¶éƒ½ä¼šè¢«<strong>åˆ é™¤</strong></p> <p>ä¼šåœ¨è¡€ç¼˜å…³ç³»æ·»åŠ ä¸€ä¸ªæ–°çš„ä¾èµ–ã€‚</p></blockquote> <p><strong>æ£€æŸ¥ç‚¹</strong>ï¼š<code>checkpoint</code> éœ€è¦è½ç›˜ éœ€è¦æŒ‡å®šè·¯å¾„   ä¿å­˜çš„æ–‡ä»¶ä½œä¸š<strong>æ‰§è¡Œå®Œæ–‡ä»¶ä¸ä¼šåˆ é™¤</strong></p> <blockquote><p>é•¿ä¹…ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå®‰å…¨ï¼Œä¸€èˆ¬<strong>ç‹¬ç«‹æ‰§è¡Œä¸€ä¸ªä½œä¸š</strong>ã€‚æ€§èƒ½ä½ï¼Œä¸ºäº†æé«˜æ€§èƒ½</p> <p>ä¸€èˆ¬æƒ…å†µä¸‹éœ€è¦å’Œ<strong>cacheè”åˆä½¿ç”¨</strong>ï¼Œæ‰€ä»¥å…ˆå¼€å¯cacheå†å¼€å¯checkpointã€‚</p> <p>æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šåˆ‡æ–­è¡€ç¼˜å…³ç³»ã€‚é‡æ–°å»ºç«‹æ–°çš„è¡€ç¼˜å…³ç³»ã€‚ç­‰åŒäºæ”¹å˜äº†æ•°æ®æºã€‚</p></blockquote> <p><strong>åˆ†åŒºå™¨</strong>ï¼šç›®å‰æ”¯æŒ Hash(é»˜è®¤) åˆ†åŒºå’Œ Range åˆ†åŒº</p> <ul><li><strong>Hash</strong>ï¼šå¯¹äºç»™å®šçš„ keyï¼Œè®¡ç®—å…¶ hashCode,å¹¶é™¤ä»¥åˆ†åŒºä¸ªæ•°å–ä½™</li> <li><strong>Range</strong> ï¼šå°†ä¸€å®šèŒƒå›´å†…çš„æ•°æ®æ˜ å°„åˆ°ä¸€ä¸ªåˆ†åŒºä¸­ï¼Œå°½é‡ä¿è¯æ¯ä¸ªåˆ†åŒºæ•°æ®å‡åŒ€ï¼Œè€Œä¸”åˆ†åŒºé—´æœ‰åº</li></ul> <p><strong>è‡ªå®šä¹‰åˆ†åŒºå™¨</strong>ï¼š</p> <div class="language-scala line-numbers-mode"><pre class="language-scala"><code><span class="token comment">//å‚è€ƒ new HashPartitioner() è¿›è¡Œæ”¹é€ </span>
 <span class="token comment">/**
   * è‡ªå®šä¹‰åˆ†åŒºå™¨
   */</span>
  <span class="token keyword">class</span> MyPartitioner<span class="token punctuation">(</span>partitions<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token keyword">extends</span> Partitioner<span class="token punctuation">{</span>
    <span class="token comment">//åˆ†åŒºæ•°</span>
    <span class="token keyword">override</span> <span class="token keyword">def</span> numPartitions<span class="token operator">:</span> <span class="token builtin">Int</span> <span class="token operator">=</span> partitions
    <span class="token comment">//åˆ†åŒºç´¢å¼• ä»0å¼€å§‹ æ ¹æ®keyå€¼è¿”å›æ•°æ®æ‰€åœ¨çš„ç´¢å¼•</span>
    <span class="token keyword">override</span> <span class="token keyword">def</span> getPartition<span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">Any</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Int</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token comment">//æ¨¡å¼åŒ¹é… æ ¹if else ä¸€æ ·</span>
      key <span class="token keyword">match</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">&quot;nba&quot;</span><span class="token keyword">=&gt;</span><span class="token number">0</span>
        <span class="token keyword">case</span> <span class="token string">&quot;cba&quot;</span><span class="token keyword">=&gt;</span><span class="token number">1</span>
        <span class="token keyword">case</span> _<span class="token keyword">=&gt;</span><span class="token number">2</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//ä½¿ç”¨</span>
    <span class="token keyword">val</span> pardd<span class="token operator">=</span> rdd<span class="token punctuation">.</span>partitionBy<span class="token punctuation">(</span><span class="token keyword">new</span> MyPartitioner<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//ä¼ å…¥ä¸ªæ•°</span>
    pardd<span class="token punctuation">.</span>saveAsTextFile<span class="token punctuation">(</span><span class="token string">&quot;output1&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p><strong>rddæ–‡ä»¶è¯»å–å’Œä¿å­˜</strong></p> <div class="language-scala line-numbers-mode"><pre class="language-scala"><code>#ä¿å­˜
save<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
#è¯»å–
textFile
objectFile
sequenceFile
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="ç´¯åŠ å™¨"><a href="#ç´¯åŠ å™¨" class="header-anchor">#</a> ç´¯åŠ å™¨</h3> <p>å…±äº«åªå†™å˜é‡ã€‚</p> <p>accï¼šè®©sparkçŸ¥é“Dirverçš„æ•°æ®ä¼ ç»™executorè®¡ç®—å®Œçš„ç»“æœè¦<strong>è¿”å›</strong>ç»™Dirver,ç„¶åå°†è¿”å›çš„ç»“æœè¿›è¡Œç´¯åŠ åˆå¹¶</p> <p><strong>é»˜è®¤ç®€å•èšåˆ</strong>ï¼š<code>longaccumulator double....</code>  å¯ä»¥èµ·ä¸ªåå­—  addæ–¹æ³•å°†æ•°å€¼åŠ å…¥ç´¯åŠ å™¨ä¸­ valueè·å–å€¼</p> <blockquote><p>å°‘åŠ ï¼šè½¬æ¢ç®—å­è°ƒç”¨ç´¯åŠ å™¨  æ²¡æœ‰è¡ŒåŠ¨ç®—å­ ä¸ä¼šæ‰§è¡Œ</p> <p>å¤šåŠ ï¼šå‡ºç°å¤šä¸ªè¡ŒåŠ¨ç®—å­ï¼Œæ¯ä¸ªè¡ŒåŠ¨ç®—å­éƒ½ä¼šæ‰§è¡Œåˆ°è¿™ä¸ªè½¬æ¢è½¬æ¢ç®—å­</p> <p>ä¸€èˆ¬æƒ…å†µä¸‹ç´¯åŠ å™¨ä¼šæ”¾åœ¨ä¸€ä¸ªè¡ŒåŠ¨ç®—å­ä¸­ã€‚</p></blockquote> <p><strong>è‡ªå®šä¹‰ç´¯åŠ å™¨</strong>ï¼š</p> <div class="language-scala line-numbers-mode"><pre class="language-scala"><code><span class="token comment">// å‚è€ƒ longAccumulator å®ç°  #å¯ä»¥é¿å…shuffle</span>
<span class="token comment">/** *
   * è‡ªå®šä¹‰æ•°æ®ç´¯åŠ å™¨
   * ç»§æ‰¿AccumulatorV2 æŒ‡å®šæ³›å‹
   * ç´¯åŠ å™¨è¾“å…¥ç±»å‹
   * ç´¯åŠ å™¨è¿”å›ç±»å‹
   */</span>
  <span class="token keyword">class</span> MyAccumulator <span class="token keyword">extends</span> AccumulatorV2<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">,</span> mutable<span class="token punctuation">.</span>Map<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Long</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">var</span> wcMap<span class="token operator">=</span>mutable<span class="token punctuation">.</span>Map<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">,</span><span class="token builtin">Long</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">//åˆ¤æ–­æ˜¯å¦ä¸ºåˆå§‹çŠ¶æ€</span>
    <span class="token keyword">override</span> <span class="token keyword">def</span> isZero<span class="token operator">:</span> <span class="token builtin">Boolean</span> <span class="token operator">=</span>wcMap<span class="token punctuation">.</span>isEmpty

    <span class="token comment">//å¤åˆ¶ä¸€ä¸ªæ–°çš„ç´¯åŠ å™¨</span>
    <span class="token keyword">override</span> <span class="token keyword">def</span> copy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> AccumulatorV2<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">,</span> mutable<span class="token punctuation">.</span>Map<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Long</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> MyAccumulator

    <span class="token comment">//é‡ç½®ç´¯åŠ å™¨</span>
    <span class="token keyword">override</span> <span class="token keyword">def</span> reset<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span> wcMap<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">//è·å–è¾“å…¥</span>
    <span class="token keyword">override</span> <span class="token keyword">def</span> add<span class="token punctuation">(</span>v<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token keyword">val</span> newCut<span class="token operator">=</span>wcMap<span class="token punctuation">.</span>getOrElse<span class="token punctuation">(</span>v<span class="token punctuation">,</span><span class="token number">0l</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span>
      wcMap<span class="token punctuation">.</span>update<span class="token punctuation">(</span>v<span class="token punctuation">,</span>newCut<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//Dirveråˆå¹¶å¤šä¸ªç´¯åŠ å™¨</span>
    <span class="token keyword">override</span> <span class="token keyword">def</span> merge<span class="token punctuation">(</span>other<span class="token operator">:</span> AccumulatorV2<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">,</span> mutable<span class="token punctuation">.</span>Map<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Long</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token keyword">val</span> map1<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>wcMap
      <span class="token keyword">val</span> map2<span class="token operator">=</span>other<span class="token punctuation">.</span>value
      map2<span class="token punctuation">.</span>foreach<span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token punctuation">(</span>work<span class="token punctuation">,</span>count<span class="token punctuation">)</span><span class="token keyword">=&gt;</span><span class="token punctuation">{</span>
       <span class="token keyword">val</span> newCount<span class="token operator">=</span>map1<span class="token punctuation">.</span>getOrElse<span class="token punctuation">(</span>work<span class="token punctuation">,</span><span class="token number">0L</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">+</span>count
          <span class="token comment">//æ›´æ–°</span>
          map1<span class="token punctuation">.</span>update<span class="token punctuation">(</span>work<span class="token punctuation">,</span>newCount<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//è¾“å‡º</span>
    <span class="token keyword">override</span> <span class="token keyword">def</span> value<span class="token operator">:</span> mutable<span class="token punctuation">.</span>Map<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Long</span><span class="token punctuation">]</span> <span class="token operator">=</span>  wcMap
  <span class="token punctuation">}</span>

<span class="token comment">//åˆ›å»ºç´¯åŠ å™¨å¯¹è±¡</span>
    <span class="token keyword">val</span> wcAcc <span class="token operator">=</span> <span class="token keyword">new</span> MyAccumulator
    <span class="token comment">//æ³¨å†Œç´¯åŠ å™¨</span>
    sc<span class="token punctuation">.</span>register<span class="token punctuation">(</span>wcAcc<span class="token punctuation">,</span> <span class="token string">&quot;wordCountAcc&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h3 id="å¹¿æ’­å˜é‡"><a href="#å¹¿æ’­å˜é‡" class="header-anchor">#</a> å¹¿æ’­å˜é‡</h3> <p>é—­åŒ…æ•°æ®æ˜¯ä»¥taskä¸ºå•ä½è¿›è¡Œå‘é€çš„ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½åŒ…å«é—­åŒ…æ•°æ®ï¼Œå¯èƒ½å¯¼è‡´executorä¸­æœ‰å¤§é‡é‡å¤æ•°æ®ã€‚</p> <p>executoræ˜¯ä¸€ä¸ªjvmè¿›ç¨‹ æ‰€ä»¥åœ¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨åˆ†é…åˆ°å†…å­˜ã€‚å¯ä»¥æŠŠæ•°æ®åŠ è½½åˆ°è¿™ä¸ªå†…å­˜ä¸­æä¾›ç»™æ¯ä¸ªtaskä½¿ç”¨</p> <p>è¿™å°±æ˜¯å¹¿æ’­å˜é‡ï¼Œä½†æ˜¯<strong>å¹¿æ’­å˜é‡ä¸èƒ½æ›´æ”¹</strong>ã€‚</p> <p>æ˜¯<strong>åˆ†å¸ƒå¼å…±äº«çš„åªè¯»å˜é‡</strong> <code>broadcast(æ•°æ®)</code></p> <h2 id="å·¥ç¨‹åŒ–æ¶æ„"><a href="#å·¥ç¨‹åŒ–æ¶æ„" class="header-anchor">#</a> å·¥ç¨‹åŒ–æ¶æ„</h2> <p>ä¾‹å¦‚ï¼šMVC : model view Controller</p> <ul><li>ä¸šåŠ¡ï¼šé€»è¾‘</li> <li>æ•°æ®ï¼šå°è£…</li></ul> <p><strong>ä¸‰å±‚æ¶æ„</strong>: Controller(æ§åˆ¶ è°ƒåº¦) server(æœåŠ¡å±‚ é€»è¾‘) dao(æŒä¹…å±‚ æ“ä½œæ–‡ä»¶)</p> <div class="language-scala line-numbers-mode"><pre class="language-scala"><code>ç›®å½•ç»“æ„ï¼š
å…¥å£<span class="token operator">-&gt;</span>conterller<span class="token operator">-&gt;</span>server<span class="token operator">-&gt;</span>dao
#é‡Œé¢å¯ä»¥æ”¾ç½®å¯¹åº”å±æ€§
<span class="token number">1.</span> conterller #æ§åˆ¶å±‚ ä¾‹<span class="token operator">:</span>åˆ›å»ºæ–¹æ³•è°ƒåº¦æœåŠ¡å±‚æ–¹æ³•
<span class="token number">2.</span> server	#æœåŠ¡å±‚   ä¾‹ï¼šåˆ›å»ºæ–¹æ³•æä¾›ç»™æ§åˆ¶å±‚è°ƒç”¨<span class="token punctuation">,</span>å†™é€»è¾‘ä»£ç <span class="token punctuation">,</span>çœŸæ­£è°ƒç”¨æ•°æ®è°ƒç”¨æŒä¹…å±‚æ–¹æ³•	
<span class="token number">3.</span> dao		#æŒä¹…å±‚   ä¾‹ï¼šåˆ›å»ºæ“ä½œæ•°æ®æ–¹æ³•æä¾›ç»™é€»è¾‘<span class="token punctuation">(</span>æœåŠ¡<span class="token punctuation">)</span>å±‚è°ƒç”¨ ä¾‹<span class="token operator">:</span>è¯»å–æ–‡ä»¶ç­‰ç­‰<span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token number">4.</span> application #å…¥å£ç±» ç»§æ‰¿APPå³å¯è¿è¡Œ ä¾‹ï¼šå¯ä»¥è°ƒç”¨commoné‡Œçš„æ–¹æ³•<span class="token punctuation">(</span>ä¼ å…¥å‚æ•°<span class="token punctuation">,</span>é€»è¾‘<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token number">5.</span> common #å…±åŒç±» å…±é€šæ€§ æŠ½å–ç±» 
ä¾‹ï¼šç‰¹è´¨ç±»ï¼Œæ–¹æ³•ï¼šæŠŠç¯å¢ƒæ”¾é‡Œå¤´åˆå§‹åŒ–å…³é—­çš„åˆ›å»ºåŒä¸€å¯¹è±¡çš„ä»£ç ç­‰ç­‰<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> é‚£äº›æ‰§è¡Œçš„æ–¹æ³•éƒ½å¯ä»¥æ”¾è¿›æ¥ï¼Œ
ç„¶åè°ƒç”¨æ—¶ï¼Œç”¨<span class="token keyword">with</span>æ··å…¥å®ç°å³å¯ï¼Œç±»ä¼¼æ¥å£
<span class="token number">6.</span> util #å·¥å…·ç±»
<span class="token number">7.</span> bean #å®ä½“ç±» ä¾‹ï¼šThreadLocalç±»å°è£…æ–¹æ³•ç”¨æ¥å­˜å‚¨çº¿ç¨‹æ•°æ®
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p><strong>ThreadLocal</strong>å¯ä»¥å¯¹<strong>çº¿ç¨‹</strong>çš„å†…å­˜è¿›è¡Œæ§åˆ¶ï¼Œå­˜å‚¨æ•°æ®,</p> <p>set(å­˜å‚¨æ•°æ®ï¼‰</p> <p>getè·å–æ•°æ®</p> <p>removeåˆ é™¤æ•°æ®</p> <p>è§£é‡Šï¼šè·å–å½“å‰çº¿ç¨‹ï¼Œå­˜å‚¨åˆ°mapçš„çº¿ç¨‹å®¹å™¨ä¸­ã€‚</p></blockquote></div></div> <div class="page-slot page-slot-bottom"><!-- æ¨ªå‘è‡ªé€‚åº” -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=spark" title="æ ‡ç­¾">#spark</a></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">2023/03/22, 21:16:55</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/ska2ab24a2n/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">scalaç¬”è®°</div></a> <a href="/pages/s2q3lab24a2n/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">spark-SQLç¬”è®°</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/pages/ska2ab24a2n/" class="prev">scalaç¬”è®°</a></span> <span class="next"><a href="/pages/s2q3lab24a2n/">spark-SQLç¬”è®°</a>â†’
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">æœ€è¿‘æ›´æ–°</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/f53939/"><div>Spring6</div></a> <span>06-18</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/ba69ad/"><div>è‹¥ä¾äºŒå¼€</div></a> <span>06-17</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/998714/"><div>MongoDB</div></a> <span>06-16</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">æ›´å¤šæ–‡ç« &gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="http://wpa.qq.com/msgrd?v=3&amp;uin=2461475139&amp;site=qq&amp;menu=yes" title="å‘é‚®ä»¶" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/axcmsm" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=6757658477" title="å¬éŸ³ä¹" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="æœ¬ç«™ä¸»é¢˜">Vdoing</a> 
    | Copyright Â© 2021-2023
    <span>axcmsm | è½¬è½½æ³¨æ˜å‡ºå¤„ </span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          è·Ÿéšç³»ç»Ÿ
        </li><li class="iconfont icon-rijianmoshi">
          æµ…è‰²æ¨¡å¼
        </li><li class="iconfont icon-yejianmoshi">
          æ·±è‰²æ¨¡å¼
        </li><li class="iconfont icon-yuedu">
          é˜…è¯»æ¨¡å¼
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><i class="close-but">Ã—</i> <div><!-- å›ºå®š160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.e7d9515b.js" defer></script><script src="/assets/js/2.125ae6e8.js" defer></script><script src="/assets/js/41.6647cff7.js" defer></script>
  </body>
</html>