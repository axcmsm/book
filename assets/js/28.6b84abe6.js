(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{458:function(s,a,n){"use strict";n.r(a);var t=n(16),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"flumeæ¦‚è¿°"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#flumeæ¦‚è¿°"}},[s._v("#")]),s._v(" Flumeæ¦‚è¿°")]),s._v(" "),n("p",[s._v("åˆ†å¸ƒå¼æµ·é‡"),n("strong",[s._v("æ—¥å¿—")]),s._v("é‡‡é›†ã€èšåˆå’Œä¼ è¾“ã€åŸºäº"),n("strong",[s._v("æµå¼")]),s._v("æ¶æ„")]),s._v(" "),n("p",[s._v("Flume å®˜ç½‘åœ°å€ "),n("a",{attrs:{href:"http://flume.apache.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://flume.apache.org/"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("æ–‡æ¡£ "),n("a",{attrs:{href:"http://flume.apache.org/FlumeUserGuide.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://flume.apache.org/FlumeUserGuide.html"),n("OutboundLink")],1)]),s._v(" "),n("p",[n("strong",[s._v("æ ¸å¿ƒè§’è‰²agent")]),s._v(":(å…¶æœ¬èº«æ˜¯ä¸€ä¸ªjvmè¿›ç¨‹)")]),s._v(" "),n("p",[n("strong",[s._v("æ ¸å¿ƒç»„ä»¶")]),s._v("ï¼š")]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("source")]),s._v(" ï¼š (é‡‡é›†ç›‘æ§  æ¨é€äº‹åŠ¡ç»™ç®¡é“)")]),s._v(" "),n("li",[n("strong",[s._v("channel")]),s._v("ï¼š(ç®¡é“ç¼“å†² å†…å­˜ç£ç›˜)")]),s._v(" "),n("li",[n("strong",[s._v("sink")]),s._v("ï¼š (æ‹‰å–äº‹åŠ¡ç®¡é“æ•°æ® å°è£…ä¸‹æ²‰)")])]),s._v(" "),n("p",[n("strong",[s._v("è¿è¡Œæœºåˆ¶ï¼š")])]),s._v(" "),n("ul",[n("li",[n("p",[s._v("flumeæœ¬èº«æ˜¯javaç¨‹åº åœ¨éœ€è¦é‡‡é›†æ•°æ®æœºå™¨ä¸Šå¯åŠ¨ -----\x3eagentè¿›ç¨‹")])]),s._v(" "),n("li",[n("p",[s._v("agentè¿›ç¨‹é‡Œé¢åŒ…å«äº†ï¼šsource  sink  channel")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("source æ¥æ”¶æ•°æ®å¤„ç†å„ç§ç±»å‹æ—¥å¿—æ•°æ®")]),s._v(" "),n("blockquote",[n("p",[s._v("ä¾‹ï¼š"),n("code",[s._v("avroã€thriftã€execã€jmsã€spooling directoryã€netcatã€taildirã€sequence generatorã€syslogã€httpã€legacyã€‚")])])])]),s._v(" "),n("li",[n("p",[s._v("Sinkè½®è¯¢ Channel ä¸­çš„äº‹ä»¶ä¸”æ‰¹é‡åœ°ç§»é™¤,å†™å…¥å­˜å‚¨")]),s._v(" "),n("blockquote",[n("p",[s._v("ä¾‹ï¼šç›®çš„åœ°")]),s._v(" "),n("p",[n("code",[s._v("hdfsã€loggerã€avroã€thriftã€ipcã€fileã€HBaseã€solrã€è‡ªå®šä¹‰")])])])]),s._v(" "),n("li",[n("p",[s._v("Channel æ˜¯çº¿ç¨‹å®‰å…¨çš„,å¯åŒæ—¶è¿›è¡Œå¤„ç†è¯»å–æ“ä½œã€‚")]),s._v(" "),n("blockquote",[n("p",[n("code",[s._v("Memory Channel(å†…å­˜) å’Œ File Channel(æ–‡ä»¶)")])])])])])]),s._v(" "),n("li",[n("p",[s._v("åœ¨flumeä¸­ï¼Œæ•°æ®è¢«åŒ…è£…æˆevent çœŸæ˜¯çš„æ•°æ®æ˜¯æ”¾åœ¨event bodyä¸­")]),s._v(" "),n("p",[n("strong",[s._v("event")]),s._v("æ˜¯flumeä¸­æœ€å°çš„æ•°æ®å•å…ƒï¼Œç”±"),n("strong",[s._v("Header")]),s._v(" å’Œ "),n("strong",[s._v("Body")]),s._v(" ä¸¤éƒ¨åˆ†ç»„æˆã€‚")])])]),s._v(" "),n("h2",{attrs:{id:"å®‰è£…éƒ¨ç½²"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å®‰è£…éƒ¨ç½²"}},[s._v("#")]),s._v(" å®‰è£…éƒ¨ç½²")]),s._v(" "),n("p",[s._v("ä¸‹è½½åœ°å€: "),n("a",{attrs:{href:"http://archive.apache.org/dist/flume/",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://archive.apache.org/dist/flume/"),n("OutboundLink")],1)]),s._v(" "),n("p",[n("strong",[s._v("å®‰è£…æ­¥éª¤")]),s._v("ï¼š")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("ä¸Šä¼ æºç åŒ…è§£å‹åˆ°æŒ‡å®šç›®å½•")])]),s._v(" "),n("li",[n("p",[s._v("æ”¹å(å¯é€‰)")])]),s._v(" "),n("li",[n("p",[s._v("å°†"),n("code",[s._v("lib")]),s._v("æ–‡ä»¶å¤¹ä¸‹çš„ "),n("code",[s._v("guava-11.0.2.jar")]),s._v(" åˆ é™¤ä»¥å…¼å®¹ "),n("code",[s._v("Hadoop 3.1.4")])])]),s._v(" "),n("li",[n("p",[s._v("ä¿®æ”¹"),n("code",[s._v("conf")]),s._v("ä¸‹çš„"),n("code",[s._v("flume-env.sh")]),s._v("ï¼Œåœ¨é‡Œé¢é…ç½®JAVA_HOME (å¯é€‰)")]),s._v(" "),n("blockquote",[n("p",[s._v("å¦‚æœé…ç½®äº†ç¯å¢ƒå˜é‡å°±å†é…ç½®javahomeäº†")])])])]),s._v(" "),n("p",[n("strong",[s._v("å¼€å‘æ­¥éª¤")]),s._v("ï¼š")]),s._v(" "),n("p",[n("a",{attrs:{href:"http://flume.apache.org/FlumeUserGuide.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("å®˜æ–¹æ‰‹å†Œ"),n("OutboundLink")],1)]),s._v(" "),n("ul",[n("li",[s._v("åˆ›å»ºä¸€ä¸ªç›®å½•ç¼–å†™"),n("strong",[s._v("é…ç½®æ–‡ä»¶")]),s._v(" "),n("code",[s._v("agent,source,channel,sink,bind")])]),s._v(" "),n("li",[s._v("å¯åŠ¨agentå»é‡‡é›†æ•°æ®")]),s._v(" "),n("li",[s._v("æµ‹è¯•")])]),s._v(" "),n("blockquote",[n("p",[s._v("netcat è½»é‡ç«¯å£é€šä¿¡å·¥å…·")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v(" yum install -y nc #ä¸‹è½½\n netstat -nlp | grep 44444 #æŸ¥çœ‹æ˜¯å¦è¢«å ç”¨\n nc -lk 44444`  å¼€å¯æœåŠ¡ç«¯\n nc localhost 44444 å¼€å¯å®¢æˆ·ç«¯\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])])]),s._v(" "),n("h2",{attrs:{id:"æ¶æ„"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æ¶æ„"}},[s._v("#")]),s._v(" æ¶æ„")]),s._v(" "),n("p",[n("strong",[s._v("åŸºç¡€æ¶æ„")]),s._v("ï¼šå•ä¸ªagenté‡‡é›†æ•°æ®\n"),n("img",{attrs:{src:"https://gitee.com/axcmsm/tmp/raw/master/bigdata/20210913212602.png",alt:""}})]),s._v(" "),n("p",[n("strong",[s._v("ç®€å•ä¸²è”")]),s._v("ï¼š")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://gitee.com/axcmsm/tmp/raw/master/bigdata/20210913225302.png",alt:""}})]),s._v(" "),n("p",[n("strong",[s._v("å¤åˆ¶å’Œå¤šè·¯å¤ç”¨")]),n("img",{attrs:{src:"https://gitee.com/axcmsm/tmp/raw/master/bigdata/20210913225528.png",alt:""}})]),s._v(" "),n("p",[n("strong",[s._v("è´Ÿè½½å‡è¡¡å’Œæ•…éšœè½¬ç§»")]),s._v("ï¼š")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://gitee.com/axcmsm/tmp/raw/master/bigdata/20210913225738.png",alt:""}})]),s._v(" "),n("p",[n("strong",[s._v("èšåˆ")]),s._v("ï¼šå®ç”¨")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://gitee.com/axcmsm/tmp/raw/master/bigdata/20210913225812.png",alt:""}})]),s._v(" "),n("ul",[n("li",[n("p",[s._v("flumeçš„è´Ÿè½½å‡è¡¡")]),s._v(" "),n("ul",[n("li",[s._v("æ‰€è°“çš„è´Ÿè½½å‡è¡¡ ç”¨äºè§£å†³ä¸€ä¸ªè¿›ç¨‹æˆ–è€…ç¨‹åºå¤„ç†ä¸äº†æ‰€æœ‰è¯·æ±‚ å¤šä¸ªè¿›ç¨‹ä¸€èµ·å¤„ç†çš„åœºæ™¯")]),s._v(" "),n("li",[s._v("åŒä¸€ä¸ªè¯·æ±‚åªèƒ½äº¤ç»™ä¸€ä¸ªè¿›è¡Œå¤„ç† é¿å…æ•°æ®é‡å¤")]),s._v(" "),n("li",[s._v("å¦‚ä½•åˆ†é…è¯·æ±‚å°±æ¶‰åŠåˆ°äº†è´Ÿè½½å‡è¡¡çš„ç®—æ³•ï¼šè½®è¯¢ï¼ˆround_robinï¼‰  éšæœºï¼ˆrandomï¼‰  æƒé‡")])])]),s._v(" "),n("li",[n("p",[s._v("flumeä¸²è”è·¨ç½‘ç»œä¼ è¾“æ•°æ®")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("avro sink")])]),s._v(" "),n("li",[n("p",[s._v("avro source")]),s._v(" "),n("p",[s._v("ä½¿ç”¨ä¸Šè¿°ä¸¤ä¸ªç»„ä»¶æŒ‡å®šç»‘å®šçš„ç«¯å£ip å°±å¯ä»¥æ»¡è¶³æ•°æ®è·¨ç½‘ç»œçš„ä¼ é€’ é€šå¸¸ç”¨äºflumeä¸²è”æ¶æ„ä¸­")])])])]),s._v(" "),n("li",[n("p",[s._v("flumeä¸²è”å¯åŠ¨")]),s._v(" "),n("p",[s._v("é€šå¸¸ä»è¿œç¦»æ•°æ®æºçš„é‚£ä¸€çº§å¼€å§‹å¯åŠ¨")])])]),s._v(" "),n("hr"),s._v(" "),n("ul",[n("li",[n("p",[s._v("flume failover")]),s._v(" "),n("ul",[n("li",[s._v("å®¹é”™åˆç§°ä¹‹ä¸ºæ•…éšœè½¬ç§»  å®¹å¿é”™è¯¯çš„å‘ç”Ÿã€‚")]),s._v(" "),n("li",[s._v("é€šå¸¸ç”¨äºè§£å†³å•ç‚¹æ•…éšœ ç»™å®¹æ˜“å‡ºæ•…éšœçš„åœ°æ–¹è®¾ç½®å¤‡ä»½")]),s._v(" "),n("li",[s._v("å¤‡ä»½è¶Šå¤š å®¹é”™èƒ½åŠ›è¶Šå¼º  ä½†æ˜¯èµ„æºçš„æµªè´¹è¶Šä¸¥é‡")])])]),s._v(" "),n("li",[n("p",[s._v("é™æ€æ‹¦æˆªå™¨")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("å¦‚æœæ²¡æœ‰ä½¿ç”¨é™æ€æ‹¦æˆªå™¨\nEvent: { headers:{} body:  36 Sun Jun  2 18:26 }\n\nä½¿ç”¨é™æ€æ‹¦æˆªå™¨ä¹‹å è‡ªå·±æ·»åŠ kvæ ‡è¯†å¯¹\nEvent: { headers:{type=access} body:  36 Sun Jun  2 18:26 }\nEvent: { headers:{type=nginx} body:  36 Sun Jun  2 18:26 }\nEvent: { headers:{type=web} body:  36 Sun Jun  2 18:26 }\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("åç»­åœ¨å­˜æ”¾æ•°æ®çš„æ—¶å€™å¯ä»¥ä½¿ç”¨flumeçš„è§„åˆ™è¯­æ³•è·å–åˆ°æ‹¦æˆªå™¨æ·»åŠ çš„kvå†…å®¹")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("%{type}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("æ¨¡æ‹Ÿæ•°æ®å®æ—¶äº§ç”Ÿ")])])]),s._v(" "),n("h2",{attrs:{id:"å…¥é—¨æ¡ˆä¾‹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å…¥é—¨æ¡ˆä¾‹"}},[s._v("#")]),s._v(" å…¥é—¨æ¡ˆä¾‹")]),s._v(" "),n("p",[n("code",[s._v("Exec source")]),s._v(" ç›‘å¬è¿½åŠ æ–‡ä»¶")]),s._v(" "),n("p",[n("code",[s._v("Spooldir Source")]),s._v(" é€‚åˆç”¨äºåŒæ­¥æ–°æ–‡ä»¶")]),s._v(" "),n("p",[n("code",[s._v("Taildir Source")]),s._v(" é€‚åˆç”¨äºç›‘å¬å¤šä¸ªå®æ—¶è¿½åŠ çš„æ–‡ä»¶")]),s._v(" "),n("p",[n("strong",[s._v("å•ä¸ªè¿½åŠ æ–‡ä»¶")]),s._v("ï¼š")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("source:  exec  â€˜tail -F fileâ€™ \nsink:  hdfs sink\nchannel:å¯ç”¨filechannel ä¹Ÿå¯ä»¥ç”¨å†…å­˜channel\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("div",{staticClass:"language-conf line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("#å…·ä½“é…ç½®æ–‡ä»¶çš„ç¼–å†™\n# xxx_xxx_.conf\n# agent \na1.sources = r1\na1.sinks = k1\na1.channels = c1\n\n#source\na1.sources.r1.type = exec\na1.sources.r1.command = tail -F /root/logs/test.log a1.sources.r1.channels = c1\n\n# sink\na1.sinks.k1.type = hdfs\na1.sinks.k1.hdfs.path = /flume/tailout/%y-%m-%d/%H%M/\n#ä¸Šä¼ æ–‡ä»¶çš„å‰ç¼€\na1.sinks.k1.hdfs.filePrefix = events-\n#æ˜¯å¦æŒ‰ç…§æ—¶é—´æ»šåŠ¨æ–‡ä»¶å¤¹\na1.sinks.k1.hdfs.round = true\n#å¤šå°‘æ—¶é—´å•ä½åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹\na1.sinks.k1.hdfs.roundValue = 10\n#é‡æ–°å®šä¹‰æ—¶é—´å•ä½\na1.sinks.k1.hdfs.roundUnit = minute\n#å¤šä¹…ç”Ÿæˆä¸€ä¸ªæ–°çš„æ–‡ä»¶\na1.sinks.k1.hdfs.rollInterval = 3\n#è®¾ç½®æ¯ä¸ªæ–‡ä»¶çš„æ»šåŠ¨å¤§å°\na1.sinks.k1.hdfs.rollSize = 20\n#å¦‚æœä¸º0æ–‡ä»¶çš„æ»šåŠ¨ä¸ Event æ•°é‡æ— å…³\na1.sinks.k1.hdfs.rollCount = 5\n#ç§¯æ”’å¤šå°‘ä¸ª Event æ‰ flush åˆ° HDFS ä¸€æ¬¡\na1.sinks.k1.hdfs.batchSize = 1\n#æ˜¯å¦ä½¿ç”¨æœ¬åœ°æ—¶é—´æˆ³\na1.sinks.k1.hdfs.useLocalTimeStamp = true\n#ç”Ÿæˆçš„æ–‡ä»¶ç±»å‹ï¼Œé»˜è®¤æ˜¯Sequencefileï¼Œå¯ç”¨DataStreamï¼Œä¸ºæ™®é€šæ–‡æœ¬\n#è®¾ç½®æ–‡ä»¶ç±»å‹ï¼Œå¯æ”¯æŒå‹ç¼©\na1.sinks.k1.hdfs.fileType = DataStream\n\n# channel \na1.channels.c1.type = memory\na1.channels.c1.capacity = 1000\na1.channels.c1.transactionCapacity = 100\n\n# ç»‘å®šbind sources+sinksåˆ°channels\na1.sources.r1.channels = c1\na1.sinks.k1.channel = c1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br")])]),n("p",[n("strong",[s._v("ç›‘æ§ç›®å½•")]),s._v("ï¼šä¿®æ”¹æ–‡ä»¶åä¹Ÿä¼šä¿ƒå‘,å†…å®¹ç´¯åŠ æ›´æ–°")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("sourceï¼šspooldir\nsink: hdfs sink\nchannel:å¯ç”¨filechannel ä¹Ÿå¯ä»¥ç”¨å†…å­˜channel\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("div",{staticClass:"language-conf line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("#å…·ä½“é…ç½®æ–‡ä»¶çš„ç¼–å†™\n# agent\na1.sources = r1\na1.sinks = k1\na1.channels = c1\n\n# Describe/configure the source\n##æ³¨æ„ï¼šä¸èƒ½å¾€ç›‘æ§ç›®ä¸­é‡å¤ä¸¢åŒåæ–‡ä»¶\na1.sources.r1.type = spooldir\na1.sources.r1.spoolDir = /root/logs\na1.sources.r1.fileHeader = true\n\n# Describe the sink\na1.sinks.k1.type = hdfs\na1.sinks.k1.hdfs.path = /flume/events/%y-%m-%d/%H%M/a1.sinks.k1.hdfs.filePrefix = events-\na1.sinks.k1.hdfs.round = true\na1.sinks.k1.hdfs.roundValue = 10\na1.sinks.k1.hdfs.roundUnit = minute\na1.sinks.k1.hdfs.rollInterval = 3\na1.sinks.k1.hdfs.rollSize = 20\na1.sinks.k1.hdfs.rollCount = 5\na1.sinks.k1.hdfs.batchSize = 1\na1.sinks.k1.hdfs.useLocalTimeStamp = true\n#ç”Ÿæˆçš„æ–‡ä»¶ç±»å‹ï¼Œé»˜è®¤æ˜¯Sequencefileï¼Œå¯ç”¨DataStreamï¼Œä¸ºæ™®é€šæ–‡æœ¬\na1.sinks.k1.hdfs.fileType = DataStream\n\n# Use a channel which buffers events in memory\na1.channels.c1.type = memory\na1.channels.c1.capacity = 1000\na1.channels.c1.transactionCapacity = 100\n\n# Bind the source and sink to the channel\na1.sources.r1.channels = c1\na1.sinks.k1.channel = c1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br")])]),n("div",{staticClass:"custom-block warning"},[n("p",{staticClass:"custom-block-title"},[s._v("æ³¨æ„")]),s._v(" "),n("p",[s._v("å¯¹äºæ‰€æœ‰ä¸æ—¶é—´ç›¸å…³çš„è½¬ä¹‰åºåˆ—,éœ€è¦"),n("code",[s._v("hdfs.useLocalTimeStamp")]),s._v(" è®¾ç½®ä¸º trueï¼Œå¦åˆ™Event Headerä¸­ä¸å­˜åœ¨ä»¥ "),n("code",[s._v("timestamp")]),s._v("çš„key,ä¼šè‡ªåŠ¨æ·»åŠ "),n("code",[s._v("timestamp")])])]),s._v(" "),n("p",[n("strong",[s._v("ç›®å½•å®æ—¶è¿½åŠ æ–‡ä»¶")]),s._v("ï¼šåªæ›´æ–°æœ€æ–°çš„ï¼Œæ”¹åä¸ä¼šä¿ƒå‘")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("source:Taildir Source\nsink: hdfs sink\nchannel:å¯ç”¨filechannel ä¹Ÿå¯ä»¥ç”¨å†…å­˜channel\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# agent\na3.sources = r3\na3.sinks = k3\na3.channels = c3\n# Describe/configure the source\na3.sources.r3.type = TAILDIR\na3.sources.r3.positionFile = /opt/module/flume/tail_dir.json\na3.sources.r3.filegroups = f1 f2\na3.sources.r3.filegroups.f1 = /opt/module/flume/files/.*file.*\na3.sources.r3.filegroups.f2 = /opt/module/flume/files2/.*log.*\n\n# Describe the sink\na3.sinks.k3.type = hdfs\na3.sinks.k3.hdfs.path = \nhdfs://hadoop102:9820/flume/upload2/%Y%m%d/%H\n#ä¸Šä¼ æ–‡ä»¶çš„å‰ç¼€\na3.sinks.k3.hdfs.filePrefix = upload-\n#æ˜¯å¦æŒ‰ç…§æ—¶é—´æ»šåŠ¨æ–‡ä»¶å¤¹\na3.sinks.k3.hdfs.round = true\n#å¤šå°‘æ—¶é—´å•ä½åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹\na3.sinks.k3.hdfs.roundValue = 1\n#é‡æ–°å®šä¹‰æ—¶é—´å•ä½\na3.sinks.k3.hdfs.roundUnit = hour\n#æ˜¯å¦ä½¿ç”¨æœ¬åœ°æ—¶é—´æˆ³\na3.sinks.k3.hdfs.useLocalTimeStamp = true\n#ç§¯æ”’å¤šå°‘ä¸ª Event æ‰ flush åˆ° HDFS ä¸€æ¬¡\na3.sinks.k3.hdfs.batchSize = 100\n#è®¾ç½®æ–‡ä»¶ç±»å‹ï¼Œå¯æ”¯æŒå‹ç¼©\na3.sinks.k3.hdfs.fileType = DataStream\n#å¤šä¹…ç”Ÿæˆä¸€ä¸ªæ–°çš„æ–‡ä»¶\na3.sinks.k3.hdfs.rollInterval = 60\n#è®¾ç½®æ¯ä¸ªæ–‡ä»¶çš„æ»šåŠ¨å¤§å°å¤§æ¦‚æ˜¯ 128M\na3.sinks.k3.hdfs.rollSize = 134217700\n#æ–‡ä»¶çš„æ»šåŠ¨ä¸ Event æ•°é‡æ— å…³\na3.sinks.k3.hdfs.rollCount = 0\n# Use a channel which buffers events in memory\na3.channels.c3.type = memory\na3.channels.c3.capacity = 1000\na3.channels.c3.transactionCapacity = 100\n\n# Bind the source and sink to the channel\na3.sources.r3.channels = c3\na3.sinks.k3.channel = c3\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br")])]),n("blockquote",[n("p",[s._v("Taildir Source ç»´æŠ¤äº†json æ ¼å¼çš„ position Fileï¼Œå…¶ä¼šå®šæœŸçš„å¾€ position Fileä¸­æ›´æ–°æ¯ä¸ªæ–‡ä»¶è¯»å–åˆ°çš„æœ€æ–°çš„ä½ç½®ï¼Œå› æ­¤èƒ½å¤Ÿå®ç°æ–­ç‚¹ç»­ä¼ ")])]),s._v(" "),n("p",[n("strong",[s._v("å¯åŠ¨å‘½ä»¤")]),s._v(":")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("å‘½ä»¤å®Œæ•´ç‰ˆ   è¡¨ç¤ºloggeræ—¥å¿—è¾“å‡ºåˆ°consoleæ§åˆ¶å°\nbin/flume-ng agent --conf conf --conf-file conf/netcat-logger.conf --name a1 -Dflume.root.logger=INFO,console  \n\nç®€å†™\nbin/flume-ng agent -c ï¼ˆç›‘æ§ç›®å½•/æ–‡ä»¶) -f (é…ç½®æ–‡ä»¶è·¯å¾„) -n (agentå)  å‘½ä»¤ç²¾ç®€ç‰ˆ\n\n--confæŒ‡å®šé…ç½®æ–‡ä»¶çš„ç›®å½•\n--conf-fileæŒ‡å®šé‡‡é›†æ–¹æ¡ˆè·¯å¾„\n--name  agentè¿›ç¨‹åå­— è¦è·Ÿé‡‡é›†æ–¹æ¡ˆä¸­ä¿æŒä¸€è‡´\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h2",{attrs:{id:"äº‹åŠ¡"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#äº‹åŠ¡"}},[s._v("#")]),s._v(" äº‹åŠ¡")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://gitee.com/axcmsm/tmp/raw/master/bigdata/20210913224143.png",alt:""}})]),s._v(" "),n("p",[n("strong",[s._v("Agentå†…éƒ¨åŸç†")]),s._v(":")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://gitee.com/axcmsm/tmp/raw/master/bigdata/20210913224255.png",alt:""}})]),s._v(" "),n("p",[n("strong",[s._v("é‡è¦ç»„ä»¶")]),s._v(":")]),s._v(" "),n("ul",[n("li",[n("p",[n("strong",[s._v("ChannelSelector")]),s._v(":  æ˜¯é€‰å‡º Event å°†è¦è¢«å‘å¾€å“ªä¸ª Channel")]),s._v(" "),n("ul",[n("li",[s._v("ReplicatingSelector ä¼šå°†åŒä¸€ä¸ª Event å‘å¾€æ‰€æœ‰çš„ Channel")]),s._v(" "),n("li",[s._v("Multiplexing æ ¹æ®ç›¸åº”çš„åŸåˆ™ï¼Œå°†ä¸åŒçš„ Event å‘å¾€ä¸åŒçš„ Channel")])])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("SinkProcessor")]),s._v("ï¼š")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("DefaultSinkProcessor ï¼šå• ä¸ª çš„ Sink")])]),s._v(" "),n("li",[n("p",[s._v("sinkç»„(Sink Group)")]),s._v(" "),n("ul",[n("li",[s._v("LoadBalancingSinkProcessorï¼šè´Ÿè½½å‡è¡¡")])]),s._v(" "),n("blockquote",[n("p",[s._v("è½®è¯¢ï¼ˆround_robinï¼‰  éšæœºï¼ˆrandomï¼‰  æƒé‡")])]),s._v(" "),n("ul",[n("li",[s._v("FailoverSinkProcessor: æ•…éšœè½¬ç§»")])])])])]),s._v(" "),n("li",[n("p",[s._v("flumeä¸²è”è·¨ç½‘ç»œä¼ è¾“æ•°æ®")])])]),s._v(" "),n("h2",{attrs:{id:"å¼€å‘æ¡ˆä¾‹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å¼€å‘æ¡ˆä¾‹"}},[s._v("#")]),s._v(" å¼€å‘æ¡ˆä¾‹")]),s._v(" "),n("p",[n("strong",[s._v("å¤åˆ¶å’Œå¤šè·¯å¤ç”¨")]),s._v("ï¼š")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("#éœ€æ±‚\nä½¿ç”¨ Flume-1 ç›‘æ§æ–‡ä»¶å˜åŠ¨ï¼ŒFlume-1 å°†å˜åŠ¨å†…å®¹\nä¼ é€’ç»™ Flume-2ï¼ŒFlume-2 è´Ÿè´£å­˜å‚¨åˆ° HDFSã€‚\nåŒæ—¶ Flume-1 å°†å˜åŠ¨å†…å®¹ä¼ é€’ç»™ Flume-3ï¼Œ\nFlume-3 è´Ÿè´£è¾“å‡ºåˆ° Local FileSystemã€‚\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("details",{staticClass:"custom-block details"},[n("summary",[s._v("å®ç°ï¼šğŸ’¦ğŸ’¦")]),s._v(" "),n("p",[s._v("åˆ›å»º group1 é…ç½®æ–‡ä»¶å¤¹")]),s._v(" "),n("p",[s._v("åˆ›å»º  flume3 æœ¬åœ°è¾“å‡ºæ–‡ä»¶å¤¹")]),s._v(" "),n("p",[s._v("é…ç½® "),n("code",[s._v("flume-file-flume.conf æ–‡ä»¶")])]),s._v(" "),n("p",[s._v("é…ç½® 1 ä¸ªæ¥æ”¶æ—¥å¿—æ–‡ä»¶çš„"),n("code",[s._v("source")]),s._v(" å’Œä¸¤ä¸ª "),n("code",[s._v("channel")]),s._v("ã€ä¸¤ä¸ª "),n("code",[s._v("sink")]),s._v("ï¼Œåˆ†åˆ«è¾“é€ç»™ "),n("code",[s._v("flume-flume hdfs å’Œ flume-flume-dir")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# flume-file-flume.conf")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na1.sources "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na1.sinks "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1 k2\na1.channels "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1 c2\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å°†æ•°æ®æµå¤åˆ¶ç»™æ‰€æœ‰ channel")]),s._v("\na1.sources.r1.selector.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" replicating\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na1.sources.r1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v("\na1.sources.r1.command "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" -F /opt/module/hive/logs/hive.log\na1.sources.r1.shell "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /bin/bash -c\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sink ç«¯çš„ avro æ˜¯ä¸€ä¸ªæ•°æ®å‘é€è€…")]),s._v("\na1.sinks.k1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na1.sinks.k1.hostname "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop102\na1.sinks.k1.port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4141")]),s._v("\na1.sinks.k2.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na1.sinks.k2.hostname "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop102\na1.sinks.k2.port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4142")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the channel")]),s._v("\na1.channels.c1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na1.channels.c1.capacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na1.channels.c1.transactionCapacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\na1.channels.c2.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na1.channels.c2.capacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na1.channels.c2.transactionCapacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na1.sources.r1.channels "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1 c2\na1.sinks.k1.channel "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinks.k2.channel "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c2\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# flume-flume-hdfs.conf")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# é…ç½®ä¸Šçº§ Flume è¾“å‡ºçš„ Sourceï¼Œè¾“å‡ºæ˜¯åˆ° HDFS çš„ Sinkã€‚")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na2.sources "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na2.sinks "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\na2.channels "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# source ç«¯çš„ avro æ˜¯ä¸€ä¸ªæ•°æ®æ¥æ”¶æœåŠ¡")]),s._v("\na2.sources.r1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na2.sources.r1.bind "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop102\na2.sources.r1.port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4141")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na2.sinks.k1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hdfs\na2.sinks.k1.hdfs.path "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hdfs://hadoop102:9820/flume2/%Y%m%d/%H\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ä¸Šä¼ æ–‡ä»¶çš„å‰ç¼€")]),s._v("\na2.sinks.k1.hdfs.filePrefix "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" flume2- "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#æ˜¯å¦æŒ‰ç…§æ—¶é—´æ»šåŠ¨æ–‡ä»¶å¤¹")]),s._v("\na2.sinks.k1.hdfs.round "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#å¤šå°‘æ—¶é—´å•ä½åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹")]),s._v("\na2.sinks.k1.hdfs.roundValue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#é‡æ–°å®šä¹‰æ—¶é—´å•ä½")]),s._v("\na2.sinks.k1.hdfs.roundUnit "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hour\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#æ˜¯å¦ä½¿ç”¨æœ¬åœ°æ—¶é—´æˆ³")]),s._v("\na2.sinks.k1.hdfs.useLocalTimeStamp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ç§¯æ”’å¤šå°‘ä¸ª Event æ‰ flush åˆ° HDFS ä¸€æ¬¡")]),s._v("\na2.sinks.k1.hdfs.batchSize "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#è®¾ç½®æ–‡ä»¶ç±»å‹ï¼Œå¯æ”¯æŒå‹ç¼©")]),s._v("\na2.sinks.k1.hdfs.fileType "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" DataStream\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#å¤šä¹…ç”Ÿæˆä¸€ä¸ªæ–°çš„æ–‡ä»¶")]),s._v("\na2.sinks.k1.hdfs.rollInterval "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#è®¾ç½®æ¯ä¸ªæ–‡ä»¶çš„æ»šåŠ¨å¤§å°å¤§æ¦‚æ˜¯ 128M")]),s._v("\na2.sinks.k1.hdfs.rollSize "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("134217700")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#æ–‡ä»¶çš„æ»šåŠ¨ä¸ Event æ•°é‡æ— å…³")]),s._v("\na2.sinks.k1.hdfs.rollCount "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the channel")]),s._v("\na2.channels.c1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na2.channels.c1.capacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na2.channels.c1.transactionCapacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na2.sources.r1.channels "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na2.sinks.k1.channel "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# flume-flume-dir.conf\n# é…ç½®ä¸Šçº§ Flume è¾“å‡ºçš„ Sourceï¼Œè¾“å‡ºæ˜¯åˆ°æœ¬åœ°ç›®å½•çš„ Sinkã€‚\n# Name the components on this agent\na3.sources = r1\na3.sinks = k1\na3.channels = c2\n# Describe/configure the source\na3.sources.r1.type = avro\na3.sources.r1.bind = hadoop102\na3.sources.r1.port = 4142\n# Describe the sink\na3.sinks.k1.type = file_roll\na3.sinks.k1.sink.directory = /opt/module/data/flume3\n# Describe the channel\na3.channels.c2.type = memory\na3.channels.c2.capacity = 1000\na3.channels.c2.transactionCapacity = 100\n# Bind the source and sink to the channel\na3.sources.r1.channels = c2\na3.sinks.k1.channel = c2\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("blockquote",[n("p",[n("strong",[s._v("æç¤º")]),s._v("ï¼šè¾“å‡ºçš„æœ¬åœ°ç›®å½•å¿…é¡»æ˜¯å·²ç»å­˜åœ¨çš„ç›®å½•ï¼Œå¦‚æœè¯¥ç›®å½•ä¸å­˜åœ¨ï¼Œå¹¶ä¸ä¼šåˆ›å»ºæ–°çš„ç›®å½•ã€‚")])]),s._v(" "),n("p",[n("strong",[s._v("å¯åŠ¨")]),s._v("ï¼š")]),s._v(" "),n("p",[s._v("åˆ†åˆ«å¯åŠ¨å¯¹åº”çš„ flume è¿›ç¨‹ï¼š"),n("code",[s._v("flume-flume-dirï¼Œflume-flume-hdfsï¼Œflume-file-flume")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v(" bin/flume-ng agent --conf conf/ --name \na3 --conf-file job/group1/flume-flume-dir.conf\nbin/flume-ng agent --conf conf/ --name \na2 --conf-file job/group1/flume-flume-hdfs.conf\n bin/flume-ng agent --conf conf/ --name \na1 --conf-file job/group1/flume-file-flume.conf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("å¯åŠ¨hive æŸ¥çœ‹æ—¥å¿—è¾“å‡º")])]),s._v(" "),n("p",[n("strong",[s._v("è´Ÿè½½å‡è¡¡å’Œæ•…éšœè½¬ç§»")]),s._v("ï¼š")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# éœ€æ±‚\nä½¿ç”¨ Flume1 ç›‘æ§ä¸€ä¸ªç«¯å£ï¼Œå…¶ sink ç»„ä¸­çš„ sink åˆ†åˆ«å¯¹æ¥ Flume2 å’Œ Flume3ï¼Œé‡‡ç”¨FailoverSinkProcessorï¼Œå®ç°æ•…éšœè½¬ç§»çš„åŠŸèƒ½ã€‚\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("details",{staticClass:"custom-block details"},[n("summary",[s._v("å®ç°ï¼š ğŸª")]),s._v(" "),n("p",[s._v("åˆ›å»º group2 æ–‡ä»¶å¤¹")]),s._v(" "),n("p",[n("code",[s._v("åˆ›å»º flume-netcat-flume.conf")])]),s._v(" "),n("p",[s._v("é…ç½® 1 ä¸ª netcat source å’Œ 1 ä¸ª channelã€1 ä¸ª sink groupï¼ˆ2 ä¸ª sinkï¼‰ï¼Œåˆ†åˆ«è¾“é€ç»™"),n("code",[s._v("flume-flume-console1")]),s._v(" "),n("code",[s._v("flume-flume-console2")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim flume-netcat-flume.conf")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na1.sources "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na1.channels "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinkgroups "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" g1\na1.sinks "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1 k2\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na1.sources.r1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" netcat\na1.sources.r1.bind "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" localhost\na1.sources.r1.port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("44444")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è®¾ç½®å¤åˆ¶å‡è¡¡")]),s._v("\na1.sinkgroups.g1.processor.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" failover\na1.sinkgroups.g1.processor.priority.k1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\na1.sinkgroups.g1.processor.priority.k2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\na1.sinkgroups.g1.processor.maxpenalty "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na1.sinks.k1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na1.sinks.k1.hostname "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop102\na1.sinks.k1.port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4141")]),s._v("\na1.sinks.k2.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na1.sinks.k2.hostname "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop102\na1.sinks.k2.port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4142")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the channel")]),s._v("\na1.channels.c1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na1.channels.c1.capacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na1.channels.c1.transactionCapacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ç»‘å®šç»™ ä¿©ä¸ªsinks")]),s._v("\na1.sources.r1.channels "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinkgroups.g1.sinks "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1 k2\na1.sinks.k1.channel "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinks.k2.channel "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br")])]),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[s._v("å»º flume"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("flume"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("console1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf è¾“å‡ºæ˜¯åˆ°æœ¬åœ°æ§åˆ¶å°\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sources "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sinks "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\na2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("channels "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sources"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("r1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sources"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("r1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("bind "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop102\na2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sources"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("r1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4141")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sinks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" logger\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the channel")]),s._v("\na2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("channels"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("c1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("channels"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("c1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("capacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("channels"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("c1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("transactionCapacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sources"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("r1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("channels "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sinks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("channel "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[s._v("å»º flume"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("flume"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("console2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf æœ¬åœ°æ§åˆ¶å°\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sources "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sinks "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\na3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("channels "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c2\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sources"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("r1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sources"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("r1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("bind "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop102\na3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sources"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("r1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4142")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sinks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" logger\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the channel")]),s._v("\na3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("channels"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("c2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("channels"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("c2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("capacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("channels"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("c2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("transactionCapacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sources"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("r1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("channels "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c2\na3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sinks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("channel "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c2\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("p",[n("strong",[s._v("å¯åŠ¨")]),s._v("ï¼š")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v(" bin/flume-ng agent --conf conf/ --name \na3 --conf-file job/group2/flume-flume-console2.conf -\nDflume.root.logger=INFO,console\n\n bin/flume-ng agent --conf conf/ --name \na2 --conf-file job/group2/flume-flume-console1.conf -\nDflume.root.logger=INFO,console\n\nbin/flume-ng agent --conf conf/ --name \na1 --conf-file job/group2/flume-netcat-flume.conf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("ä½¿ç”¨ netcat å·¥å…·å‘æœ¬æœºçš„ 44444 ç«¯å£å‘é€å†…å®¹")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("nc localhost 44444\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("æŸ¥çœ‹")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("jps -ml æŸ¥çœ‹ Flume è¿›ç¨‹\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" -9 flume2 \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("æŸ¥çœ‹3")])]),s._v(" "),n("p",[n("strong",[s._v("èšåˆ")]),s._v("ï¼š")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("éœ€æ±‚ï¼š\nhadoop102 ä¸Šçš„ Flume-1 ç›‘æ§æ–‡ä»¶/opt/module/group.logï¼Œ\nhadoop103 ä¸Šçš„ Flume-2 ç›‘æ§æŸä¸€ä¸ªç«¯å£çš„æ•°æ®æµï¼Œ\nFlume-1 ä¸ Flume-2 å°†æ•°æ®å‘é€ç»™ hadoop104ä¸Šçš„ Flume-3ï¼Œ\nFlume-3 å°†æœ€ç»ˆæ•°æ®æ‰“å°åˆ°æ§åˆ¶å°\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://gitee.com/axcmsm/tmp/raw/master/bigdata/20210913231814.png",alt:""}})]),s._v(" "),n("p",[s._v("æ­¥éª¤ï¼š")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("åˆ†å‘Flume "),n("code",[s._v("xsync flume")])])]),s._v(" "),n("li",[n("p",[s._v("åŒæ—¶åˆ›å»ºä¸€ä¸ªgroup3 æ–‡ä»¶å¤¹ å­˜æ”¾æœ¬æ¬¡ä»»åŠ¡é…ç½®æ–‡ä»¶")])]),s._v(" "),n("li",[n("p",[s._v("åˆ›å»º"),n("code",[s._v("flume1-logger-flume.conf")])]),s._v(" "),n("blockquote",[n("p",[s._v("é…ç½® Source ç”¨äºç›‘æ§ hive.log æ–‡ä»¶ï¼Œé…ç½® Sink è¾“å‡ºæ•°æ®åˆ°ä¸‹ä¸€çº§ Flume,åœ¨ hadoop102 ä¸Šç¼–è¾‘é…ç½®æ–‡ä»¶")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na1.sources "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na1.sinks "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\na1.channels "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na1.sources.r1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v("\na1.sources.r1.command "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" -F /opt/module/group.log\na1.sources.r1.shell "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /bin/bash -c\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na1.sinks.k1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na1.sinks.k1.hostname "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop104\na1.sinks.k1.port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4141")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the channel")]),s._v("\na1.channels.c1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na1.channels.c1.capacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na1.channels.c1.transactionCapacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na1.sources.r1.channels "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinks.k1.channel "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("åˆ›å»º "),n("code",[s._v("flume2-netcat-flume.conf")])]),s._v(" "),n("blockquote",[n("p",[s._v("é…ç½® Source ç›‘æ§ç«¯å£ 44444 æ•°æ®æµï¼Œé…ç½® Sink æ•°æ®åˆ°ä¸‹ä¸€çº§ Flume,åœ¨ hadoop103 ä¸Šç¼–è¾‘é…ç½®æ–‡ä»¶")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na2.sources "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na2.sinks "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\na2.channels "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na2.sources.r1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" netcat\na2.sources.r1.bind "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop103\na2.sources.r1.port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("44444")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na2.sinks.k1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na2.sinks.k1.hostname "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop104\na2.sinks.k1.port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4141")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Use a channel which buffers events in memory")]),s._v("\na2.channels.c1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na2.channels.c1.capacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na2.channels.c1.transactionCapacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na2.sources.r1.channels "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na2.sinks.k1.channel "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("åˆ›å»º "),n("code",[s._v("flume3-flume-logger.conf")])]),s._v(" "),n("blockquote",[n("p",[s._v("é…ç½® source ç”¨äºæ¥æ”¶ flume1 ä¸ flume2 å‘é€è¿‡æ¥çš„æ•°æ®æµï¼Œæœ€ç»ˆåˆå¹¶å sink åˆ°æ§åˆ¶å°")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na3.sources "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na3.sinks "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\na3.channels "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na3.sources.r1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na3.sources.r1.bind "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop104\na3.sources.r1.port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4141")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na3.sinks.k1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" logger\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the channel")]),s._v("\na3.channels.c1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na3.channels.c1.capacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na3.channels.c1.transactionCapacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na3.sources.r1.channels "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na3.sinks.k1.channel "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("æ‰§è¡Œé…ç½®æ–‡ä»¶")])])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("bin/flume-ng agent --conf conf/ --name \na3 --conf-file job/group3/flume3-flume-logger.conf -\nDflume.root.logger"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("INFO,console\n\n bin/flume-ng agent --conf conf/ --name \na2 --conf-file job/group3/flume1-logger-flume.conf\n\nbin/flume-ng agent --conf conf/ --name \na1 --conf-file job/group3/flume2-netcat-flume.conf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("ul",[n("li",[n("p",[s._v("åœ¨ hadoop103 ä¸Šå‘/opt/module ç›®å½•ä¸‹çš„ group.log è¿½åŠ å†…å®¹")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hello'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" group.log\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("åœ¨ hadoop102 ä¸Šå‘ 44444 ç«¯å£å‘é€æ•°æ®")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v(" telnet hadoop102 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("44444")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])])]),s._v(" "),n("h2",{attrs:{id:"è‡ªå®šä¹‰ç»„ä»¶"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#è‡ªå®šä¹‰ç»„ä»¶"}},[s._v("#")]),s._v(" è‡ªå®šä¹‰ç»„ä»¶")]),s._v(" "),n("p",[n("strong",[s._v("è‡ªå®šä¹‰")]),s._v(" "),n("strong",[s._v("Interceptor")]),s._v(" "),n("strong",[s._v("æ‹¦æˆªå™¨")])]),s._v(" "),n("p",[s._v("ä¾‹ï¼šæ ¹æ® event ä¸­ Header çš„æŸä¸ª key çš„å€¼ï¼Œå°†ä¸åŒçš„ event å‘é€åˆ°ä¸åŒçš„ Channel")]),s._v(" "),n("p",[s._v("å®ç°æ­¥éª¤ï¼š")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("å¯¼å…¥ä¾èµ–")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("<dependency>\n <groupId>org.apache.flume</groupId>\n <artifactId>flume-ng-core</artifactId>\n <version>1.9.0</version>\n</dependency>\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("å®šä¹‰ "),n("code",[s._v("CustomInterceptorÂ·")]),s._v("ç±»å¹¶å®ç° Interceptor æ¥å£")])]),s._v(" "),n("li",[n("p",[s._v("ç±»ä¸­å®šä¹‰å˜é‡ï¼Œè¿™äº›å˜é‡æ˜¯éœ€è¦åˆ°Flume çš„é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ä½¿ç”¨")])]),s._v(" "),n("li",[n("p",[s._v("æ·»åŠ æœ‰å‚æ„é€ æ–¹æ³•å¯¹å˜é‡è¿›è¡Œå¤„ç†")])]),s._v(" "),n("li",[n("p",[s._v("å†™å…·ä½“çš„è¦å¤„ç†çš„é€»è¾‘ intercept()æ–¹æ³•")])]),s._v(" "),n("li",[n("p",[s._v("æ¥å£ä¸­å®šä¹‰äº†ä¸€ä¸ªå†…éƒ¨æ¥å£ Builderï¼Œåœ¨ configure æ–¹æ³•ä¸­è¿›è¡Œä¸€äº›å‚æ•°é…ç½®ï¼Œä¾‹ï¼šåœ¨ flume çš„ conf ä¸­æ²¡é…ç½®ä¸€äº›å‚æ•°æ—¶çš„é»˜è®¤å€¼ï¼Œé€šè¿‡builder æ–¹æ³•è¿”å›CustomInterceptorç±»çš„å¯¹è±¡")])]),s._v(" "),n("li",[n("p",[s._v("å®šä¹‰ä¸€ä¸ªé™æ€ç±»ï¼Œç±»ä¸­å°è£… MD5 åŠ å¯†æ–¹æ³•...")])]),s._v(" "),n("li",[n("p",[s._v("æ‰“æˆjaråŒ…æ‰”åˆ°libä¸­")])])]),s._v(" "),n("p",[s._v("ä¾‹ï¼š")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("atguigu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("interceptor")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Context")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Event")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("interceptor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Interceptor")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Map")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TypeInterceptor")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Interceptor")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//å£°æ˜ä¸€ä¸ªå­˜æ”¾äº‹ä»¶çš„é›†åˆ")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Event")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" addHeaderEvents"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initialize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//åˆå§‹åŒ–å­˜æ”¾äº‹ä»¶çš„é›†åˆ")]),s._v("\n addHeaderEvents "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//å•ä¸ªäº‹ä»¶æ‹¦æˆª")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Event")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("intercept")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Event")]),s._v(" event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//1.è·å–äº‹ä»¶ä¸­çš„å¤´ä¿¡æ¯")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Map")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" headers "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getHeaders")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//2.è·å–äº‹ä»¶ä¸­çš„ body ä¿¡æ¯")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" body "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getBody")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//3.æ ¹æ® body ä¸­æ˜¯å¦æœ‰"atguigu"æ¥å†³å®šæ·»åŠ æ€æ ·çš„å¤´ä¿¡æ¯')]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("body"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("contains")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"atguigu"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//4.æ·»åŠ å¤´ä¿¡æ¯")]),s._v("\n headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"first"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//4.æ·»åŠ å¤´ä¿¡æ¯")]),s._v("\n headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"second"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//æ‰¹é‡äº‹ä»¶æ‹¦æˆª")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Event")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("intercept")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Event")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" events"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//1.æ¸…ç©ºé›†åˆ")]),s._v("\n addHeaderEvents"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("clear")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//2.éå† events")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Event")]),s._v(" event "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" events"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//3.ç»™æ¯ä¸€ä¸ªäº‹ä»¶æ·»åŠ å¤´ä¿¡æ¯")]),s._v("\n addHeaderEvents"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("intercept")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//4.è¿”å›ç»“æœ")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" addHeaderEvents"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("close")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Builder")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Interceptor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Builder")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Interceptor")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("build")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TypeInterceptor")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("configure")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Context")]),s._v(" context"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br")])]),n("p",[s._v("ç¼–è¾‘ flume é…ç½®æ–‡ä»¶")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("a1.sources.r1.interceptors = i1\na1.sources.r1.interceptors.i1.type = \ncom.atguigu.flume.interceptor.CustomInterceptor$Builder\na1.sources.r1.selector.type = multiplexing\na1.sources.r1.selector.header = type\na1.sources.r1.selector.mapping.first = c1\na1.sources.r1.selector.mapping.second = c2\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[n("strong",[s._v("è‡ªå®šä¹‰")]),s._v(" "),n("strong",[s._v("Source")])]),s._v(" "),n("p",[s._v("éœ€è¦ç»§æ‰¿"),n("code",[s._v("AbstractSource")]),s._v(" ç±»å¹¶å®ç°"),n("code",[s._v("Configurable")]),s._v(" å’Œ "),n("code",[s._v("PollableSource")]),s._v(" æ¥å£")]),s._v(" "),n("p",[s._v("å®ç°ç›¸åº”æ–¹æ³•:")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("getBackOffSleepIncrement() //æš‚ä¸ç”¨ æ­¥é•¿\ngetMaxBackOffSleepInterval() //æš‚ä¸ç”¨ æœ€é•¿æ—¶é—´\nconfigure(Context context) //åˆå§‹åŒ– context è¯»å–é…ç½®æ–‡ä»¶\nprocess()//è·å–æ•°æ®å°è£…æˆ event å¹¶å†™å…¥ channelï¼Œè¿™ä¸ªæ–¹æ³•å°†è¢«å¾ªç¯è°ƒç”¨ ä¾‹å¦‚ï¼šè¯»å– MySQL æ•°æ®æˆ–è€…å…¶ä»–æ–‡ä»¶ç³»ç»Ÿã€‚\nstop() //å…³é—­ç›¸å…³çš„èµ„æº\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[n("strong",[s._v("å…·ä½“å®ç°")]),s._v(":")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Context")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EventDeliveryException")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PollableSource")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Configurable")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SimpleEvent")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AbstractSource")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HashMap")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MySource")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AbstractSource")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" \n"),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Configurable")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PollableSource")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//å®šä¹‰é…ç½®æ–‡ä»¶å°†æ¥è¦è¯»å–çš„å­—æ®µ")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" delay"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//åˆå§‹åŒ–é…ç½®ä¿¡æ¯")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("configure")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Context")]),s._v(" context"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n delay "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" context"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getLong")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"delay"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n field "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" context"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getString")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"field"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hello!"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Status")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("process")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EventDeliveryException")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//åˆ›å»ºäº‹ä»¶å¤´ä¿¡æ¯")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HashMap")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" hearderMap "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HashMap")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//åˆ›å»ºäº‹ä»¶")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SimpleEvent")]),s._v(" event "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SimpleEvent")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//å¾ªç¯å°è£…äº‹ä»¶")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//ç»™äº‹ä»¶è®¾ç½®å¤´ä¿¡æ¯")]),s._v("\n event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setHeaders")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("hearderMap"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//ç»™äº‹ä»¶è®¾ç½®å†…å®¹")]),s._v("\n event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setBody")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("field "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getBytes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//å°†äº‹ä»¶å†™å…¥ channel")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getChannelProcessor")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("processEvent")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("delay"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("printStackTrace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Status")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("BACKOFF"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Status")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("READY"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getBackOffSleepIncrement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getMaxBackOffSleepInterval")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br")])]),n("p",[s._v("é…ç½®æ–‡ä»¶ï¼š")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na1.sources "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na1.sinks "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\na1.channels "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na1.sources.r1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" åŒ…è·¯å¾„\na1.sources.r1.delay "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#a1.sources.r1.field = atguigu")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na1.sinks.k1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" logger\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Use a channel which buffers events in memory")]),s._v("\na1.channels.c1.type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na1.channels.c1.capacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na1.channels.c1.transactionCapacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na1.sources.r1.channels "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinks.k1.channel "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("p",[n("strong",[s._v("è‡ªå®šä¹‰")]),s._v(" "),n("strong",[s._v("Sink")]),s._v(":")]),s._v(" "),n("p",[s._v("éœ€è¦ç»§æ‰¿ AbstractSink ç±»å¹¶å®ç° Configurable æ¥å£")]),s._v(" "),n("p",[s._v("å®ç°ç›¸åº”æ–¹æ³•:")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("configure(Context context)//åˆå§‹åŒ–contextè¯»å–é…ç½®æ–‡ä»¶\nprocess()//ä»Channelè¯»å–è·å–æ•°æ®eventè¿™ä¸ªæ–¹æ³•å°†è¢«å¾ªç¯è°ƒç”¨ã€‚\nä½¿ç”¨åœºæ™¯ï¼šè¯»å– Channel æ•°æ®å†™å…¥ MySQL æˆ–è€…å…¶ä»–æ–‡ä»¶ç³»ç»Ÿã€‚\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("ä¾‹:")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Configurable")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sink"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AbstractSink")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("slf4j"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Logger")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("slf4j"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LoggerFactory")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MySink")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AbstractSink")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Configurable")]),s._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//åˆ›å»º Logger å¯¹è±¡")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Logger")]),s._v(" LOG "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" \n"),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LoggerFactory")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getLogger")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AbstractSink")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" prefix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" suffix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Status")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("process")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EventDeliveryException")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//å£°æ˜è¿”å›å€¼çŠ¶æ€ä¿¡æ¯")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Status")]),s._v(" status"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//è·å–å½“å‰ Sink ç»‘å®šçš„ Channel")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Channel")]),s._v(" ch "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getChannel")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//è·å–äº‹åŠ¡")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Transaction")]),s._v(" txn "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getTransaction")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//å£°æ˜äº‹ä»¶")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Event")]),s._v(" event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//å¼€å¯äº‹åŠ¡")]),s._v("\n txn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("begin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//è¯»å– Channel ä¸­çš„äº‹ä»¶ï¼Œç›´åˆ°è¯»å–åˆ°äº‹ä»¶ç»“æŸå¾ªç¯")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n event "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("take")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("event "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//å¤„ç†äº‹ä»¶ï¼ˆæ‰“å°ï¼‰")]),s._v("\n LOG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("prefix "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getBody")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" \nsuffix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//äº‹åŠ¡æäº¤")]),s._v("\n txn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("commit")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n status "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Status")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("READY"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//é‡åˆ°å¼‚å¸¸ï¼Œäº‹åŠ¡å›æ»š")]),s._v("\n txn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rollback")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n status "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Status")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("BACKOFF"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("finally")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//å…³é—­äº‹åŠ¡")]),s._v("\n txn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("close")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" status"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("configure")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Context")]),s._v(" context"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//è¯»å–é…ç½®æ–‡ä»¶å†…å®¹ï¼Œæœ‰é»˜è®¤å€¼")]),s._v("\n prefix "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" context"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getString")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prefix"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello:"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//è¯»å–é…ç½®æ–‡ä»¶å†…å®¹ï¼Œæ— é»˜è®¤å€¼")]),s._v("\n suffix "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" context"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getString")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"suffix"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);