(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{475:function(s,t,a){"use strict";a.r(t);var n=a(16),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"spark-æ¦‚è¿°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#spark-æ¦‚è¿°"}},[s._v("#")]),s._v(" "),a("strong",[s._v("Spark")]),s._v(" "),a("strong",[s._v("æ¦‚è¿°")])]),s._v(" "),a("p",[s._v("åŸºäºå†…å­˜çš„å¿«é€Ÿ,é€šç”¨å¯æ‰©å±•çš„åˆ†æè®¡ç®—å¼•æ“ï¼ŒåŸºäºscalaå¼€å‘ã€‚")]),s._v(" "),a("p",[a("strong",[s._v("æ ¸å¿ƒæ¨¡å—")]),s._v("ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("spark core ï¼š æ˜¯åŸºç¡€å’Œæœ€"),a("strong",[s._v("æ ¸å¿ƒ")]),s._v("åŠŸèƒ½ (å…¶ä»–éƒ½æ˜¯æ­¤åŸºç¡€ä¸Šå¼€å‘)")]),s._v(" "),a("li",[s._v("spark sql  ï¼š ç”¨sql"),a("strong",[s._v("æ“ä½œ")]),s._v("æŸ¥è¯¢æ•°æ®")]),s._v(" "),a("li",[s._v("spark streaming ï¼š "),a("strong",[s._v("æµå¼")]),s._v("å¤„ç†æ¨¡å—")]),s._v(" "),a("li",[s._v("spark MLib ï¼š "),a("strong",[s._v("æœºå™¨å­¦ä¹ ")]),s._v("æ¨¡å—(éš¾åº¦é«˜ éœ€è¦æ•°å­¦åŸºç¡€)")]),s._v(" "),a("li",[s._v("spark GraphXï¼š "),a("strong",[s._v("å›¾å½¢æŒ–æ˜")]),s._v("æ¨¡å—(éš¾åº¦é«˜ éœ€è¦æ•°å­¦åŸºç¡€)")])]),s._v(" "),a("p",[a("strong",[s._v("sparkå’Œhadoopçš„å¯¹æ¯”")]),s._v("ï¼š")]),s._v(" "),a("blockquote",[a("p",[s._v("Spark å’ŒHadoop çš„æ ¹æœ¬å·®å¼‚æ˜¯å¤šä¸ªä½œä¸šä¹‹é—´çš„æ•°æ®é€šä¿¡é—®é¢˜ : Spark å¤šä¸ªä½œä¸šä¹‹é—´æ•°æ®")]),s._v(" "),a("p",[s._v("é€šä¿¡æ˜¯åŸºäºå†…å­˜ï¼Œè€Œ Hadoop æ˜¯åŸºäºç£ç›˜ã€‚")]),s._v(" "),a("p",[s._v("sparkåªæœ‰åœ¨"),a("strong",[s._v("shuffle")]),s._v("æ—¶æ‰ä¼š"),a("strong",[s._v("è½ç›˜")]),s._v("ã€‚")])]),s._v(" "),a("h2",{attrs:{id:"å¿«é€Ÿä¸Šæ‰‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¿«é€Ÿä¸Šæ‰‹"}},[s._v("#")]),s._v(" "),a("strong",[s._v("å¿«é€Ÿä¸Šæ‰‹")])]),s._v(" "),a("ol",[a("li",[a("p",[a("strong",[s._v("åˆ›å»º")]),s._v(" "),a("strong",[s._v("Maven")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("å¢åŠ ")]),s._v(" "),a("strong",[s._v("Scala")]),s._v(" "),a("strong",[s._v("æ’ä»¶")]),s._v(" ï¼ˆæ³¨æ„é€‰æ‹©å¯¹åº”çš„ç‰ˆæœ¬ï¼‰")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("å¢åŠ ä¾èµ–å…³ç³»")])])])]),s._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[s._v(" "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.apache.spark"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spark-core_2.12"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("3.0.0"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependencies")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[a("code",[s._v("log4j.properties")])]),s._v(" "),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log4j.rootCategory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("ERROR, console")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log4j.appender.console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("org.apache.log4j.ConsoleAppender")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log4j.appender.console.target")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("System.err")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log4j.appender.console.layout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("org.apache.log4j.PatternLayout")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log4j.appender.console.layout.ConversionPattern")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("%d{yy/MM/dd ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("HH")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("mm:ss} %p %c{1}: %m%n")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Set the default spark-shell log level to ERROR. When running the spark-shell,")]),s._v("\nthe\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# log level for this class is used to overwrite the root logger's log level, so")]),s._v("\nthat\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# the user can have different defaults for the shell and regular Spark apps.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log4j.logger.org.apache.spark.repl.Main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("ERROR")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Settings to quiet third party logs that are too verbose")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log4j.logger.org.spark_project.jetty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("ERROR")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log4j.logger.org.spark_project.jetty.util.component.AbstractLifeCycle")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("ERROR")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log4j.logger.org.apache.spark.repl.SparkIMain$exprTyper")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("ERROR")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log4j.logger.org.apache.spark.repl.SparkILoop$SparkILoopInterpreter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("ERROR")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log4j.logger.org.apache.parquet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("ERROR")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log4j.logger.parquet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("ERROR")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# SPARK-9183: Settings to avoid annoying messages when looking up nonexistent")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("UDFs")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("in SparkSQL with Hive support")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log4j.logger.org.apache.hadoop.hive.metastore.RetryingHMSHandler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("FATAL")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log4j.logger.org.apache.hadoop.hive.ql.exec.FunctionRegistry")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("ERROR")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("ol",{attrs:{start:"4"}},[a("li",[a("p",[a("strong",[s._v("WordCount")]),s._v("æµ‹è¯•")]),s._v(" "),a("div",{staticClass:"language-scala line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åˆ›å»º Spark è¿è¡Œé…ç½®å¯¹è±¡")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" sparkConf "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" SparkConf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("setMaster"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local[*]"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("setAppName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"WordCount"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åˆ›å»º Spark ä¸Šä¸‹æ–‡ç¯å¢ƒå¯¹è±¡ï¼ˆè¿æ¥å¯¹è±¡ï¼‰")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" sc "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" SparkContext "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" SparkContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sparkConf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è¯»å–æ–‡ä»¶æ•°æ®")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" fileRDD"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" RDD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("textFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"input/word.txt"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å°†æ–‡ä»¶ä¸­çš„æ•°æ®è¿›è¡Œåˆ†è¯")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" wordRDD"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" RDD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" fileRDD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flatMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" _"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("split"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è½¬æ¢æ•°æ®ç»“æ„ word => (word, 1)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" word2OneRDD"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" RDD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" wordRDD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å°†è½¬æ¢ç»“æ„åçš„æ•°æ®æŒ‰ç…§ç›¸åŒçš„å•è¯è¿›è¡Œåˆ†ç»„èšåˆ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" word2CountRDD"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" RDD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" word2OneRDD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("reduceByKey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å°†æ•°æ®èšåˆç»“æœé‡‡é›†åˆ°å†…å­˜ä¸­")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" word2Count"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Array"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" word2CountRDD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("collect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ‰“å°ç»“æœ")]),s._v("\nword2Count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("foreach"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("println"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//å…³é—­ Spark è¿æ¥")]),s._v("\nsc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])])])]),s._v(" "),a("h2",{attrs:{id:"è¿è¡Œç¯å¢ƒ-éƒ¨ç½²"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è¿è¡Œç¯å¢ƒ-éƒ¨ç½²"}},[s._v("#")]),s._v(" "),a("strong",[s._v("è¿è¡Œç¯å¢ƒ")]),s._v(" éƒ¨ç½²")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("localæ¨¡å—")]),s._v("ï¼šæµ‹è¯•    1èŠ‚ç‚¹")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(". ä¸Šä¼ è§£å‹åˆ°æŒ‡å®šç›®å½•\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(". bin/spark-shell "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ç›´æ¥å¯åŠ¨å³å¯")]),s._v("\nUI è®¿é—®ç«¯å£ http://è™šæ‹Ÿæœºåœ°å€:4040\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("Standalone")]),s._v(" "),a("strong",[s._v("æ¨¡å¼")]),s._v(" :  "),a("strong",[s._v("ç‹¬ç«‹")]),s._v("éƒ¨ç½²  ä¸»ä»æ¶æ„æ¨¡å¼   3èŠ‚ç‚¹")])])]),s._v(" "),a("blockquote",[a("p",[s._v("æ‹¥æœ‰ä¸€ä¸ªmasterå’Œä¸‰ä¸ªworkeyï¼Œè‡ªå·±è°ƒåº¦èµ„æºè‡ªå·±æ‰§è¡Œç¨‹åº")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(". è§£å‹æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(". ä¿®æ”¹èŠ‚ç‚¹é…ç½®æ–‡ä»¶\n\t"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" conf\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" slaves.template slaves  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#å°†æ¨¡æ¿æ–‡ä»¶ä¿®æ”¹æˆè‡ªå·±çš„")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#æ·»åŠ ä¿®æ”¹ä¸»æœºèŠ‚ç‚¹")]),s._v("\n\thadoop111\n\thadoop112\n\thadoop113\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(". ä¿®æ”¹æ‰§è¡Œé…ç½®æ–‡ä»¶\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" spark-env.sh.template spark-env.sh "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#å°†æ¨¡æ¿æ–‡ä»¶æ”¹å")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#æ·»åŠ  JAVA_HOME ç¯å¢ƒå˜é‡å’Œé›†ç¾¤å¯¹åº”çš„ master èŠ‚ç‚¹")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JAVA_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/module/jdk1.8.0_144\n\t"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SPARK_MASTER_HOST")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("hadoop111\n\t"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SPARK_MASTER_PORT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7077")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#å†…éƒ¨é€šä¿¡ç«¯å£ç±»ä¼¼8020")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(". åˆ†å‘ä¿®æ”¹å¥½çš„å‹ç¼©ç›®å½•\t\n\txsync spark-standalone\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(". å¯åŠ¨orå…³é—­\n\tsbin/start-all.sh "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#å¯åŠ¨")]),s._v("\nUIè®¿é—®ç«¯å£ï¼šWeb UI ç•Œé¢: http://hadoop111:8080\t\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(". é…ç½®å†å²æœåŠ¡\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" spark-defaults.conf.template spark-defaults.conf \n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#é…ç½®æ—¥å¿—å­˜å‚¨è·¯å¾„")]),s._v("\n\tspark.eventLog.enabled "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#å¼€å¯")]),s._v("\n\tspark.eventLog.dir hdfs://hadoop111:8020/directory "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#æ­¤ç›®å½•éœ€è¦åœ¨hdfsä¸Šæå‰åˆ›å»º")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ä¿®æ”¹ spark-env.sh æ–‡ä»¶, æ·»åŠ æ—¥å¿—é…ç½®")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SPARK_HISTORY_OPTS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\n\t-Dspark.history.ui.port=18080 #æ—¥å¿—çš„WEB UIè®¿é—®ç«¯å£\n\t-Dspark.history.fs.logDirectory=hdfs://hadoop111:8020/directory #å­˜å‚¨è·¯å¾„\n\t-Dspark.history.retainedApplications=30"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ä¿å­˜çš„å†å²ä¸ªæ•°")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#åˆ†å‘é…ç½®æ–‡ä»¶")]),s._v("\n\txsync conf\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#é‡å¯é›†ç¾¤å’Œå†å²æœåŠ¡")]),s._v("\n\tsbin/start-all.sh\n\tsbin/start-history-server.sh\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br")])]),a("ul",[a("li",[a("p",[a("strong",[s._v("é…ç½®é«˜å¯ç”¨ï¼ˆHAï¼‰")]),s._v(":é˜²æ­¢å•ç‚¹æ•…éšœ  ä¸€èˆ¬é‡‡ç”¨zkè®¾ç½®")]),s._v(" "),a("blockquote",[a("p",[s._v("2å°é…ç½®master 3å°zk 3å°worker")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('1. åœæ­¢é›†ç¾¤\n2. å¯åŠ¨zké›†ç¾¤\n3. ä¿®æ”¹ spark-env.sh æ–‡ä»¶\n\t#æ³¨é‡Š\n\t#SPARK_MASTER_HOST=hadoop111\n\t#SPARK_MASTER_PORT=7077\n\tæ·»åŠ å¦‚ä¸‹å†…å®¹:\n\t#Master ç›‘æ§é¡µé¢é»˜è®¤è®¿é—®ç«¯å£ä¸º 8080ï¼Œä½†æ˜¯å¯èƒ½ä¼šå’Œ Zookeeper å†²çªï¼Œ\n\t#æ‰€ä»¥æ”¹æˆ 8989ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ï¼Œè®¿é—® UI ç›‘æ§é¡µé¢æ—¶è¯·æ³¨æ„\n\tSPARK_MASTER_WEBUI_PORT=8989\n\texport SPARK_DAEMON_JAVA_OPTS="\n\t-Dspark.deploy.recoveryMode=ZOOKEEPER \n\t-Dspark.deploy.zookeeper.url=hadoop111,hadoop112,hadoop113\n\t-Dspark.deploy.zookeeper.dir=/spark"\n4. åˆ†å‘é…ç½®æ–‡ä»¶\n\txsync conf/\n5. å¯åŠ¨é›†ç¾¤\n\tsbin/start-all.sh\n6. å¯åŠ¨å¤‡ç”¨master (éƒ¨ç½²masterçš„æœºå™¨ä¸Š)\n\tsbin/start-master.sh\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("Yarn")]),s._v(" "),a("strong",[s._v("æ¨¡å¼")]),s._v(" ï¼šå¸¸ç”¨æ¨¡å¼ğŸ‘©ğŸ¾   1èŠ‚ç‚¹")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(". è§£å‹æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(". ä¿®æ”¹hadoopä¸­çš„yarn-site.xmlé…ç½®æ–‡ä»¶\n\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("--æ˜¯å¦å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ£€æŸ¥æ¯ä¸ªä»»åŠ¡æ­£ä½¿ç”¨çš„ç‰©ç†å†…å­˜é‡ï¼Œå¦‚æœä»»åŠ¡è¶…å‡ºåˆ†é…å€¼ï¼Œåˆ™ç›´æ¥å°†å…¶æ€æ‰ï¼Œé»˜è®¤æ˜¯ "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" --"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("property"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n \t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("yarn.nodemanager.pmem-check-enabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\t\t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("value"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("false"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/value"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/property"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("--æ˜¯å¦å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ£€æŸ¥æ¯ä¸ªä»»åŠ¡æ­£ä½¿ç”¨çš„è™šæ‹Ÿå†…å­˜é‡ï¼Œå¦‚æœä»»åŠ¡è¶…å‡ºåˆ†é…å€¼ï¼Œåˆ™ç›´æ¥å°†å…¶æ€æ‰ï¼Œé»˜è®¤æ˜¯ "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" --"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("property"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\t\t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("yarn.nodemanager.vmem-check-enabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n \t\t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("value"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("false"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/value"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/property"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".  ä¿®æ”¹ conf/spark-env.sh æ·»åŠ  JAVA_HOME å’Œ YARN_CONF_DIR é…ç½®\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" spark-env.sh.template spark-env.sh "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#æ”¹å")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JAVA_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/module/jdk1.8.0_144\n\t"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("YARN_CONF_DIR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/module/hadoop/etc/hadoop\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(". å¯åŠ¨ HDFS ä»¥åŠ YARN é›†ç¾¤\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#çœ‹ http://hadoop112:8088 é¡µé¢ï¼Œç‚¹å‡» Historyï¼ŒæŸ¥çœ‹å†å²é¡µé¢")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(". é…ç½®å†å²æœåŠ¡å™¨\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" spark-defaults.conf.template spark-defaults.conf "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#æ”¹å")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#é…ç½®æ—¥å¿—å­˜å‚¨è·¯å¾„")]),s._v("\n\tspark.eventLog.enabled "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n\tspark.eventLog.dir hdfs://linux1:8020/directory "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ç›®å½•éœ€å­˜åœ¨")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ä¿®æ”¹ spark-env.sh æ–‡ä»¶,æ—¥å¿—é…ç½®")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SPARK_HISTORY_OPTS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\n\t-Dspark.history.ui.port=18080 \n\t-Dspark.history.fs.logDirectory=hdfs://hadoop111:8020/directory \n\t-Dspark.history.retainedApplications=30"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ä¿®æ”¹ spark-defaults.conf")]),s._v("\n\tspark.yarn.historyServer.address"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("hadoop111:18080\n\tspark.history.ui.port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18080")]),s._v("\t\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(". å¯åŠ¨å†å²æœåŠ¡\n\tsbin/start-history-server.sh\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("K8S & Mesos")]),s._v(" "),a("strong",[s._v("æ¨¡å¼")])]),s._v(" "),a("blockquote",[a("p",[s._v("Mesos æ˜¯ Apache ä¸‹çš„å¼€æºåˆ†å¸ƒå¼èµ„æºç®¡ç†æ¡†æ¶,å›½å¤–å¾ˆå¤šäººåœ¨ä½¿ç”¨ã€‚")]),s._v(" "),a("p",[s._v("K8Så®¹å™¨ç®¡ç†å·¥å…·ï¼šéƒ¨ç½²æ•™ç¨‹ï¼š"),a("a",{attrs:{href:"https://spark.apache.org/docs/latest/running-on-kubernetes.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://spark.apache.org/docs/latest/running-on-kubernetes.html"),a("OutboundLink")],1)])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("Windows")]),s._v(" "),a("strong",[s._v("æ¨¡å¼")]),s._v("ï¼šæµ‹è¯•æ¨¡å¼ å¯ä»¥ä¸ç”¨å¯åŠ¨è™šæ‹Ÿæœº")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(". è§£å‹åˆ°æŒ‡å®šæ–‡ä»¶ ï¼ˆæ— ä¸­æ–‡æ— ç©ºæ ¼ï¼‰\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(". å¯åŠ¨æœ¬åœ°ç¯å¢ƒ\n\tæ‰§è¡Œè§£å‹ç¼©æ–‡ä»¶è·¯å¾„ä¸‹ bin ç›®å½•ä¸­çš„ spark-shell.cmd æ–‡ä»¶ï¼Œå¯åŠ¨ Spark æœ¬åœ°ç¯å¢ƒ\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])])]),s._v(" "),a("p",[a("strong",[s._v("ç¨‹åºçš„æäº¤")]),s._v("ï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("bin/spark-submit \\\n--class org.apache.spark.examples.SparkPi \\\n--master yarn \\\n--deploy-mode cluster \\\n./examples/jars/spark-examples_2.12-3.0.0.jar \\\n10\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("è§£é‡Š")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" --class è¡¨ç¤ºè¦æ‰§è¡Œç¨‹åºçš„ä¸»ç±»ï¼Œæ­¤å¤„å¯ä»¥æ›´æ¢ä¸ºå’±ä»¬è‡ªå·±å†™çš„åº”ç”¨ç¨‹åº\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" --master local"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" éƒ¨ç½²æ¨¡å¼ï¼Œé»˜è®¤ä¸ºæœ¬åœ°æ¨¡å¼ï¼Œæ•°å­—è¡¨ç¤ºåˆ†é…çš„è™šæ‹Ÿ CPU æ ¸æ•°é‡\n   --master spark://linux1:7077 ç‹¬ç«‹éƒ¨ç½²æ¨¡å¼ï¼Œè¿æ¥åˆ° Spark é›†ç¾¤\n   --master Yarn\t\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" spark-examples_2.12-3.0.0.jar è¿è¡Œçš„åº”ç”¨ç±»æ‰€åœ¨çš„ jar åŒ…ï¼Œå®é™…ä½¿ç”¨æ—¶ï¼Œå¯ä»¥è®¾å®šä¸ºå’±\nä»¬è‡ªå·±æ‰“çš„ jar åŒ…\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" æ•°å­— "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" è¡¨ç¤ºç¨‹åºçš„å…¥å£å‚æ•°ï¼Œç”¨äºè®¾å®šå½“å‰åº”ç”¨çš„ä»»åŠ¡æ•°é‡\nå…¶ä»–\n--num-executors é…ç½® Executor çš„æ•°é‡\n--driver-memory é…ç½® Driver å†…å­˜ï¼ˆå½±å“ä¸å¤§ï¼‰\n--executor-memory 1G æŒ‡å®šæ¯ä¸ª executor å¯ç”¨å†…å­˜ä¸º 1G\n--total-executor-cores "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" æŒ‡å®šæ‰€æœ‰executorä½¿ç”¨çš„cpuæ ¸æ•°ä¸º "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" ä¸ª\n--executor-cores æŒ‡å®šæ¯ä¸ªexecutorä½¿ç”¨çš„cpuæ ¸æ•°\napplication-arguments ä¼ ç»™ main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("æ–¹æ³•çš„å‚æ•°\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[a("strong",[s._v("è¡¥å……")]),s._v("ï¼šç”Ÿäº§ç¯å¢ƒ Spark submit è„šæœ¬é…ç½®")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("bin/spark-submit "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--class com.atguigu.spark.WordCount "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--master yarn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--deploy-mode cluster"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--num-executors "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--driver-memory 6g "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--executor-memory 6g "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--executor-cores "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--queue root.default "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--conf spark.yarn.executor.memoryOverhead"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--conf spark.core.connection.ack.wait.timeout"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("300")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/usr/local/spark/spark.jar\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("å‚æ•°é…ç½®å‚è€ƒå€¼ï¼š")]),s._v(" "),a("div",{staticClass:"language-scala line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[s._v("â¢ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("num"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("executorsï¼š"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\nâ¢ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("driver"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("memoryï¼š"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("G"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("G\nâ¢ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("executor"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("memoryï¼š"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("G"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("G\nâ¢ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("executor"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("coresï¼š"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" â¢ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("masterï¼šå®é™…ç”Ÿäº§ç¯å¢ƒä¸€å®šä½¿ç”¨\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("blockquote",[a("p",[s._v("æ€»ç»“ç«¯å£å·ï¼š")]),s._v(" "),a("p",[s._v("â¢ Spark æŸ¥çœ‹å½“å‰ Spark-shell è¿è¡Œä»»åŠ¡æƒ…å†µç«¯å£å·ï¼š4040ï¼ˆè®¡ç®—ï¼‰")]),s._v(" "),a("p",[s._v("â¢ Spark Master å†…éƒ¨é€šä¿¡æœåŠ¡ç«¯å£å·ï¼š7077")]),s._v(" "),a("p",[s._v("â¢ Standalone æ¨¡å¼ä¸‹ï¼ŒSpark Master Web ç«¯å£å·ï¼š8080ï¼ˆèµ„æºï¼‰")]),s._v(" "),a("p",[s._v("â¢ Spark å†å²æœåŠ¡å™¨ç«¯å£å·ï¼š18080")]),s._v(" "),a("p",[s._v("â¢ Hadoop YARN ä»»åŠ¡è¿è¡Œæƒ…å†µæŸ¥çœ‹ç«¯å£å·ï¼š8088")])]),s._v(" "),a("h2",{attrs:{id:"è¿è¡Œæ¶æ„"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è¿è¡Œæ¶æ„"}},[s._v("#")]),s._v(" "),a("strong",[s._v("è¿è¡Œæ¶æ„")])]),s._v(" "),a("p",[s._v("ä¸»ä»æ¶æ„")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/axcmsm/tmp/raw/master/bigdata/20211002162318.png",alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("Dirver")]),s._v(": è°ƒåº¦èŠ‚ç‚¹")]),s._v(" "),a("ul",[a("li",[s._v("å°†ç”¨æˆ·ç¨‹åºè½¬æ¢æˆä½œä¸š")]),s._v(" "),a("li",[s._v("åœ¨Executorä¹‹é—´è°ƒåº¦ä»»åŠ¡task")]),s._v(" "),a("li",[s._v("è·Ÿè¸ªæ‰§è¡Œæƒ…å†µ")]),s._v(" "),a("li",[s._v("é€šè¿‡UIå±•ç¤ºè¿è¡Œæƒ…å†µ")])]),s._v(" "),a("p",[a("strong",[s._v("Executor")]),s._v("ï¼šè®¡ç®—èŠ‚ç‚¹")]),s._v(" "),a("ul",[a("li",[s._v("è´Ÿè´£æ‰§è¡Œå…·ä½“ä»»åŠ¡Taskï¼Œå¹¶å°†å…¶è¿”å›ç»™Driver")]),s._v(" "),a("li",[s._v("ä¸ºäº†æé«˜æ€§èƒ½ä¹Ÿä¼šå¯¹æ•°æ®è¿›è¡Œä¸€äº›ç¼“å­˜RDD")])]),s._v(" "),a("p",[a("strong",[s._v("ç‹¬ç«‹éƒ¨ç½²ç»„ä»¶")]),s._v("ï¼šMaster&Workerï¼šè·Ÿèµ„æºç›¸å…³ ï¼ˆç›¸å½“äºyarnçš„è€å¤§å’Œå°å¼Ÿï¼‰")]),s._v(" "),a("p",[a("strong",[s._v("ApplicationMaster")]),s._v(": æä¾›ï¼šè®¡ç®—å’Œèµ„æºäº¤äº’")]),s._v(" "),a("h3",{attrs:{id:"æ ¸å¿ƒæ¦‚å¿µ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ ¸å¿ƒæ¦‚å¿µ"}},[s._v("#")]),s._v(" æ ¸å¿ƒæ¦‚å¿µ")]),s._v(" "),a("p",[a("strong",[s._v("Executor&Core")])]),s._v(" "),a("blockquote",[a("p",[s._v("Executoræ˜¯è¿è¡Œåœ¨worker(å·¥ä½œèŠ‚ç‚¹)ä¸Šçš„ä¸€ä¸ªjvmè¿›ç¨‹ã€‚ä¸“é—¨ç”¨äºè®¡ç®—çš„èŠ‚ç‚¹ï¼Œæäº¤éœ€è¦æŒ‡å®šèŠ‚ç‚¹ä¸ªæ•°å’Œè®¡ç®—å¯¹åº”çš„èµ„æº ï¼ˆExecutorçš„å†…å­˜å¤§å°å’ŒCPUæ ¸(Core) çš„æ•°é‡")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("é…ç½®å‚æ•°\n\tåç§°   \t\t\t\tè¯´æ˜\n--num-executors \té…ç½® Executor çš„æ•°é‡\n--executor-memory é…ç½®æ¯ä¸ª Executor çš„å†…å­˜å¤§å°\n--executor-cores é…ç½®æ¯ä¸ª Executor çš„è™šæ‹Ÿ CPU core æ•°é‡\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[a("strong",[s._v("å¹¶è¡Œåº¦")]),s._v(" Parallelism  :æ•´ä¸ªé›†ç¾¤å¹¶è¡Œæ‰§è¡Œä»»åŠ¡çš„æ•°é‡ã€‚(å ç”¨çš„æ ¸core)")]),s._v(" "),a("p",[a("strong",[s._v("æœ‰å‘æ— ç¯å›¾")]),s._v(" DAG : ä»»åŠ¡çš„è°ƒåº¦ï¼Œå…¶å†…éƒ¨æ˜¯æœ‰å‘æ— ç¯å›¾")]),s._v(" "),a("p",[a("strong",[s._v("æäº¤æµç¨‹")]),s._v("ï¼š")]),s._v(" "),a("p",[s._v("è¿™é‡Œä¸»è¦yarnçš„æäº¤æµç¨‹")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/axcmsm/tmp/raw/master/bigdata/20211002162838.png",alt:""}})]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("1. ä»»åŠ¡æäº¤\t\n2. Driverè¿è¡Œ(ç”³è¯·æ”¯æ´) -> å‘é›†ç¾¤ç®¡ç†è€… æ³¨å†Œä»»åŠ¡ -> ç®¡ç†è€… å¯åŠ¨Executoråè¿›è¡Œåå‘æ³¨å†Œç»™(å‘Šè¯‰)Driver\n3. æ¡ä»¶æ»¡è¶³-> æ‰§è¡ŒMainå‡½æ•° (æ‰§è¡Œè®¡ç®—ä»£ç )\n4. æ‡’æ‰§è¡Œ->æ‰§è¡Œåˆ°actionç®—å­\n5. è§¦å‘job-> stageåˆ’åˆ†\n6. åˆ›å»ºTaskSet ä»»åŠ¡ -> å‘é€ç»™ å·²ç»å¯åŠ¨çš„Executor è¿›è¡Œæ‰§è¡Œ\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("blockquote",[a("p",[s._v("yarnéƒ¨ç½²æ–¹å¼åˆ†ä¿©ç§: "),a("strong",[s._v("Client")]),s._v("(é›†ç¾¤ä¹‹å¤–) å’Œ"),a("strong",[s._v("Cluster")]),s._v("() ï¼š"),a("strong",[s._v("Driver")]),s._v("ç¨‹åºçš„è¿è¡ŒèŠ‚ç‚¹ä¸åŒ")])]),s._v(" "),a("p",[a("strong",[s._v("Yarn Client")]),s._v(" "),a("strong",[s._v("æ¨¡å¼")]),s._v("ï¼šåœ¨å®¢æˆ·ç«¯æ‰§è¡Œï¼Œä¸€èˆ¬ç”¨äºæµ‹è¯•ç¯å¢ƒ")]),s._v(" "),a("p",[a("strong",[s._v("Yarn Cluster")]),s._v(" "),a("strong",[s._v("æ¨¡å¼")]),s._v(" ï¼šå¯åŠ¨åœ¨ Yarn é›†ç¾¤èµ„æºä¸­æ‰§è¡Œï¼Œä¸€èˆ¬ç”¨äºç”Ÿäº§ç¯å¢ƒ")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(". åœ¨ YARN Cluster æ¨¡å¼ä¸‹ï¼Œä»»åŠ¡æäº¤åä¼šå’Œ ResourceManager é€šè®¯ç”³è¯·å¯åŠ¨\nApplicationMaster\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(". éšå ResourceManager åˆ†é… containerï¼Œåœ¨åˆé€‚çš„ NodeManager \nä¸Šå¯åŠ¨ ApplicationMasterï¼Œæ­¤æ—¶çš„ ApplicationMaster å°±æ˜¯ Driver\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(". Driver å¯åŠ¨åå‘ ResourceManager ç”³è¯· Executor å†…å­˜ï¼ŒResourceManager æ¥åˆ°\nApplicationMaster çš„èµ„æºç”³è¯·åä¼šåˆ†é… containerï¼Œç„¶ååœ¨åˆé€‚çš„ NodeManager ä¸Šå¯åŠ¨\nExecutor è¿›ç¨‹\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(". Executor è¿›ç¨‹å¯åŠ¨åä¼šå‘ Driver åå‘æ³¨å†Œï¼ŒExecutor å…¨éƒ¨æ³¨å†Œå®Œæˆå Driver å¼€å§‹æ‰§è¡Œ\nmain å‡½æ•°\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(". ä¹‹åæ‰§è¡Œåˆ° Action ç®—å­æ—¶ï¼Œè§¦å‘ä¸€ä¸ª Jobï¼Œå¹¶æ ¹æ®å®½ä¾èµ–å¼€å§‹åˆ’åˆ† stageï¼Œæ¯ä¸ª stage ç”Ÿ\næˆå¯¹åº”çš„ TaskSetï¼Œä¹‹åå°† task åˆ†å‘åˆ°å„ä¸ª Executor ä¸Šæ‰§è¡Œ\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h2",{attrs:{id:"æ ¸å¿ƒç¼–ç¨‹â›³"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ ¸å¿ƒç¼–ç¨‹â›³"}},[s._v("#")]),s._v(" "),a("strong",[s._v("æ ¸å¿ƒç¼–ç¨‹")]),s._v("â›³")]),s._v(" "),a("p",[s._v("ä¸ºäº†å®ç°é«˜å¹¶å‘å’Œé«˜åå,å°è£…äº†ä¸‰å¤§æ•°æ®ç»“æ„ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("RDD :å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†")]),s._v(" "),a("li",[s._v("ç´¯åŠ å™¨ ï¼šåˆ†å¸ƒå¼å…±äº«åªå†™å˜é‡")]),s._v(" "),a("li",[s._v("å¹¿æ’­å˜é‡ ï¼šåˆ†å¸ƒå¼å…±äº«åªè¯»å˜é‡")])]),s._v(" "),a("p",[a("strong",[s._v("RDD")]),s._v("ï¼šæ•°æ®åŸºæœ¬çš„"),a("strong",[s._v("å¤„ç†æ¨¡å‹")]),s._v(",æœ€å°çš„è®¡ç®—å•å…ƒ")]),s._v(" "),a("blockquote",[a("p",[s._v("ä¼šæŠŠRDDé‡Œé¢çš„å†…å®¹(è¯»å–æ•°æ®oré€»è¾‘åˆ‡åˆ† "),a("strong",[s._v("åˆ†åŒºæ¦‚å¿µ")]),s._v(")åˆ†è§£æˆä¸€ä¸ªä¸€ä¸ªtaskå‘é€ç»™Executoræ‰§è¡ŒèŠ‚ç‚¹")]),s._v(" "),a("p",[s._v("å®é™…ä¸Šä¸€ä¸ªRDDé‡Œé¢çš„é€»è¾‘æ˜¯å¾ˆç®€å•çš„,æ‰€ä»¥ä¸€ä¸ªå¤æ‚çš„ä»»åŠ¡æ˜¯å¤šä¸ªRDDä¸²è”èµ·æ¥,ç„¶åå†åˆ†è§£æˆtaskå‘é€æ‰§è¡ŒèŠ‚ç‚¹,è¿›è¡Œå¹¶è¡Œå¤„ç†ã€‚")]),s._v(" "),a("p",[s._v("æ˜¯ä¸€ä¸ªæŠ½è±¡ï¼Œå¼¹æ€§ã€ä¸å¯å˜ã€å¯åˆ†åŒºã€é‡Œé¢å¯å¹¶è¡Œè®¡ç®—çš„é›†åˆ")]),s._v(" "),a("p",[a("strong",[s._v("å¼¹æ€§")]),s._v(":")]),s._v(" "),a("ul",[a("li",[s._v("å†…å­˜ï¼š(å†…å­˜ç£ç›˜è‡ªåŠ¨åˆ‡æ¢)ã€")]),s._v(" "),a("li",[s._v("å®¹é”™ï¼š(æ•°æ®ä¸¢å¤±å¯è‡ªåŠ¨æ¢å¤)")]),s._v(" "),a("li",[s._v("è®¡ç®—ï¼š(è®¡ç®—å‡ºé”™å¯é‡è¯•)")]),s._v(" "),a("li",[s._v("åˆ†ç‰‡ï¼š(æŒ‰éœ€é‡æ–°åˆ†ç‰‡)")])]),s._v(" "),a("p",[a("strong",[s._v("æŠ½è±¡")]),s._v("ï¼šæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»,å¯æŒ‰éœ€å­ç±»æ·»åŠ æ‰©å±•")]),s._v(" "),a("p",[a("strong",[s._v("æ•°æ®é›†")]),s._v("ï¼šå°è£…äº†è®¡ç®—é€»è¾‘ã€ä¸ä¿å­˜æ•°æ®")]),s._v(" "),a("p",[a("strong",[s._v("åˆ†å¸ƒå¼")]),s._v("ï¼šæ•°æ®å­˜å‚¨é›†ç¾¤ä¸åŒèŠ‚ç‚¹ä¸Š")]),s._v(" "),a("p",[a("strong",[s._v("ä¸å¯å˜")]),s._v("ï¼šå°è£…äº†è®¡ç®—é€»è¾‘ï¼Œæ˜¯ä¸å¯æ”¹å˜çš„ï¼Œéœ€è¦æ”¹å˜åªèƒ½äº§ç”Ÿæ–°RDD")]),s._v(" "),a("p",[a("strong",[s._v("å¯åˆ†åŒºã€å¹¶è¡Œè®¡ç®—")])])]),s._v(" "),a("p",[s._v("æ‰©å±•ï¼š")]),s._v(" "),a("p",[s._v("RDDå¤„ç†çš„æ•°æ®çš„æ–¹å¼ç±»å‹äºIOæµ,ä¹Ÿæœ‰"),a("strong",[s._v("è£…é¥°è€…è®¾è®¡æ¨¡å¼")])]),s._v(" "),a("p",[s._v("å‰é¢å¤„ç†æ•°æ®flatmapã€reduceBykey...æ˜¯æ„å»ºå¤„ç†æ•°æ®çš„æ–¹å¼(åŠŸèƒ½æ‰©å±•ä¸€æ­¥å¥—ä¸€æ­¥)ï¼Œä¸ä¼šçœŸæ­£å¤„ç†æ•°æ®ï¼Œå½“æ‰§è¡Œåˆ°"),a("strong",[s._v("collect()æ—¶æ‰çœŸæ­£å¼€å§‹å¤„ç†æ•°æ®")]),s._v(",ä½†rddä¸ä¿å­˜æ•°æ®ï¼Œioä¼šä¸´æ—¶ä¿å­˜ä¸€å°éƒ¨åˆ†æ•°æ®ã€‚")]),s._v(" "),a("p",[a("strong",[s._v("æ ¸å¿ƒå±æ€§")])]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("åˆ†åŒºåˆ—è¡¨")]),s._v("ï¼šRDDæ•°æ®ç»“æ„ä¸­å­˜åœ¨åˆ†åŒºåˆ—è¡¨ï¼Œç”¨äºæ‰§è¡Œä»»åŠ¡æ—¶å¹¶è¡Œè®¡ç®—ã€‚")]),s._v(" "),a("li",[a("strong",[s._v("åˆ†åŒºè®¡ç®—å‡½æ•°")]),s._v("ï¼šä½¿ç”¨åˆ†åŒºè®¡ç®—å‡½æ•°å¯¹æ¯ä¸€ä¸ªåˆ†åŒºè¿›è¡Œè®¡ç®—  (å› ä¸ºé€»è¾‘å·²ç»å°è£…å¥½äº†)")]),s._v(" "),a("li",[a("strong",[s._v("RDDä¹‹é—´çš„ä¾èµ–å…³ç³»")]),s._v("ï¼šrddæ˜¯è®¡ç®—æ¨¡å‹çš„å°è£…ï¼Œæœ‰æ—¶ä¹Ÿéœ€è¦å¤šä¸ªè®¡ç®—æ¨¡å‹è¿›è¡Œç»„åˆã€‚")]),s._v(" "),a("li",[a("strong",[s._v("åˆ†åŒºå™¨")]),s._v(":ï¼ˆå¯é€‰ï¼‰å½“æ•°æ®ä¸º KV ç±»å‹æ•°æ®æ—¶ï¼Œå¯ä»¥é€šè¿‡è®¾å®šåˆ†åŒºå™¨è‡ªå®šä¹‰æ•°æ®çš„åˆ†åŒº")]),s._v(" "),a("li",[a("strong",[s._v("é¦–é€‰ä½ç½®")]),s._v(": é€‰æ‹©ä¸åŒçš„èŠ‚ç‚¹ä½ç½®("),a("strong",[s._v("æ•°æ®çš„ä½ç½®)"),a("strong",[s._v("è¿›è¡Œè®¡ç®—")]),s._v("(å› ä¸ºç§»åŠ¨æ•°æ®ä¸å¦‚ç§»åŠ¨è®¡ç®—)")])])]),s._v(" "),a("p",[a("strong",[s._v("æ‰§è¡ŒåŸç†")]),s._v(":")]),s._v(" "),a("p",[s._v("RDDæ˜¯æ•°æ®å¤„ç†æ˜¯æ ¸å¿ƒæ¨¡å‹ã€‚")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#å·¥ä½œåŸç†")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(". å¯åŠ¨yarné›†ç¾¤ç¯å¢ƒ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RM -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" NM\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(". sparké€šè¿‡ç”³è¯·èµ„æºè°ƒåº¦èŠ‚ç‚¹Driverå’Œè®¡ç®—èŠ‚ç‚¹Executor \n\tDirver åœ¨RMä¸­ è€ŒExecutoråœ¨NMä¸­\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(". æ ¹æ®éœ€æ±‚å°†è®¡ç®—é€»è¾‘æ ¹æ®åˆ†åŒºåˆ’åˆ†æˆä¸åŒçš„ä»»åŠ¡  å°†ä»»åŠ¡æ”¾ç½®åœ¨ ä»»åŠ¡æ±  å½“ä¸­ Driverè°ƒåº¦ \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(". è°ƒåº¦çš„èŠ‚ç‚¹å°†ä»»åŠ¡æ ¹æ®è®¡ç®—èŠ‚ç‚¹çŠ¶æ€"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("é¦–é€‰ä½ç½®"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("å‘é€åˆ°å¯¹åº”çš„ä½ç½®ä¸Šè¿›è¡Œè®¡ç®—\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# RDDæ•´ä¸ªæµç¨‹ä¸»è¦æ˜¯è®²é€»è¾‘è¿›è¡Œå°è£…,ä»¥åŠç”ŸæˆTaskå‘é€ç»™Executor")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h3",{attrs:{id:"rddåŸºç¡€ç¼–ç¨‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rddåŸºç¡€ç¼–ç¨‹"}},[s._v("#")]),s._v(" RDDåŸºç¡€ç¼–ç¨‹")]),s._v(" "),a("p",[a("strong",[s._v("RDD")]),s._v(" "),a("strong",[s._v("åˆ›å»º")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("å†…å­˜åˆ›å»º (å¸¸ç”¨) :``makeRDD(seq or list) åº•å±‚è°ƒç”¨äº†`parallelizeæ–¹æ³•")]),s._v(" "),a("blockquote",[a("p",[s._v("é»˜è®¤æ˜¯å¹¶è¡Œåº¦åˆ†åŒºæ•°(å½“å‰ç¯å¢ƒè¿è¡Œæœ€å¤§æ ¸æ•°),ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®š")])])]),s._v(" "),a("li",[a("p",[s._v("å¤–éƒ¨å­˜å‚¨æ–‡ä»¶åˆ›å»º (å¸¸ç”¨)")]),s._v(" "),a("blockquote",[a("p",[a("code",[s._v('textFile("datas/1*.txt")æŒ‰è¡Œè¯»å–')]),s._v(" è¿”å›å­—ç¬¦ä¸²  é»˜è®¤æ˜¯ä¿©ä¸ªåˆ†åŒº math.min(æ ¸æ•°,2)  ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®š")]),s._v(" "),a("p",[a("code",[s._v("wholeTextFiles æŒ‰æ–‡ä»¶è¯»å–")]),s._v("ï¼šè¿”å›å…ƒç»„(è·¯å¾„,å†…å®¹)")])])]),s._v(" "),a("li",[a("p",[s._v("å…¶ä»–çš„RDDåˆ›å»º")])]),s._v(" "),a("li",[a("p",[s._v("ç›´æ¥åˆ›å»º(new)")])])]),s._v(" "),a("div",{staticClass:"language-scala line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//local[*] [*]è¡¨ç¤ºåˆ©ç”¨å½“å‰ç”µè„‘çš„CPUæ ¸æ•°æ¨¡æ‹Ÿçº¿ç¨‹æ‰§è¡Œ *è¡¨ç¤ºå½“å‰çº¿æœ€å¤§ä½¿ç”¨æ ¸æ•°")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//local ä¸å†™é»˜è®¤æ˜¯å•æ ¸çº¿ç¨‹æ‰§è¡Œ")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" sparkConf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" SparkConf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("setMaster"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local[*]"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("setAppName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"RDDtest"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" sc "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" SparkContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sparkConf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//ä»å†…å­˜ä¸­åˆ›å»º æ¥è‡ªé›†åˆ")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//val  seq=Seq[Int](1,3,4,2)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    val rdd = sc.makeRDD(seq)//åº•å±‚è°ƒç”¨parallelize")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" rdd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("makeRDD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n      List"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//åˆ†åŒºæ•° é»˜è®¤æ˜¯å¹¶è¡Œåº¦åˆ†åŒºæ•°(å½“å‰ç¯å¢ƒè¿è¡Œæœ€å¤§æ ¸æ•°)")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    rdd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("saveAsTextFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"output"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//è®²æ•°æ®ä¿å­˜æˆåˆ†åŒºæ–‡ä»¶")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//è¯»å–æ–‡ä»¶ é¡¹ç›®æ ¹è·¯å¾„  ç›®å½• ä¹Ÿå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ è¿˜å¯ä»¥æŒ‡å®š hdfsè·¯å¾„")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    sc.wholeTextFiles("wenj") æŒ‰è¡Œè¯»å–')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    val rdd = sc.textFile("datas/1*.txt")//å½“å‰ç¯å¢ƒæ ¹è·¯å¾„ä¸ºåŸºå‡†ã€‚å¯ä»¥å†™ç»å¯¹orç›¸å¯¹')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//hdfs://ä¸»æœºå:8020/æ–‡ä»¶ç›®å½•è·¯å¾„")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//å¹¶è¡Œparallelize   éœ€è¦è·Ÿæ ¸æ•°")]),s._v("\n    rdd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("collect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("foreach"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("println"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    sc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("p",[a("strong",[s._v("åˆ†åŒºçš„è®¾ç½®")])]),s._v(" "),a("ul",[a("li",[s._v("makeRDDï¼šé»˜è®¤æ˜¯è¯»å–é…ç½®çš„å‚æ•°å¦‚æœæ²¡æœ‰ï¼Œé»˜è®¤æ˜¯å¹¶è¡Œåº¦åˆ†åŒºæ•°(å½“å‰ç¯å¢ƒè¿è¡Œæœ€å¤§æ ¸æ•°),")]),s._v(" "),a("li",[s._v("textfileï¼šé»˜è®¤æ˜¯è¯»å–é…ç½®çš„å‚æ•°å¦‚æœæ²¡æœ‰,å°±æ˜¯é»˜è®¤æ˜¯ä¿©ä¸ªåˆ†åŒº math.min(æ ¸æ•°,2)")])]),s._v(" "),a("blockquote",[a("p",[s._v("ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šåˆ†åŒºæ•°é‡")])]),s._v(" "),a("p",[a("strong",[s._v("åˆ†åŒºçš„åˆ’åˆ†")]),s._v(":")]),s._v(" "),a("div",{staticClass:"language-scala line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[s._v("# æ ¸å¿ƒæºç \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" positions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("length"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" numSlices"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Iterator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" until numSlices"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("iterator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("map "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("=>")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" start "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" numSlices"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("toInt\n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" end "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" numSlices"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("toInt\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[a("strong",[s._v("åˆ†åŒºçš„å†…å®¹åˆ’åˆ†")]),s._v("ï¼š")]),s._v(" "),a("p",[s._v("ä»¥è¡Œä¸ºå•ä½,è¿›è¡Œè¯»å–,è¯»å–æ—¶ä»¥åç§»é‡ä¸ºå•ä½")]),s._v(" "),a("p",[s._v("æ•°æ®åˆ†åŒºæ ¹æ®åç§»é‡èŒƒå›´è¿›è¡Œè®¡ç®—ï¼Œåç§»é‡ä¸ä¼šè¢«é‡å¤è¯»å–ã€‚")]),s._v(" "),a("p",[a("strong",[s._v("åˆ†åŒºè€ƒè¯")]),s._v("ï¼š")]),s._v(" "),a("div",{staticClass:"language-scala line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[s._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("args"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Array"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Unit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//local[*] [*]è¡¨ç¤ºåˆ©ç”¨å½“å‰ç”µè„‘çš„CPUæ ¸æ•°æ¨¡æ‹Ÿçº¿ç¨‹æ‰§è¡Œ *è¡¨ç¤ºå½“å‰çº¿æœ€å¤§ä½¿ç”¨æ ¸æ•°")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//local ä¸å†™é»˜è®¤æ˜¯å•æ ¸çº¿ç¨‹æ‰§è¡Œ")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" sparkConf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" SparkConf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("setMaster"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local[*]"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("setAppName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"RDDtest"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" sc "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" SparkContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sparkConf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//14byte/2=7byte")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//èƒ½æ•´é™¤ ä¿©åˆ†åŒº")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*\n      é»˜è®¤åŠ å›è½¦æ¢è¡Œ\n      1234567@@ => 01245678         åç§»é‡\n      89@@      => 910 11 12\n      0         => 13\n      é¢„ä¼°èŒƒå›´ é‡Œçš„å€¼\n      [0,7] => 0124567\n      [7,14] =>890\n       */")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" rdd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("textFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"datas/word.txt"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    rdd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("saveAsTextFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"output"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    sc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("p",[a("strong",[s._v("ç®—å­")]),s._v("ï¼šRDDå¯¹è±¡æ–¹æ³•")]),s._v(" "),a("ul",[a("li",[s._v("è½¬æ¢ç®—å­ï¼šåŠŸèƒ½çš„è¡¥å……å’Œå°è£… ä¾‹: flatmap.map")]),s._v(" "),a("li",[s._v("è¡ŒåŠ¨ç®—å­ï¼šè§¦å‘ä½œä¸šæ‰§è¡Œå’Œä»»åŠ¡è°ƒåº¦ ä¾‹ï¼šcollect")])]),s._v(" "),a("blockquote",[a("p",[s._v("æŠŠè¿™äº›"),a("strong",[s._v("æ–¹æ³•")]),s._v("å°†å…¶ç§°ä¸ºRDD"),a("strong",[s._v("ç®—å­")]),s._v("  Operator(æ“ä½œ)")])]),s._v(" "),a("h3",{attrs:{id:"rddè½¬æ¢ç®—å­"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rddè½¬æ¢ç®—å­"}},[s._v("#")]),s._v(" RDDè½¬æ¢ç®—å­")]),s._v(" "),a("p",[s._v("æ•°æ®å¤„ç†æ–¹å¼ï¼šæ•´ä½“ä¸Šåˆ†ä¸º Value ç±»å‹ã€åŒ Value ç±»å‹å’Œ Key-Valueç±»å‹")]),s._v(" "),a("p",[a("strong",[s._v("Value")]),s._v(" "),a("strong",[s._v("ç±»å‹")])]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("map")]),s._v(" ï¼šå°†å¤„ç†çš„æ•°æ®é€æ¡è¿›è¡Œæ˜ å°„è½¬æ¢  (åˆ†åŒºå†…)")]),s._v(" "),a("blockquote",[a("p",[s._v("ä¸åŒåˆ†åŒºæ— åº      åŒåˆ†åŒºå†…æ‰§è¡Œæœ‰åº(ä¸€ä¸ªä¸€ä¸ª)")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("mapPartitions")]),s._v("ï¼š "),a("strong",[s._v("ä»¥åˆ†åŒºä¸ºå•ä½")]),s._v("å‘é€åˆ°è®¡ç®—èŠ‚ç‚¹è¿›è¡Œå¤„ç†   (æ‰¹å¤„ç†æ“ä½œ)")]),s._v(" "),a("blockquote",[a("p",[s._v("æŠŠåˆ†åŒºå†…çš„æ•°æ®å…¨éƒ¨éƒ½æ‹¿åˆ°å†è¿›è¡Œæ“ä½œ, é‡Œé¢æ˜¯è¿­ä»£å™¨")]),s._v(" "),a("p",[s._v("ä¼šå°†æ•´ä¸ªåˆ†åŒºçš„æ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­,è¿›è¡Œå¼•ç”¨ï¼Œå¤„ç†å®Œä¹Ÿä¸ä¼šè¢«é‡Šæ”¾ï¼Œå­˜åœ¨è¢«å¼•ç”¨")]),s._v(" "),a("p",[s._v("å†…å­˜è¾ƒå°æ•°æ®è¾ƒå¤§ä¼šå¯¼è‡´å†…å­˜æº¢å‡º")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("mapPartitionsWithIndex")]),s._v(": åˆ†åŒºç´¢å¼•")]),s._v(" "),a("blockquote",[a("p",[s._v("å¯æŒ‡å®šç´¢å¼•æŒ‰éœ€è¿”å›çš„åˆ†åŒº, "),a("code",[s._v("Nil.iterator ç©ºè¿­ä»£å™¨")])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("flatMap")]),s._v(": æ‰å¹³æ˜ å°„ List => Int ..")]),s._v(" "),a("blockquote",[a("p",[s._v("è¿”å›ä¸€ä¸ªå¯è¿­ä»£çš„é›†åˆ")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("glom")]),s._v(" ï¼š æ•°æ®è½¬æ¢æˆå†…å­˜æ•°ç»„  int => LIst")]),s._v(" "),a("blockquote",[a("p",[s._v("ä¸€ä¸ªåˆ†åŒºä¸€ä¸ªæ•°ç»„  åˆ†åŒºä¸å˜è½¬æ¢çš„æ•°æ®ä¹Ÿä¸å˜")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("groupBy")]),s._v(": åˆ†åŒºä¸ªæ•°ä¸å˜ï¼Œå¯¹æŒ‡å®šè§„åˆ™è¿›è¡Œåˆ†ç»„ï¼Œæ•°æ®ä¼šè¢«é‡æ–°ç»„åˆ("),a("strong",[s._v("shuffle")]),s._v(")")]),s._v(" "),a("blockquote",[a("p",[s._v("å¯¹ç›¸åŒçš„keyæ”¾ç½®åŒä¸€ä¸ªç»„ä¸­")]),s._v(" "),a("p",[s._v("åˆ†åŒºå’Œåˆ†ç»„æ²¡æœ‰å¿…ç„¶å…³ç³»ï¼Œåˆ†åŒºé‡Œé¢çš„æ•°æ®ä¼šæ”¹å˜(æ‰“ä¹±æ´—ç‰Œ)")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("filter")]),s._v(" :è¿‡æ»¤")]),s._v(" "),a("blockquote",[a("p",[s._v("è¿‡æ»¤ååˆ†åŒºä¸å˜ï¼Œå¯èƒ½åˆ†åŒºå†…çš„æ•°æ®ä¸å‡è¡¡ï¼Œä¼šå‘ç”Ÿ"),a("strong",[s._v("æ•°æ®å€¾æ–œ")])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("sample")]),s._v(" :æŠ½å–æ•°æ®")]),s._v(" "),a("blockquote",[a("p",[s._v("æœ‰é‡å¤çš„æ¦‚å¿µ")]),s._v(" "),a("p",[s._v("åŸºå‡†å€¼æ¦‚å¿µï¼šæ¦‚ç‡")]),s._v(" "),a("p",[s._v("ä¸‰ä¸ªå‚æ•°:")]),s._v(" "),a("ul",[a("li",[s._v("æ˜¯å¦æ”¾å›å»")]),s._v(" "),a("li",[s._v("ä¸æ”¾å›è¡¨ç¤ºï¼šæ¯æ¡æ•°æ®æŠ½å–çš„æ¦‚ç‡(åˆ†æ•°) ï¼Œæ”¾å›ï¼šè¡¨ç¤ºæ¯æ¡æ•°æ®æŠ½å–çš„å¯èƒ½æ¬¡æ•°ï¼ˆæ•´æ•°ï¼‰")]),s._v(" "),a("li",[s._v("éšæœºç®—æ³•çš„ç§å­(ä¸ä¼ é€’è¡¨ç¤ºå½“å‰ç³»ç»Ÿæ—¶é—´,éšæœº)")])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("distinct")]),s._v("ï¼šå»é‡")]),s._v(" "),a("blockquote",[a("p",[s._v("åŸç†é‡‡ç”¨ mapè½¬æ¢æˆ(å€¼,null)ç„¶åreduceBykey()æ ¹æ®å€¼è¿›è¡Œèšåˆç„¶åmapå–å‡ºå€¼ã€‚")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("coalesce")]),s._v(" ï¼šç¼©å‡åˆ†åŒº")]),s._v(" "),a("blockquote",[a("p",[s._v("è¿‡æ»¤åçš„æ•°æ®æ¯”è¾ƒå°,ä½†æ˜¯åˆ†åŒºæ•°ä¸å˜,æ‰§è¡Œéœ€è¦ä¿©ä¸ªExecutoræ‰§è¡Œã€‚")]),s._v(" "),a("p",[s._v("è€Œcoalesceå¯ä»¥æŠŠä»–ä»¬åˆå¹¶æˆä¸€ä¸ªåˆ†åŒºå†äº¤ç»™ä¸€ä¸ªExecutoræ‰§è¡Œï¼ˆæé«˜æ‰§è¡Œæ•ˆç‡ï¼‰")]),s._v(" "),a("p",[s._v("é»˜è®¤ä¸ä¼šå°†æ•°æ®æ‰“ä¹±é‡æ–°ç»„åˆï¼Œå¯èƒ½ä¼šå‡ºç°"),a("strong",[s._v("æ•°æ®å€¾æ–œ")]),s._v("ã€‚å¯ä»¥è¿›è¡Œshuffle")]),s._v(" "),a("p",[s._v("ç¬¬ä¸€ä¸ªå‚æ•°åˆ†åŒºä¸ªæ•°,ç¬¬äºŒä¸ªæ˜¯å¦å¼€å¯shuffle")]),s._v(" "),a("p",[s._v("ä¹Ÿå¯ä»¥æ‰©å¤§åˆ†åŒºå‰ææ˜¯å¼€å¯shuffle")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("repartition")]),s._v(": æ‰©å¤§åˆ†åŒº")]),s._v(" "),a("blockquote",[a("p",[s._v("åº•å±‚è°ƒç”¨äº†coalesce ä¸”å¼€å¯shuffle")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("sortBy")]),s._v(": æ’åº")]),s._v(" "),a("blockquote",[a("p",[s._v("åº•å±‚æœ‰shuffle,ç¬¬äºŒä¸ª"),a("strong",[s._v("å‚æ•°æŒ‡å®šæ’åºæ–¹å¼")]),s._v("tureå‡åº(é»˜è®¤)")])])])]),s._v(" "),a("p",[a("strong",[s._v("åŒValueç±»å‹")]),s._v("ï¼š")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("intersection :äº¤é›†")])]),s._v(" "),a("li",[a("p",[s._v("unionï¼šå¹¶é›†")])]),s._v(" "),a("li",[a("p",[s._v("subtracrï¼šå·®é›†")])]),s._v(" "),a("li",[a("p",[s._v("zip: æ‹‰é“¾  ï¼ˆå¯¹åº”ä½ç½®ç»“åˆæˆä¸€ä¸ªå…ƒç»„ï¼‰"),a("strong",[s._v("æ•°æ®ç±»å‹å¯ä»¥ä¸ä¸€è‡´")])]),s._v(" "),a("blockquote",[a("p",[s._v("æ³¨æ„ï¼šåˆ†åŒºæ•°é‡è¦ä¸€è‡´ï¼Œæ¯ä¸ªåˆ†åŒºå…ƒç´ æ•°é‡è¦ä¸€è‡´ã€‚")])])])]),s._v(" "),a("p",[a("strong",[s._v("Key-Valueç±»å‹")]),s._v("ï¼š")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("partitionBy")]),s._v(" :æŒ‰ç…§æŒ‡å®šè§„åˆ™é‡æ–°è¿›è¡Œåˆ†åŒº")]),s._v(" "),a("blockquote",[a("p",[s._v("é»˜è®¤åˆ†åŒºå™¨æ˜¯ï¼šHashPartitioner")]),s._v(" "),a("p",[s._v("å¯ä»¥è‡ªå®šä¹‰åˆ†åŒºå™¨ï¼šå®ç°æ’åºè§„åˆ™")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("reduceBykey")]),s._v(": æŒ‰ç…§ç›¸åŒkeyå¯¹valueè¿›è¡Œèšåˆ")]),s._v(" "),a("blockquote",[a("p",[s._v("(v1,v2) ä¿©ä¸¤èšåˆ å¦‚æœkeyä¸ºä¸€ä¸ªå°±ä¸ä¼šå‚ä¸è®¡ç®—ç›´æ¥è¿”å›")]),s._v(" "),a("p",[a("strong",[s._v("æœ‰åˆ†ç»„æœ‰èšåˆ")]),s._v(" åœ¨è½ç›˜ä¹‹å‰ä¼šè¿›è¡Œ"),a("strong",[s._v("é¢„èšåˆ")]),s._v("(åˆ†åŒºå†…)å‡å°‘è½ç›˜æ•°æ®é‡æé«˜IOæ€§èƒ½")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("groupBykey")]),s._v("ï¼šç›¸åŒkeyçš„æ•°æ®åˆ†åœ¨ä¸€ä¸ªç»„ä¸­å½¢æˆå¯¹å¶å…ƒç»„")]),s._v(" "),a("blockquote",[a("p",[s._v("ï¼ˆkev,iter(value)ï¼‰")]),s._v(" "),a("p",[s._v("å­˜åœ¨shuffle(å¿…é¡»è¦è½ç›˜æ‰å¤„ç†,å¦åˆ™ä¼šå­˜åœ¨å†…å­˜æº¢å‡º)ï¼Œæ‰€ä»¥shuffleæ“ä½œæ€§èƒ½éå¸¸ä½")]),s._v(" "),a("p",[s._v("æœ‰åˆ†ç»„å’Œ"),a("strong",[s._v("æ²¡èšåˆ")]),s._v("(èšåˆé€šè¿‡åˆ«çš„æ–¹å¼)")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("aggregatebykey")]),s._v(" :åˆ†åŒºèšåˆ")]),s._v(" "),a("blockquote",[a("p",[s._v("åˆ¶å®š"),a("strong",[s._v("ä¸åŒçš„è§„åˆ™")]),s._v("è¿›è¡Œåˆ†åŒºè®¡ç®—å’Œåˆ†åŒºä¹‹é—´è®¡ç®—")]),s._v(" "),a("p",[s._v("å­˜åœ¨å‡½æ•°æŸ¯é‡ŒåŒ–ï¼šä¿©ä¸ªå‚æ•°åˆ—è¡¨")]),s._v(" "),a("p",[s._v("ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åˆå§‹å€¼ï¼šä¼ é€’ç»™åˆ†åŒºå†…è¿›è¡Œè®¡ç®—çš„ç¬¬ä¸€ä¸ªåˆå§‹å€¼")]),s._v(" "),a("p",[s._v("ç¬¬äºŒä¸ªå‚æ•°åˆ—è¡¨ï¼šä¼ é€’åˆ†åŒºå†…è®¡ç®—è§„åˆ™ï¼Œä¼ é€’åˆ†åŒºé—´è®¡ç®—è§„åˆ™")]),s._v(" "),a("p",[a("strong",[s._v("å½“åˆ†åŒºå†…å’Œåˆ†åŒºé—´ç›¸åŒ")]),s._v("å¯ä»¥ç”¨ "),a("strong",[s._v("forldBykey")]),s._v(" è¿›è¡Œç®€åŒ–")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("mapValues")]),s._v(" ï¼škeyä¿æŒä¸å˜ å¯¹valueå¯¹è±¡è½¬æ¢")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("combineBykey")]),s._v(" : (ç›¸åŒçš„keyè¿›è¡Œæ“ä½œ)(åˆ†åŒºå†…)(åˆ†åŒºé—´)")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("sortByKey")]),s._v(":æ ¹æ®keyè¿›è¡Œæ’åº")]),s._v(" "),a("blockquote",[a("p",[s._v("K å¿…é¡»å®ç° Ordered æ¥å£(ç‰¹è´¨)")]),s._v(" "),a("p",[s._v("è¿”å›ä¸€ä¸ªæŒ‰ç…§ key è¿›è¡Œæ’åºçš„")]),s._v(" "),a("div",{staticClass:"language-scala line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" dataRDD1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sparkContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("makeRDD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("List"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"a"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"b"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"c"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" sortRDD1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" RDD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" dataRDD1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sortByKey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" #æ­£åº\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" sortRDD1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" RDD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" dataRDD1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sortByKey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("#å€’åº\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("join")]),s._v("ï¼šè¿æ¥  ç›¸åŒkeyçš„æ•°æ®è¿æ¥åœ¨ä¸€èµ· ç±»ä¼¼å†…è¿æ¥  ç¬›å¡å°”ç§¯ shuffle æ•°æ®å€å¢é•¿..")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("leftOuterJoin")]),s._v(" :å·¦è¿æ¥   ä¸»/ä»")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("rightOuterJoin")]),s._v(" : å³è¿æ¥   ä¸»/ä»")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("cogroup")]),s._v("ï¼šconect+group ç›¸åŒçš„keyæ”¾åœ¨ä¸€ä¸ªç»„ä¸­ï¼Œç„¶åè¿æ¥åœ¨ä¸€èµ·")])])]),s._v(" "),a("p",[s._v("æ¡ˆä¾‹")]),s._v(" "),a("div",{staticClass:"language-scala line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1516609143867")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\næ—¶é—´  çœä»½ åŸå¸‚ ç”¨æˆ· å¹¿å‘Š\néœ€æ±‚ï¼šç»Ÿè®¡å‡ºæ¯ä¸ªçœä»½æ¯ä¸ªå¹¿å‘Šè¢«ç‚¹å‡»æ•°é‡çš„Top3\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" sparkConf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" SparkConf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("setMaster"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local[*]"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("setAppName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Operstor"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" sc "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" SparkContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sparkConf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//map")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" rdd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("textFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"datas/agent.log"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" values"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Array"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" List"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" rdd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" arr "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("split"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("arr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" arr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//((a,b),c)")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("reduceByKey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("_ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" _"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ((a,b),iter[C])")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("map "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("prv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("prv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//(a,(b,iter[C]))")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("groupByKey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//å¯¹aåˆ†ç»„")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("mapValues"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("kv "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" list "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" kv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("toList"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è½¬æ¢æˆåˆ—è¡¨æ‰èƒ½è°ƒç”¨æ–¹æ³•")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" tuples "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sortBy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Ordering"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("reverse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//æ’åºåè½¬")]),s._v("\n        tuples"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("take"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//å–å‡ºå‰3")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("collect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    values"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("foreach"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("println"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    sc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h3",{attrs:{id:"rddè¡ŒåŠ¨ç®—å­"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rddè¡ŒåŠ¨ç®—å­"}},[s._v("#")]),s._v(" RDDè¡ŒåŠ¨ç®—å­")]),s._v(" "),a("p",[s._v("è§¦å‘ä½œä¸šçš„æ‰§è¡Œçš„æ–¹æ³•")]),s._v(" "),a("blockquote",[a("p",[s._v("åº•å±‚è°ƒç”¨äº†runjobæ–¹æ³•")]),s._v(" "),a("p",[s._v("æœ€åé€šè¿‡é‚®ç®±æ— ç¯å›¾è¿è¡Œrunjobé‡Œé¢æœ‰ä¸ªsubmitjobæäº¤ä»»åŠ¡")]),s._v(" "),a("p",[a("code",[s._v("æœ€ååˆ›å»ºäº† new ActiveJob")])])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("reduce  : ä¿©ä¿©èšåˆ")]),s._v(" "),a("blockquote",[a("p",[s._v("èšé›† RDD ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œå…ˆèšåˆåˆ†åŒºå†…æ•°æ®ï¼Œå†èšåˆåˆ†åŒºé—´æ•°æ®")])])]),s._v(" "),a("li",[a("p",[s._v("collect ï¼šé‡‡é›†")]),s._v(" "),a("blockquote",[a("p",[s._v("å°†ä¸åŒåˆ†åŒºçš„æ•°æ®æŒ‰ç…§åˆ†åŒºé¡ºåºè¿›è¡Œé‡‡é›†åˆ°Dirverç«¯å†…å­˜ä¸­è¿›è¡Œå¤„ç†ï¼Œå½¢æˆ"),a("strong",[s._v("æ•°ç»„")])])])]),s._v(" "),a("li",[a("p",[s._v("count ï¼šæ•°æ®çš„ä¸ªæ•°")])]),s._v(" "),a("li",[a("p",[s._v("firstï¼šç¬¬ä¸€ä¸ª")])]),s._v(" "),a("li",[a("p",[s._v("takeï¼šå–nä¸ªæ•°æ®")])]),s._v(" "),a("li",[a("p",[s._v("takeOrderedï¼šæ’åºå–nä¸ª")])]),s._v(" "),a("li",[a("p",[s._v("aggregateï¼šä¸éœ€è¦è€ƒè™‘æ•°æ®çš„ç±»å‹")]),s._v(" "),a("blockquote",[a("p",[s._v("åˆå§‹å€¼ä¼šå‚ä¸åˆ†åŒºå†…åˆ†åŒºé—´è®¡ç®—")])])]),s._v(" "),a("li",[a("p",[s._v("flodï¼šåˆ†åŒºå†…å’Œåˆ†åŒºé—´ç›¸åŒ")])]),s._v(" "),a("li",[a("p",[s._v("countBykeyï¼šç»Ÿè®¡keyå‡ºç°æ¬¡æ•°")])]),s._v(" "),a("li",[a("p",[s._v("countByValueï¼šç»Ÿè®¡valueå‡ºç°çš„æ¬¡æ•°")])]),s._v(" "),a("li",[a("p",[s._v("save ç›¸å…³")]),s._v(" "),a("blockquote",[a("p",[s._v("saveAsTestFile:æ–‡æœ¬æ ¼å¼")]),s._v(" "),a("p",[s._v("saveObjectFile: å¯¹è±¡æ ¼å¼")]),s._v(" "),a("p",[s._v("saveSerquenceFile:è¦æ±‚æ•°æ®æ ¼å¼æ˜¯k-vç±»å‹")])])]),s._v(" "),a("li",[a("p",[s._v("foreacchï¼š"),a("strong",[s._v("åˆ†å¸ƒå¼")]),s._v("éå†RDDæ¯ä¸€ä¸ªå…ƒç´ ã€‚executorç«¯")]),s._v(" "),a("blockquote",[a("p",[s._v("RDDçš„æ–¹æ³•å’Œscalaé›†åˆçš„æ–¹æ³•ä¸ä¸€æ ·ï¼Œé›†åˆå¯¹è±¡çš„æ–¹æ³•éƒ½æ˜¯åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹çš„å†…å­˜ä¸­å®Œæˆçš„")]),s._v(" "),a("p",[s._v("ç®—å­æ˜¯åœ¨executorç«¯æ‰§è¡Œçš„")])])])]),s._v(" "),a("h3",{attrs:{id:"rdd-åºåˆ—åŒ–"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rdd-åºåˆ—åŒ–"}},[s._v("#")]),s._v(" "),a("strong",[s._v("RDD")]),s._v(" "),a("strong",[s._v("åºåˆ—åŒ–")])]),s._v(" "),a("p",[a("strong",[s._v("é—­åŒ…æ£€æŸ¥")]),s._v("ï¼šç®—å­ä»¥å¤–çš„ä»£ç éƒ½æ˜¯åœ¨ Driver ç«¯æ‰§è¡Œ, ç®—å­é‡Œé¢çš„ä»£ç éƒ½æ˜¯åœ¨ Executorç«¯æ‰§è¡Œ")]),s._v(" "),a("p",[a("strong",[s._v("Kryo åºåˆ—åŒ–æ¡†æ¶")]),s._v("ï¼šjavaçš„åºåˆ—åŒ–æ¡†æ¶æ¯”è¾ƒé‡,è€ŒKryo æ˜¯serializableçš„10å€ï¼Œsufflå†…éƒ¨æœ‰äº›å°±å¼€å§‹ä½¿ç”¨äº†")]),s._v(" "),a("p",[a("strong",[s._v("ä¾èµ–å…³ç³»")]),s._v("ï¼šä¿©ä¸ªRDDä¹‹é—´çš„å…³ç³» ï¼š"),a("code",[s._v("dependencies æŸ¥çœ‹ä¾èµ–å…³ç³»")])]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("è¡€ç¼˜å…³ç³»")]),s._v("ï¼šå¤šä¸ªè¿ç»­çš„RDDä¾èµ–å…³ç³»ã€‚ï¼š"),a("code",[s._v("toDebugString è¡€ç¼˜å…³ç³»")])]),s._v(" "),a("blockquote",[a("p",[s._v("ä¸ºäº†æé«˜RDDçš„å®¹é”™æ€§ï¼Œéœ€è¦ä¿å­˜RDDä¹‹å‰çš„å…³ç³»ï¼Œé˜²æ­¢é‡åˆ°é”™è¯¯,å¯æ ¹æ®è¡€ç¼˜å…³ç³»æ¥è¿›è¡Œæ¢å¤æ•°æ®")]),s._v(" "),a("p",[s._v("æ¯ä¸ªRDDéƒ½ä¼šä¿å­˜ä¾èµ–å…³ç³»ã€‚")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("å®½çª„ä¾èµ–")]),s._v("ï¼š")]),s._v(" "),a("blockquote",[a("p",[s._v("oneTOone(çª„)ä¾èµ–ï¼šæ–°çš„RDDä¸€ä¸ªåˆ†åŒºä¾èµ–äºæ—§çš„RDD"),a("strong",[s._v("ä¸€ä¸ª")]),s._v("åˆ†åŒº")]),s._v(" "),a("p",[s._v("shuffle(å®½)ä¾èµ–ï¼šæ–°çš„RDDä¸€ä¸ªåˆ†åŒºä¾èµ–äºæ—§çš„RDD"),a("strong",[s._v("å¤šä¸ª")]),s._v("åˆ†åŒº  taskå¢å¤š ä¸”"),a("strong",[s._v("åˆ†é˜¶æ®µ")])]),s._v(" "),a("p",[s._v("å­˜åœ¨shuffleä¾èµ–æ—¶,é˜¶æ®µä¼šè‡ªåŠ¨å¢åŠ ä¸€ä¸ªï¼Œé˜¶æ®µæ•°é‡=shuffleä¾èµ–æ•°+1")])])])]),s._v(" "),a("p",[a("strong",[s._v("rddä»»åŠ¡åˆ’åˆ†")]),s._v("ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("applicationï¼šåˆå§‹åŒ–ä¸€ä¸ªsparkcontextå³ç”Ÿæˆä¸€ä¸ªapplication")]),s._v(" "),a("li",[s._v("job ï¼šä¸€ä¸ªactionç®—å­ä¼šç”Ÿæˆä¸€ä¸ªjob")]),s._v(" "),a("li",[s._v("stage ï¼šç­‰äºå®½ä¾èµ–çš„ä¸ªæ•°åŠ 1")]),s._v(" "),a("li",[s._v("taskï¼šä¸€ä¸ªstageé˜¶æ®µä¸­æœ€åä¸€ä¸ªrddåˆ†åŒºä¸ªæ•°å°±æ˜¯taskä¸ªæ•°")])]),s._v(" "),a("blockquote",[a("p",[s._v("app->job->stage->task æ¯ä¸€å±‚éƒ½æ˜¯1å¯¹nçš„å…³ç³»")])]),s._v(" "),a("h3",{attrs:{id:"rddçš„æŒä¹…åŒ–"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rddçš„æŒä¹…åŒ–"}},[s._v("#")]),s._v(" RDDçš„æŒä¹…åŒ–")]),s._v(" "),a("blockquote",[a("p",[s._v("é»˜è®¤rddå¯¹è±¡å¯ä»¥é‡ç”¨,æ•°æ®æ— æ³•é‡ç”¨ï¼Œæ‰€ä»¥ä¸ºäº†ä¼˜åŒ–æ­¤é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ“ä½œçš„æ•°æ®æŒä¹…åŒ–ï¼Œ")]),s._v(" "),a("p",[s._v("æ–¹ä¾¿ä¸‹ä¸€æ¬¡æ“ä½œæ—¶ä½¿ç”¨ï¼Œä¸ç”¨ä»å¤´è¯»å–ã€‚")])]),s._v(" "),a("p",[a("strong",[s._v("æŒä¹…åŒ–:")])]),s._v(" "),a("ul",[a("li",[a("code",[s._v("cache")]),s._v(" :ä¸´æ—¶å­˜å‚¨åˆ°å†…å­˜ä¸­ å¯èƒ½ä¸å®‰å…¨")]),s._v(" "),a("li",[a("code",[s._v("perslist")]),s._v(" :ä¸´æ—¶å­˜å‚¨åœ¨ç£ç›˜ å¯è®¾ç½®å­˜å‚¨çº§åˆ«ï¼Œæ•°æ®å®‰å…¨ã€æ‰§è¡ŒIO æ€§èƒ½è¾ƒä½")])]),s._v(" "),a("blockquote",[a("p",[s._v("å¯é‡ç”¨ï¼Œåœ¨è¡ŒåŠ¨ç®—å­æ—¶æ‰æ‰§è¡Œï¼Œä½†æ˜¯"),a("strong",[s._v("ä½œä¸šæ‰§è¡Œå®Œ")]),s._v("ä¸´æ—¶æ–‡ä»¶éƒ½ä¼šè¢«"),a("strong",[s._v("åˆ é™¤")])]),s._v(" "),a("p",[s._v("ä¼šåœ¨è¡€ç¼˜å…³ç³»æ·»åŠ ä¸€ä¸ªæ–°çš„ä¾èµ–ã€‚")])]),s._v(" "),a("p",[a("strong",[s._v("æ£€æŸ¥ç‚¹")]),s._v("ï¼š"),a("code",[s._v("checkpoint")]),s._v(" éœ€è¦è½ç›˜ éœ€è¦æŒ‡å®šè·¯å¾„   ä¿å­˜çš„æ–‡ä»¶ä½œä¸š"),a("strong",[s._v("æ‰§è¡Œå®Œæ–‡ä»¶ä¸ä¼šåˆ é™¤")])]),s._v(" "),a("blockquote",[a("p",[s._v("é•¿ä¹…ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå®‰å…¨ï¼Œä¸€èˆ¬"),a("strong",[s._v("ç‹¬ç«‹æ‰§è¡Œä¸€ä¸ªä½œä¸š")]),s._v("ã€‚æ€§èƒ½ä½ï¼Œä¸ºäº†æé«˜æ€§èƒ½")]),s._v(" "),a("p",[s._v("ä¸€èˆ¬æƒ…å†µä¸‹éœ€è¦å’Œ"),a("strong",[s._v("cacheè”åˆä½¿ç”¨")]),s._v("ï¼Œæ‰€ä»¥å…ˆå¼€å¯cacheå†å¼€å¯checkpointã€‚")]),s._v(" "),a("p",[s._v("æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šåˆ‡æ–­è¡€ç¼˜å…³ç³»ã€‚é‡æ–°å»ºç«‹æ–°çš„è¡€ç¼˜å…³ç³»ã€‚ç­‰åŒäºæ”¹å˜äº†æ•°æ®æºã€‚")])]),s._v(" "),a("p",[a("strong",[s._v("åˆ†åŒºå™¨")]),s._v("ï¼šç›®å‰æ”¯æŒ Hash(é»˜è®¤) åˆ†åŒºå’Œ Range åˆ†åŒº")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("Hash")]),s._v("ï¼šå¯¹äºç»™å®šçš„ keyï¼Œè®¡ç®—å…¶ hashCode,å¹¶é™¤ä»¥åˆ†åŒºä¸ªæ•°å–ä½™")]),s._v(" "),a("li",[a("strong",[s._v("Range")]),s._v(" ï¼šå°†ä¸€å®šèŒƒå›´å†…çš„æ•°æ®æ˜ å°„åˆ°ä¸€ä¸ªåˆ†åŒºä¸­ï¼Œå°½é‡ä¿è¯æ¯ä¸ªåˆ†åŒºæ•°æ®å‡åŒ€ï¼Œè€Œä¸”åˆ†åŒºé—´æœ‰åº")])]),s._v(" "),a("p",[a("strong",[s._v("è‡ªå®šä¹‰åˆ†åŒºå™¨")]),s._v("ï¼š")]),s._v(" "),a("div",{staticClass:"language-scala line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//å‚è€ƒ new HashPartitioner() è¿›è¡Œæ”¹é€ ")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n   * è‡ªå®šä¹‰åˆ†åŒºå™¨\n   */")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" MyPartitioner"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("partitions"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" Partitioner"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//åˆ†åŒºæ•°")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("override")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" numPartitions"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" partitions\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//åˆ†åŒºç´¢å¼• ä»0å¼€å§‹ æ ¹æ®keyå€¼è¿”å›æ•°æ®æ‰€åœ¨çš„ç´¢å¼•")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("override")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" getPartition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("key"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Any")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//æ¨¡å¼åŒ¹é… æ ¹if else ä¸€æ ·")]),s._v("\n      key "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("match")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nba"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("=>")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cba"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("=>")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" _"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("=>")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//ä½¿ç”¨")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" pardd"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" rdd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("partitionBy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" MyPartitioner"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//ä¼ å…¥ä¸ªæ•°")]),s._v("\n    pardd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("saveAsTextFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"output1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("p",[a("strong",[s._v("rddæ–‡ä»¶è¯»å–å’Œä¿å­˜")])]),s._v(" "),a("div",{staticClass:"language-scala line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[s._v("#ä¿å­˜\nsave"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n#è¯»å–\ntextFile\nobjectFile\nsequenceFile\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"ç´¯åŠ å™¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç´¯åŠ å™¨"}},[s._v("#")]),s._v(" ç´¯åŠ å™¨")]),s._v(" "),a("p",[s._v("å…±äº«åªå†™å˜é‡ã€‚")]),s._v(" "),a("p",[s._v("accï¼šè®©sparkçŸ¥é“Dirverçš„æ•°æ®ä¼ ç»™executorè®¡ç®—å®Œçš„ç»“æœè¦"),a("strong",[s._v("è¿”å›")]),s._v("ç»™Dirver,ç„¶åå°†è¿”å›çš„ç»“æœè¿›è¡Œç´¯åŠ åˆå¹¶")]),s._v(" "),a("p",[a("strong",[s._v("é»˜è®¤ç®€å•èšåˆ")]),s._v("ï¼š"),a("code",[s._v("longaccumulator double....")]),s._v("  å¯ä»¥èµ·ä¸ªåå­—  addæ–¹æ³•å°†æ•°å€¼åŠ å…¥ç´¯åŠ å™¨ä¸­ valueè·å–å€¼")]),s._v(" "),a("blockquote",[a("p",[s._v("å°‘åŠ ï¼šè½¬æ¢ç®—å­è°ƒç”¨ç´¯åŠ å™¨  æ²¡æœ‰è¡ŒåŠ¨ç®—å­ ä¸ä¼šæ‰§è¡Œ")]),s._v(" "),a("p",[s._v("å¤šåŠ ï¼šå‡ºç°å¤šä¸ªè¡ŒåŠ¨ç®—å­ï¼Œæ¯ä¸ªè¡ŒåŠ¨ç®—å­éƒ½ä¼šæ‰§è¡Œåˆ°è¿™ä¸ªè½¬æ¢è½¬æ¢ç®—å­")]),s._v(" "),a("p",[s._v("ä¸€èˆ¬æƒ…å†µä¸‹ç´¯åŠ å™¨ä¼šæ”¾åœ¨ä¸€ä¸ªè¡ŒåŠ¨ç®—å­ä¸­ã€‚")])]),s._v(" "),a("p",[a("strong",[s._v("è‡ªå®šä¹‰ç´¯åŠ å™¨")]),s._v("ï¼š")]),s._v(" "),a("div",{staticClass:"language-scala line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å‚è€ƒ longAccumulator å®ç°  #å¯ä»¥é¿å…shuffle")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** *\n   * è‡ªå®šä¹‰æ•°æ®ç´¯åŠ å™¨\n   * ç»§æ‰¿AccumulatorV2 æŒ‡å®šæ³›å‹\n   * ç´¯åŠ å™¨è¾“å…¥ç±»å‹\n   * ç´¯åŠ å™¨è¿”å›ç±»å‹\n   */")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" MyAccumulator "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" AccumulatorV2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" mutable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" wcMap"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mutable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//åˆ¤æ–­æ˜¯å¦ä¸ºåˆå§‹çŠ¶æ€")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("override")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" isZero"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Boolean")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wcMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("isEmpty\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//å¤åˆ¶ä¸€ä¸ªæ–°çš„ç´¯åŠ å™¨")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("override")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" copy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" AccumulatorV2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" mutable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" MyAccumulator\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//é‡ç½®ç´¯åŠ å™¨")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("override")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" reset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Unit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" wcMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("clear"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//è·å–è¾“å…¥")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("override")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" add"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Unit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" newCut"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wcMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("getOrElse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0l")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n      wcMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("update"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("newCut"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//Dirveråˆå¹¶å¤šä¸ªç´¯åŠ å™¨")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("override")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" merge"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("other"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" AccumulatorV2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" mutable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Unit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" map1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("wcMap\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" map2"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("other"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value\n      map2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("foreach"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("work"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n       "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" newCount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("map1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("getOrElse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("work"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0L")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("count\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//æ›´æ–°")]),s._v("\n          map1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("update"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("work"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("newCount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//è¾“å‡º")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("override")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" value"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" mutable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  wcMap\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//åˆ›å»ºç´¯åŠ å™¨å¯¹è±¡")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" wcAcc "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" MyAccumulator\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//æ³¨å†Œç´¯åŠ å™¨")]),s._v("\n    sc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("wcAcc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wordCountAcc"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br")])]),a("h3",{attrs:{id:"å¹¿æ’­å˜é‡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¹¿æ’­å˜é‡"}},[s._v("#")]),s._v(" å¹¿æ’­å˜é‡")]),s._v(" "),a("p",[s._v("é—­åŒ…æ•°æ®æ˜¯ä»¥taskä¸ºå•ä½è¿›è¡Œå‘é€çš„ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½åŒ…å«é—­åŒ…æ•°æ®ï¼Œå¯èƒ½å¯¼è‡´executorä¸­æœ‰å¤§é‡é‡å¤æ•°æ®ã€‚")]),s._v(" "),a("p",[s._v("executoræ˜¯ä¸€ä¸ªjvmè¿›ç¨‹ æ‰€ä»¥åœ¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨åˆ†é…åˆ°å†…å­˜ã€‚å¯ä»¥æŠŠæ•°æ®åŠ è½½åˆ°è¿™ä¸ªå†…å­˜ä¸­æä¾›ç»™æ¯ä¸ªtaskä½¿ç”¨")]),s._v(" "),a("p",[s._v("è¿™å°±æ˜¯å¹¿æ’­å˜é‡ï¼Œä½†æ˜¯"),a("strong",[s._v("å¹¿æ’­å˜é‡ä¸èƒ½æ›´æ”¹")]),s._v("ã€‚")]),s._v(" "),a("p",[s._v("æ˜¯"),a("strong",[s._v("åˆ†å¸ƒå¼å…±äº«çš„åªè¯»å˜é‡")]),s._v(" "),a("code",[s._v("broadcast(æ•°æ®)")])]),s._v(" "),a("h2",{attrs:{id:"å·¥ç¨‹åŒ–æ¶æ„"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å·¥ç¨‹åŒ–æ¶æ„"}},[s._v("#")]),s._v(" å·¥ç¨‹åŒ–æ¶æ„")]),s._v(" "),a("p",[s._v("ä¾‹å¦‚ï¼šMVC : model view Controller")]),s._v(" "),a("ul",[a("li",[s._v("ä¸šåŠ¡ï¼šé€»è¾‘")]),s._v(" "),a("li",[s._v("æ•°æ®ï¼šå°è£…")])]),s._v(" "),a("p",[a("strong",[s._v("ä¸‰å±‚æ¶æ„")]),s._v(": Controller(æ§åˆ¶ è°ƒåº¦) server(æœåŠ¡å±‚ é€»è¾‘) dao(æŒä¹…å±‚ æ“ä½œæ–‡ä»¶)")]),s._v(" "),a("div",{staticClass:"language-scala line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[s._v("ç›®å½•ç»“æ„ï¼š\nå…¥å£"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("conterller"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("server"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("dao\n#é‡Œé¢å¯ä»¥æ”¾ç½®å¯¹åº”å±æ€§\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v(" conterller #æ§åˆ¶å±‚ ä¾‹"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("åˆ›å»ºæ–¹æ³•è°ƒåº¦æœåŠ¡å±‚æ–¹æ³•\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.")]),s._v(" server\t#æœåŠ¡å±‚   ä¾‹ï¼šåˆ›å»ºæ–¹æ³•æä¾›ç»™æ§åˆ¶å±‚è°ƒç”¨"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("å†™é€»è¾‘ä»£ç "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("çœŸæ­£è°ƒç”¨æ•°æ®è°ƒç”¨æŒä¹…å±‚æ–¹æ³•\t\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.")]),s._v(" dao\t\t#æŒä¹…å±‚   ä¾‹ï¼šåˆ›å»ºæ“ä½œæ•°æ®æ–¹æ³•æä¾›ç»™é€»è¾‘"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("æœåŠ¡"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("å±‚è°ƒç”¨ ä¾‹"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("è¯»å–æ–‡ä»¶ç­‰ç­‰"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.")]),s._v(" application #å…¥å£ç±» ç»§æ‰¿APPå³å¯è¿è¡Œ ä¾‹ï¼šå¯ä»¥è°ƒç”¨commoné‡Œçš„æ–¹æ³•"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ä¼ å…¥å‚æ•°"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("é€»è¾‘"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.")]),s._v(" common #å…±åŒç±» å…±é€šæ€§ æŠ½å–ç±» \nä¾‹ï¼šç‰¹è´¨ç±»ï¼Œæ–¹æ³•ï¼šæŠŠç¯å¢ƒæ”¾é‡Œå¤´åˆå§‹åŒ–å…³é—­çš„åˆ›å»ºåŒä¸€å¯¹è±¡çš„ä»£ç ç­‰ç­‰"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" é‚£äº›æ‰§è¡Œçš„æ–¹æ³•éƒ½å¯ä»¥æ”¾è¿›æ¥ï¼Œ\nç„¶åè°ƒç”¨æ—¶ï¼Œç”¨"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v("æ··å…¥å®ç°å³å¯ï¼Œç±»ä¼¼æ¥å£\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.")]),s._v(" util #å·¥å…·ç±»\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.")]),s._v(" bean #å®ä½“ç±» ä¾‹ï¼šThreadLocalç±»å°è£…æ–¹æ³•ç”¨æ¥å­˜å‚¨çº¿ç¨‹æ•°æ®\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("blockquote",[a("p",[a("strong",[s._v("ThreadLocal")]),s._v("å¯ä»¥å¯¹"),a("strong",[s._v("çº¿ç¨‹")]),s._v("çš„å†…å­˜è¿›è¡Œæ§åˆ¶ï¼Œå­˜å‚¨æ•°æ®,")]),s._v(" "),a("p",[s._v("set(å­˜å‚¨æ•°æ®ï¼‰")]),s._v(" "),a("p",[s._v("getè·å–æ•°æ®")]),s._v(" "),a("p",[s._v("removeåˆ é™¤æ•°æ®")]),s._v(" "),a("p",[s._v("è§£é‡Šï¼šè·å–å½“å‰çº¿ç¨‹ï¼Œå­˜å‚¨åˆ°mapçš„çº¿ç¨‹å®¹å™¨ä¸­ã€‚")])])])}),[],!1,null,null,null);t.default=e.exports}}]);